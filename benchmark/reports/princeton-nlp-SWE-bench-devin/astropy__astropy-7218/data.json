{
  "instance_id": "astropy__astropy-7218",
  "model_patch": "diff --git a/astropy/io/fits/hdu/hdulist.py b/astropy/io/fits/hdu/hdulist.py\nindex 393a9856ce..c874af37c2 100644\n--- a/astropy/io/fits/hdu/hdulist.py\n+++ b/astropy/io/fits/hdu/hdulist.py\n@@ -1387,3 +1387,17 @@ class HDUList(list, _Verify):\n                 self._truncate = False\n \n         return self._resize\n+\n+    def copy(self):\n+        \"\"\"\n+        Create a copy of the HDUList.\n+\n+        Returns\n+        -------\n+        copy : HDUList\n+            A copy of the HDUList.\n+        \"\"\"\n+        new_hdulist = HDUList()\n+        for hdu in self:\n+            new_hdulist.append(hdu.copy())\n+        return new_hdulist\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "astropy/io/fits/hdu/hdulist.py"
  ],
  "repo": "astropy/astropy",
  "base_commit": "9626265d77b8a21c113615c08bc6782deb52eaed",
  "patch": "diff --git a/astropy/io/fits/hdu/hdulist.py b/astropy/io/fits/hdu/hdulist.py\n--- a/astropy/io/fits/hdu/hdulist.py\n+++ b/astropy/io/fits/hdu/hdulist.py\n@@ -510,6 +510,25 @@ def fileinfo(self, index):\n \n         return output\n \n+    def __copy__(self):\n+        \"\"\"\n+        Return a shallow copy of an HDUList.\n+\n+        Returns\n+        -------\n+        copy : `HDUList`\n+            A shallow copy of this `HDUList` object.\n+\n+        \"\"\"\n+\n+        return self[:]\n+\n+    # Syntactic sugar for `__copy__()` magic method\n+    copy = __copy__\n+\n+    def __deepcopy__(self, memo=None):\n+        return HDUList([hdu.copy() for hdu in self])\n+\n     def pop(self, index=-1):\n         \"\"\" Remove an item from the list and return it.\n \n",
  "test_patch": "diff --git a/astropy/io/fits/tests/test_hdulist.py b/astropy/io/fits/tests/test_hdulist.py\n--- a/astropy/io/fits/tests/test_hdulist.py\n+++ b/astropy/io/fits/tests/test_hdulist.py\n@@ -5,6 +5,7 @@\n import os\n import platform\n import sys\n+import copy\n \n import pytest\n import numpy as np\n@@ -376,6 +377,43 @@ def test_file_like_3(self):\n         info = [(0, 'PRIMARY', 1, 'PrimaryHDU', 5, (100,), 'int32', '')]\n         assert fits.info(self.temp('tmpfile.fits'), output=False) == info\n \n+    def test_shallow_copy(self):\n+        \"\"\"\n+        Tests that `HDUList.__copy__()` and `HDUList.copy()` return a\n+        shallow copy (regression test for #7211).\n+        \"\"\"\n+\n+        n = np.arange(10.0)\n+        primary_hdu = fits.PrimaryHDU(n)\n+        hdu = fits.ImageHDU(n)\n+        hdul = fits.HDUList([primary_hdu, hdu])\n+\n+        for hdulcopy in (hdul.copy(), copy.copy(hdul)):\n+            assert isinstance(hdulcopy, fits.HDUList)\n+            assert hdulcopy is not hdul\n+            assert hdulcopy[0] is hdul[0]\n+            assert hdulcopy[1] is hdul[1]\n+\n+    def test_deep_copy(self):\n+        \"\"\"\n+        Tests that `HDUList.__deepcopy__()` returns a deep copy.\n+        \"\"\"\n+\n+        n = np.arange(10.0)\n+        primary_hdu = fits.PrimaryHDU(n)\n+        hdu = fits.ImageHDU(n)\n+        hdul = fits.HDUList([primary_hdu, hdu])\n+\n+        hdulcopy = copy.deepcopy(hdul)\n+\n+        assert isinstance(hdulcopy, fits.HDUList)\n+        assert hdulcopy is not hdul\n+\n+        for index in range(len(hdul)):\n+            assert hdulcopy[index] is not hdul[index]\n+            assert hdulcopy[index].header == hdul[index].header\n+            np.testing.assert_array_equal(hdulcopy[index].data, hdul[index].data)\n+\n     def test_new_hdu_extname(self):\n         \"\"\"\n         Tests that new extension HDUs that are added to an HDUList can be\n",
  "problem_statement": "HDUList.copy() returns a list\nCurrently ``HDUList.copy()`` returns a list rather than an ``HDUList``:\r\n\r\n```python\r\nIn [1]: from astropy.io.fits import HDUList\r\n\r\nIn [2]: hdulist = HDUList()\r\n\r\nIn [3]: hdulist.copy()\r\nOut[3]: []\r\n\r\nIn [4]: type(_)\r\nOut[4]: list\r\n```\r\n\r\nThis is with Python 3.6.\n",
  "hints_text": "This might be related to another issue reported in #7185 where adding two `HDUList`s also produces a `list` instead of another `HDUList`.\nWe should be able to fix this specific case by overriding `list.copy()` method with:\r\n```python\r\nclass HDUList(list, _Verify):\r\n    ...\r\n    def copy(self):\r\n        return self[:]\r\n    ...\r\n```\r\n\r\nAnd the result:\r\n```python\r\n>>> type(HDUList().copy())\r\nastropy.io.fits.hdu.hdulist.HDUList\r\n```",
  "created_at": "2018-02-20T11:36:56Z",
  "version": "1.3",
  "FAIL_TO_PASS": "[\"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_shallow_copy\"]",
  "PASS_TO_PASS": "[\"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_append_extension_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_append_groupshdu_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_append_groupshdu_to_non_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_append_primary_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_append_primary_to_non_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_create_from_multiple_primary\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_deep_copy\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_file_like\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_file_like_2\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_file_like_3\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_filename\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_flush_readonly\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_extension_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_groupshdu_to_begin_of_hdulist_with_groupshdu\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_groupshdu_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_groupshdu_to_non_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_primary_to_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_insert_primary_to_non_empty_list\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_new_hdu_extname\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_update_filelike\", \"astropy/io/fits/tests/test_hdulist.py::TestHDUListFunctions::test_update_name\"]",
  "environment_setup_commit": "848c8fa21332abd66b44efe3cb48b72377fb32cc",
  "patch_files": [
    "astropy/io/fits/hdu/hdulist.py"
  ],
  "test_patch_files": [
    "astropy/io/fits/tests/test_hdulist.py"
  ],
  "patch_diff_details": {
    "astropy/io/fits/hdu/hdulist.py": {
      "diffs": [
        {
          "start_line_old": 513,
          "end_line_old": 513,
          "file_pos": 1,
          "file_context_length": 11238,
          "closest_snippet_id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.fileinfo_HDUList.fileinfo.3.1",
          "closest_snippet_line_distance": 2,
          "pos": 24,
          "context_length": 10681
        }
      ]
    }
  },
  "vectors": 3527,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.fromfile_HDUList.fromfile.2.1",
      "distance": 0.6901170611381531,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 386,
      "end_line": 400,
      "tokens": 157,
      "context_length": 157,
      "file_pos": 1
    },
    {
      "position": 2,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.writeto_HDUList.writeto.18",
      "distance": 0.6903780698776245,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 844,
      "end_line": 906,
      "tokens": 614,
      "context_length": 771,
      "file_pos": 1
    },
    {
      "position": 3,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.append_HDUList.append.9",
      "distance": 0.696885347366333,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 610,
      "end_line": 655,
      "tokens": 408,
      "context_length": 1179,
      "file_pos": 1
    },
    {
      "position": 4,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList_HDUList.__iter__.6.1.2.1",
      "distance": 0.7034620642662048,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 167,
      "end_line": 262,
      "tokens": 758,
      "context_length": 1937,
      "file_pos": 1
    },
    {
      "position": 5,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._readfrom_HDUList._try_while_unread_hdus.2.1.2.1.2.1",
      "distance": 0.7107477784156799,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1001,
      "end_line": 1076,
      "tokens": 622,
      "context_length": 2559,
      "file_pos": 1
    },
    {
      "position": 6,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.__getitem___HDUList.__getitem__.8.2.2.2.1",
      "distance": 0.7156698703765869,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 264,
      "end_line": 321,
      "tokens": 511,
      "context_length": 3070,
      "file_pos": 1
    },
    {
      "position": 7,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.fromstring_HDUList.fromstring.3.1",
      "distance": 0.7200676798820496,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 402,
      "end_line": 444,
      "tokens": 385,
      "context_length": 3455,
      "file_pos": 1
    },
    {
      "position": 8,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.flush_HDUList.flush.5.2.1",
      "distance": 0.7270803451538086,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 747,
      "end_line": 810,
      "tokens": 550,
      "context_length": 4005,
      "file_pos": 1
    },
    {
      "position": 9,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.__delitem___HDUList.__exit__.1",
      "distance": 0.7796953916549683,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 360,
      "end_line": 384,
      "tokens": 174,
      "context_length": 4179,
      "file_pos": 1
    },
    {
      "position": 10,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._flush_resize_HDUList._flush_resize.9.hdu._file.1",
      "distance": 0.7891030311584473,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1239,
      "end_line": 1346,
      "tokens": 1019,
      "context_length": 5198,
      "file_pos": 1
    },
    {
      "position": 11,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/nonstandard.py_FitsHDU.fromhdulist_",
      "distance": 0.792906641960144,
      "file_path": "astropy/io/fits/hdu/nonstandard.py",
      "start_line": 57,
      "end_line": 125,
      "tokens": 536,
      "context_length": 5734
    },
    {
      "position": 12,
      "id": "/tmp/repos/astropy/astropy/nddata/ccddata.py_CCDData.to_hdu_CCDData.to_hdu.hdus.1",
      "distance": 0.7936351299285889,
      "file_path": "astropy/nddata/ccddata.py",
      "start_line": 225,
      "end_line": 293,
      "tokens": 737,
      "context_length": 6471
    },
    {
      "position": 13,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._verify_HDUList._verify.7.1",
      "distance": 0.8056120276451111,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1164,
      "end_line": 1210,
      "tokens": 444,
      "context_length": 6915,
      "file_pos": 3
    },
    {
      "position": 14,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.__contains___HDUList.__setitem__.self._truncate.1",
      "distance": 0.8061131238937378,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 323,
      "end_line": 358,
      "tokens": 270,
      "context_length": 7185,
      "file_pos": 3
    },
    {
      "position": 15,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._flush_update_HDUList._flush_update.3.7.1.1",
      "distance": 0.8211976289749146,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1212,
      "end_line": 1237,
      "tokens": 217,
      "context_length": 7402,
      "file_pos": 3
    },
    {
      "position": 16,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._read_next_hdu_HDUList._read_next_hdu.7.1",
      "distance": 0.8272273540496826,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1078,
      "end_line": 1162,
      "tokens": 639,
      "context_length": 8041,
      "file_pos": 3
    },
    {
      "position": 17,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._positive_index_of_HDUList.readall.2.1",
      "distance": 0.8463624715805054,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 714,
      "end_line": 745,
      "tokens": 211,
      "context_length": 8252,
      "file_pos": 3
    },
    {
      "position": 18,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU.41__BaseHDU._writeto.2.1",
      "distance": 0.8528465628623962,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 631,
      "end_line": 642,
      "tokens": 139,
      "context_length": 8391
    },
    {
      "position": 19,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.insert_HDUList.insert.10",
      "distance": 0.8673446178436279,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 545,
      "end_line": 608,
      "tokens": 571,
      "context_length": 8962,
      "file_pos": 4
    },
    {
      "position": 20,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU.fileinfo__ValidHDU.copy.3.1",
      "distance": 0.8842360973358154,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 924,
      "end_line": 969,
      "tokens": 341,
      "context_length": 9303
    },
    {
      "position": 21,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/__init__.py_DTYPE2BITPIX_",
      "distance": 0.8982143998146057,
      "file_path": "astropy/io/fits/hdu/__init__.py",
      "start_line": 3,
      "end_line": 17,
      "tokens": 195,
      "context_length": 9498
    },
    {
      "position": 22,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU._writedata_internal_GroupsHDU._writedata_internal.4.1",
      "distance": 0.9038368463516235,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 449,
      "end_line": 499,
      "tokens": 402,
      "context_length": 9900
    },
    {
      "position": 23,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.fileinfo_HDUList.fileinfo.3.1",
      "distance": 0.9058467149734497,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 446,
      "end_line": 511,
      "tokens": 477,
      "context_length": 10377,
      "file_pos": 6
    },
    {
      "position": 24,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.pop_HDUList.pop.5.1",
      "distance": 0.9201605319976807,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 513,
      "end_line": 543,
      "tokens": 304,
      "context_length": 10681,
      "file_pos": 6
    },
    {
      "position": 25,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._writeto_internal__BaseHDU._close.5.1",
      "distance": 0.9257657527923584,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 644,
      "end_line": 716,
      "tokens": 720,
      "context_length": 11401
    },
    {
      "position": 26,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.index_of_HDUList.index_of.7.2.1.1",
      "distance": 0.9303573369979858,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 657,
      "end_line": 712,
      "tokens": 444,
      "context_length": 11845,
      "file_pos": 6
    },
    {
      "position": 27,
      "id": "/tmp/repos/astropy/examples/io/create-mef.py_1_",
      "distance": 0.9322060346603394,
      "file_path": "examples/io/create-mef.py",
      "start_line": 1,
      "end_line": 55,
      "tokens": 270,
      "context_length": 12115
    },
    {
      "position": 28,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.info_HDUList.filename.3.1",
      "distance": 0.9371247291564941,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 940,
      "end_line": 999,
      "tokens": 427,
      "context_length": 12542,
      "file_pos": 7
    },
    {
      "position": 29,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList._wasresized_",
      "distance": 0.9386956095695496,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 1348,
      "end_line": 1390,
      "tokens": 271,
      "context_length": 12813,
      "file_pos": 7
    },
    {
      "position": 30,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU.writeto__BaseHDU.writeto.4",
      "distance": 0.9484648704528809,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 335,
      "end_line": 373,
      "tokens": 393,
      "context_length": 13206
    },
    {
      "position": 31,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.update_extend_HDUList.update_extend.6.2.1.2.2",
      "distance": 0.9653604626655579,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 812,
      "end_line": 842,
      "tokens": 230,
      "context_length": 13436,
      "file_pos": 7
    },
    {
      "position": 32,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_fitsopen_fitsopen.1",
      "distance": 0.9701091051101685,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 28,
      "end_line": 141,
      "tokens": 1091,
      "context_length": 14527,
      "file_pos": 7
    },
    {
      "position": 33,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._writedata__BaseHDU._writedata.offset.8.1",
      "distance": 0.9704902172088623,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 563,
      "end_line": 599,
      "tokens": 354,
      "context_length": 14881
    },
    {
      "position": 34,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._get_raw_data__BaseHDU._prewriteto.3",
      "distance": 0.9755048751831055,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 462,
      "end_line": 487,
      "tokens": 211,
      "context_length": 15092
    },
    {
      "position": 35,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_26__BaseHDU.__new__.3.1",
      "distance": 0.9805697798728943,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 121,
      "end_line": 151,
      "tokens": 266,
      "context_length": 15358
    },
    {
      "position": 36,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_bz2_deprecated_renamed_argument",
      "distance": 0.9810985922813416,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 4,
      "end_line": 25,
      "tokens": 165,
      "context_length": 15523,
      "file_pos": 7
    },
    {
      "position": 37,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_fitsopen.conf_fitsopen.7.1",
      "distance": 0.9838943481445312,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 143,
      "end_line": 164,
      "tokens": 197,
      "context_length": 15720,
      "file_pos": 7
    },
    {
      "position": 38,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU.__init____BaseHDU.match_header.1",
      "distance": 0.9873366355895996,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 153,
      "end_line": 256,
      "tokens": 806,
      "context_length": 16526
    },
    {
      "position": 39,
      "id": "/tmp/repos/astropy/astropy/wcs/wcs.py_WCS.to_fits_WCS.to_fits.7.1",
      "distance": 0.9904743432998657,
      "file_path": "astropy/wcs/wcs.py",
      "start_line": 2385,
      "end_line": 2426,
      "tokens": 317,
      "context_length": 16843
    },
    {
      "position": 40,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU.columns_GroupsHDU.columns.22.1",
      "distance": 1.001537799835205,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 306,
      "end_line": 343,
      "tokens": 366,
      "context_length": 17209
    },
    {
      "position": 41,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU.readfrom__BaseHDU.readfrom.9.1",
      "distance": 1.0035346746444702,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 297,
      "end_line": 333,
      "tokens": 366,
      "context_length": 17575
    },
    {
      "position": 42,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU.fromstring__BaseHDU.fromstring.2.1",
      "distance": 1.0046796798706055,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 258,
      "end_line": 295,
      "tokens": 364,
      "context_length": 17939
    },
    {
      "position": 43,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/nonstandard.py_gzip_FitsHDU.fromfile.2.1",
      "distance": 1.015160083770752,
      "file_path": "astropy/io/fits/hdu/nonstandard.py",
      "start_line": 3,
      "end_line": 55,
      "tokens": 409,
      "context_length": 18348
    },
    {
      "position": 44,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU.data_8__TableBaseHDU.data_8.7.1",
      "distance": 1.01646888256073,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 414,
      "end_line": 468,
      "tokens": 467,
      "context_length": 18815
    },
    {
      "position": 45,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__NonstandardHDU__NonstandardHDU._standard.1",
      "distance": 1.0191991329193115,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 767,
      "end_line": 782,
      "tokens": 176,
      "context_length": 18991
    },
    {
      "position": 46,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU._summary__par_indices.4.1",
      "distance": 1.0211172103881836,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 569,
      "end_line": 600,
      "tokens": 231,
      "context_length": 19222
    },
    {
      "position": 47,
      "id": "/tmp/repos/astropy/astropy/io/fits/convenience.py__makehdu__makehdu.4.1",
      "distance": 1.021720290184021,
      "file_path": "astropy/io/fits/convenience.py",
      "start_line": 1016,
      "end_line": 1030,
      "tokens": 152,
      "context_length": 19374
    },
    {
      "position": 48,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._postwriteto__BaseHDU._writeheader.3.1",
      "distance": 1.0229005813598633,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 537,
      "end_line": 561,
      "tokens": 195,
      "context_length": 19569
    },
    {
      "position": 49,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU._nrows__TableBaseHDU.copy.4.1",
      "distance": 1.026718258857727,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 470,
      "end_line": 505,
      "tokens": 324,
      "context_length": 19893
    },
    {
      "position": 50,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_ExtensionHDU_ExtensionHDU.writeto.5",
      "distance": 1.0268222093582153,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1506,
      "end_line": 1543,
      "tokens": 268,
      "context_length": 20161
    },
    {
      "position": 51,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU._init_tbdata__TableLikeHDU._init_tbdata.14",
      "distance": 1.0277128219604492,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 187,
      "end_line": 208,
      "tokens": 200,
      "context_length": 20361
    },
    {
      "position": 52,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU._prewriteto__ImageBaseHDU._writedata_internal.3.1",
      "distance": 1.032836675643921,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 600,
      "end_line": 653,
      "tokens": 411,
      "context_length": 20772
    },
    {
      "position": 53,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDUMeta__BaseHDUMeta.__init__.6.2.data.3",
      "distance": 1.0328657627105713,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 90,
      "end_line": 118,
      "tokens": 328,
      "context_length": 21100
    },
    {
      "position": 54,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._summary_CompImageHDU._summary.5.1",
      "distance": 1.03410005569458,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1584,
      "end_line": 1614,
      "tokens": 248,
      "context_length": 21348
    },
    {
      "position": 55,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.data_CompImageHDU.data.data.7.1",
      "distance": 1.036102533340454,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1365,
      "end_line": 1406,
      "tokens": 377,
      "context_length": 21725
    },
    {
      "position": 56,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_45_CompImageHDU.5",
      "distance": 1.037834644317627,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 373,
      "end_line": 394,
      "tokens": 218,
      "context_length": 21943
    },
    {
      "position": 57,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU__TableLikeHDU.match_header.2",
      "distance": 1.0413724184036255,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 48,
      "end_line": 70,
      "tokens": 184,
      "context_length": 22127
    },
    {
      "position": 58,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._prewriteto_CompImageHDU._prewriteto.3.1",
      "distance": 1.046895980834961,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1793,
      "end_line": 1826,
      "tokens": 364,
      "context_length": 22491
    },
    {
      "position": 59,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU._get_tbdata__TableLikeHDU._get_tbdata.10.1",
      "distance": 1.047705054283142,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 154,
      "end_line": 185,
      "tokens": 313,
      "context_length": 22804
    },
    {
      "position": 60,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.__init__.2_CompImageHDU.__init__.self._orig_bitpix.1",
      "distance": 1.0493252277374268,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 608,
      "end_line": 672,
      "tokens": 747,
      "context_length": 23551
    },
    {
      "position": 61,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_TableHDU._get_tbdata_TableHDU._get_tbdata.16.1",
      "distance": 1.0508437156677246,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 746,
      "end_line": 776,
      "tokens": 313,
      "context_length": 23864
    },
    {
      "position": 62,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU._summary__ImageBaseHDU._summary.7.1",
      "distance": 1.0524873733520508,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 773,
      "end_line": 804,
      "tokens": 268,
      "context_length": 24132
    },
    {
      "position": 63,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/streaming.py_gzip_StreamingHDU.1",
      "distance": 1.054778814315796,
      "file_path": "astropy/io/fits/hdu/streaming.py",
      "start_line": 3,
      "end_line": 34,
      "tokens": 173,
      "context_length": 24305
    },
    {
      "position": 64,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU.data_11__ImageBaseHDU.data_11.24.1",
      "distance": 1.054797887802124,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 248,
      "end_line": 308,
      "tokens": 574,
      "context_length": 24879
    },
    {
      "position": 65,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_29__CorruptedHDU.verify.1",
      "distance": 1.0585823059082031,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 719,
      "end_line": 764,
      "tokens": 377,
      "context_length": 25256
    },
    {
      "position": 66,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.data_10_CompImageHDU.compressed_data.compressed_data.3.1",
      "distance": 1.0612558126449585,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1408,
      "end_line": 1433,
      "tokens": 248,
      "context_length": 25504
    },
    {
      "position": 67,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._readfrom_internal__BaseHDU._readfrom_internal.27.1",
      "distance": 1.0621315240859985,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 375,
      "end_line": 460,
      "tokens": 742,
      "context_length": 26246
    },
    {
      "position": 68,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__hdu_class_from_header__hdu_class_from_header.5.1",
      "distance": 1.0624444484710693,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 56,
      "end_line": 87,
      "tokens": 248,
      "context_length": 26494
    },
    {
      "position": 69,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/hdulist.py_HDUList.close_HDUList.close.2.2.3.1",
      "distance": 1.0673714876174927,
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "start_line": 908,
      "end_line": 938,
      "tokens": 284,
      "context_length": 26778,
      "file_pos": 13
    },
    {
      "position": 70,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.scale.self._bzero_CompImageHDU.scale.self._orig_bscale.1",
      "distance": 1.069939374923706,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1775,
      "end_line": 1791,
      "tokens": 238,
      "context_length": 27016
    },
    {
      "position": 71,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.compressed_data_12_CompImageHDU.shape.3.1",
      "distance": 1.071009874343872,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1435,
      "end_line": 1462,
      "tokens": 256,
      "context_length": 27272
    },
    {
      "position": 72,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._load_data.31_BinTableHDU._load_data.36.1",
      "distance": 1.0732347965240479,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1406,
      "end_line": 1440,
      "tokens": 306,
      "context_length": 27578
    },
    {
      "position": 73,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU._summary__TableBaseHDU._update_column_removed.3",
      "distance": 1.0754327774047852,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 555,
      "end_line": 590,
      "tokens": 281,
      "context_length": 27859
    },
    {
      "position": 74,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_NonstandardExtHDU_NonstandardExtHDU._standard.1",
      "distance": 1.0766346454620361,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1564,
      "end_line": 1576,
      "tokens": 129,
      "context_length": 27988
    },
    {
      "position": 75,
      "id": "/tmp/repos/astropy/astropy/io/fits/diff.py_HDUDiff._diff_HDUDiff._diff.6.5.self.diff_data.1",
      "distance": 1.0778915882110596,
      "file_path": "astropy/io/fits/diff.py",
      "start_line": 465,
      "end_line": 497,
      "tokens": 337,
      "context_length": 28325
    },
    {
      "position": 76,
      "id": "/tmp/repos/astropy/astropy/io/fits/diff.py_FITSDiff_FITSDiff.1",
      "distance": 1.0781128406524658,
      "file_path": "astropy/io/fits/diff.py",
      "start_line": 199,
      "end_line": 211,
      "tokens": 140,
      "context_length": 28465
    },
    {
      "position": 77,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._dump_data.8_BinTableHDU._dump_data.9.1",
      "distance": 1.0781351327896118,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1233,
      "end_line": 1273,
      "tokens": 367,
      "context_length": 28832
    },
    {
      "position": 78,
      "id": "/tmp/repos/astropy/astropy/table/column.py_BaseColumn.copy_BaseColumn.copy.9.1",
      "distance": 1.0789703130722046,
      "file_path": "astropy/table/column.py",
      "start_line": 260,
      "end_line": 302,
      "tokens": 386,
      "context_length": 29218
    },
    {
      "position": 79,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__BaseHDU._writedata_internal__BaseHDU._writedata_direct_copy.3.3.1.1",
      "distance": 1.0801706314086914,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 601,
      "end_line": 629,
      "tokens": 263,
      "context_length": 29481
    },
    {
      "position": 80,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__NonstandardHDU._writedata__NonstandardHDU._verify.4.1",
      "distance": 1.0836811065673828,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 815,
      "end_line": 860,
      "tokens": 297,
      "context_length": 29778
    },
    {
      "position": 81,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._close_CompImageHDU.24",
      "distance": 1.0846447944641113,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1853,
      "end_line": 1863,
      "tokens": 123,
      "context_length": 29901
    },
    {
      "position": 82,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU.match_header__ImageBaseHDU.section.2.1",
      "distance": 1.0847723484039307,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 176,
      "end_line": 204,
      "tokens": 219,
      "context_length": 30120
    },
    {
      "position": 83,
      "id": "/tmp/repos/astropy/astropy/nddata/ccddata.py_CCDData.to_hdu.6_CCDData.to_hdu.10.1",
      "distance": 1.0866914987564087,
      "file_path": "astropy/nddata/ccddata.py",
      "start_line": 295,
      "end_line": 332,
      "tokens": 431,
      "context_length": 30551
    },
    {
      "position": 84,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU.from_columns__TableLikeHDU.from_columns.6.1",
      "distance": 1.0867893695831299,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 72,
      "end_line": 131,
      "tokens": 588,
      "context_length": 31139
    },
    {
      "position": 85,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_PrimaryHDU_PrimaryHDU.update_header.3.2",
      "distance": 1.0892393589019775,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 949,
      "end_line": 1028,
      "tokens": 678,
      "context_length": 31817
    },
    {
      "position": 86,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU_GroupsHDU.parnames.5.1",
      "distance": 1.0905113220214844,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 252,
      "end_line": 304,
      "tokens": 479,
      "context_length": 32296
    },
    {
      "position": 87,
      "id": "/tmp/repos/astropy/astropy/io/misc/asdf/tags/fits/fits.py_FitsType.to_tree_FitsType.to_tree.3.1",
      "distance": 1.0909068584442139,
      "file_path": "astropy/io/misc/asdf/tags/fits/fits.py",
      "start_line": 42,
      "end_line": 71,
      "tokens": 206,
      "context_length": 32502
    },
    {
      "position": 88,
      "id": "/tmp/repos/astropy/astropy/table/table.py_Table.copy_Table.__ge__.1.1",
      "distance": 1.0911872386932373,
      "file_path": "astropy/table/table.py",
      "start_line": 2562,
      "end_line": 2597,
      "tokens": 245,
      "context_length": 32747
    },
    {
      "position": 89,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__NonstandardHDU.match_header__NonstandardHDU.size.3.1",
      "distance": 1.0934748649597168,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 784,
      "end_line": 813,
      "tokens": 218,
      "context_length": 32965
    },
    {
      "position": 90,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU__ValidHDU.match_header.2.1",
      "distance": 1.0935313701629639,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 863,
      "end_line": 894,
      "tokens": 247,
      "context_length": 33212
    },
    {
      "position": 91,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU.match_header__TableBaseHDU.data.6.1",
      "distance": 1.094213604927063,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 385,
      "end_line": 412,
      "tokens": 196,
      "context_length": 33408
    },
    {
      "position": 92,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU_BinTableHDU.match_header.4.1",
      "distance": 1.0969783067703247,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 816,
      "end_line": 866,
      "tokens": 429,
      "context_length": 33837
    },
    {
      "position": 93,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_NonstandardExtHDU.match_header_",
      "distance": 1.0977184772491455,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1578,
      "end_line": 1613,
      "tokens": 292,
      "context_length": 34129
    },
    {
      "position": 94,
      "id": "/tmp/repos/astropy/astropy/wcs/wcs.py_WCS._write_det2im_WCS._write_det2im.8",
      "distance": 1.0984076261520386,
      "file_path": "astropy/wcs/wcs.py",
      "start_line": 826,
      "end_line": 870,
      "tokens": 564,
      "context_length": 34693
    },
    {
      "position": 95,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.__init___CompImageHDU.__init__",
      "distance": 1.098539113998413,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 396,
      "end_line": 672,
      "tokens": 119,
      "context_length": 34812
    },
    {
      "position": 96,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._writedata_internal_BinTableHDU._writedata_internal.5.1",
      "distance": 1.0994302034378052,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 916,
      "end_line": 964,
      "tokens": 393,
      "context_length": 35205
    },
    {
      "position": 97,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._writeheader_CompImageHDU._writedata.2.2.2.3.1",
      "distance": 1.099792242050171,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1828,
      "end_line": 1851,
      "tokens": 203,
      "context_length": 35408
    },
    {
      "position": 98,
      "id": "/tmp/repos/astropy/astropy/io/fits/fitsrec.py_FITS_rec._ipython_key_completions__FITS_rec.columns.2.1",
      "distance": 1.1034985780715942,
      "file_path": "astropy/io/fits/fitsrec.py",
      "start_line": 552,
      "end_line": 579,
      "tokens": 220,
      "context_length": 35628
    },
    {
      "position": 99,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_sys__ImageBaseHDU.standard_keyword_comments.1",
      "distance": 1.104433536529541,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 3,
      "end_line": 36,
      "tokens": 205,
      "context_length": 35833
    },
    {
      "position": 100,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU.dump_BinTableHDU.12.1",
      "distance": 1.1080186367034912,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1045,
      "end_line": 1114,
      "tokens": 574,
      "context_length": 36407
    },
    {
      "position": 101,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_ImageHDU_ImageHDU.match_header.4.1",
      "distance": 1.1084249019622803,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 1044,
      "end_line": 1111,
      "tokens": 580,
      "context_length": 36987
    },
    {
      "position": 102,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU.__init____TableBaseHDU.__init__.10.self.ver.1",
      "distance": 1.1104011535644531,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 276,
      "end_line": 383,
      "tokens": 1054,
      "context_length": 38041
    },
    {
      "position": 103,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU._scale_internal__ImageBaseHDU._scale_internal.self._orig_blank.1",
      "distance": 1.1106274127960205,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 461,
      "end_line": 564,
      "tokens": 978,
      "context_length": 39019
    },
    {
      "position": 104,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU.columns__TableLikeHDU._nrows.2",
      "distance": 1.1112703084945679,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 133,
      "end_line": 152,
      "tokens": 128,
      "context_length": 39147
    },
    {
      "position": 105,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU._verify__ImageBaseHDU._verify_blank.4.7.1",
      "distance": 1.1149035692214966,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 566,
      "end_line": 598,
      "tokens": 303,
      "context_length": 39450
    },
    {
      "position": 106,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU._nrows_GroupsHDU.size.6.1",
      "distance": 1.116951584815979,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 345,
      "end_line": 381,
      "tokens": 314,
      "context_length": 39764
    },
    {
      "position": 107,
      "id": "/tmp/repos/astropy/astropy/io/fits/diff.py_HDUDiff_HDUDiff.__init__.16",
      "distance": 1.1189777851104736,
      "file_path": "astropy/io/fits/diff.py",
      "start_line": 402,
      "end_line": 463,
      "tokens": 622,
      "context_length": 40386
    },
    {
      "position": 108,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py__ImageBaseHDU.__init____ImageBaseHDU.__init__.44.self._orig_bscale.1",
      "distance": 1.1199758052825928,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 38,
      "end_line": 174,
      "tokens": 1353,
      "context_length": 41739
    },
    {
      "position": 109,
      "id": "/tmp/repos/astropy/astropy/io/fits/header.py_Header.clear_Header.copy.4.1",
      "distance": 1.121323585510254,
      "file_path": "astropy/io/fits/header.py",
      "start_line": 743,
      "end_line": 776,
      "tokens": 199,
      "context_length": 41938
    },
    {
      "position": 110,
      "id": "/tmp/repos/astropy/astropy/wcs/wcs.py_WCS.copy_WCS.8.sub.__doc__.1",
      "distance": 1.121814250946045,
      "file_path": "astropy/wcs/wcs.py",
      "start_line": 535,
      "end_line": 563,
      "tokens": 189,
      "context_length": 42127
    },
    {
      "position": 111,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.match_header_CompImageHDU.match_header.7.3.2.1",
      "distance": 1.1224161386489868,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 674,
      "end_line": 700,
      "tokens": 201,
      "context_length": 42328
    },
    {
      "position": 112,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._update_header_data.85_CompImageHDU._update_header_data.89.5.1",
      "distance": 1.127406358718872,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1348,
      "end_line": 1363,
      "tokens": 226,
      "context_length": 42554
    },
    {
      "position": 113,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._dump_data.format_value_BinTableHDU._dump_data.format_value.1.5.2.1",
      "distance": 1.1276698112487793,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1220,
      "end_line": 1231,
      "tokens": 161,
      "context_length": 42715
    },
    {
      "position": 114,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU.size__ValidHDU.filebytes.4.1",
      "distance": 1.127838373184204,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 896,
      "end_line": 922,
      "tokens": 243,
      "context_length": 42958
    },
    {
      "position": 115,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableBaseHDU._prewriteto__TableBaseHDU._prewriteto.2.1",
      "distance": 1.128129005432129,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 507,
      "end_line": 536,
      "tokens": 345,
      "context_length": 43303
    },
    {
      "position": 116,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._update_header_scale_info_CompImageHDU._update_header_scale_info.1.self._bitpix.1",
      "distance": 1.128795862197876,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1885,
      "end_line": 1906,
      "tokens": 234,
      "context_length": 43537
    },
    {
      "position": 117,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU.22__ValidHDU._EXCLUDE.1",
      "distance": 1.1296558380126953,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1441,
      "end_line": 1449,
      "tokens": 153,
      "context_length": 43690
    },
    {
      "position": 118,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU.update_header_GroupsHDU.update_header.10.2",
      "distance": 1.131932258605957,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 383,
      "end_line": 447,
      "tokens": 644,
      "context_length": 44334
    },
    {
      "position": 119,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._update_compressed_data_CompImageHDU._update_compressed_data.self.compressed_data._heapsize.1",
      "distance": 1.132352590560913,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1616,
      "end_line": 1683,
      "tokens": 625,
      "context_length": 44959
    },
    {
      "position": 120,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._writedata_by_row_BinTableHDU._writedata_by_row.5.1.5.5",
      "distance": 1.1343491077423096,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 966,
      "end_line": 990,
      "tokens": 241,
      "context_length": 45200
    },
    {
      "position": 121,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py_datetime_InvalidHDUException.1",
      "distance": 1.1344622373580933,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 5,
      "end_line": 53,
      "tokens": 370,
      "context_length": 45570
    },
    {
      "position": 122,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._load_data.format_value_BinTableHDU._load_data.format_value.2.3.1.1",
      "distance": 1.1348302364349365,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1393,
      "end_line": 1404,
      "tokens": 163,
      "context_length": 45733
    },
    {
      "position": 123,
      "id": "/tmp/repos/astropy/astropy/io/fits/convenience.py_table_to_hdu_table_to_hdu.10",
      "distance": 1.1358410120010376,
      "file_path": "astropy/io/fits/convenience.py",
      "start_line": 426,
      "end_line": 500,
      "tokens": 701,
      "context_length": 46434
    },
    {
      "position": 124,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU._compute_hdu_checksum__ValidHDU._compute_hdu_checksum.15.1",
      "distance": 1.1361758708953857,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1397,
      "end_line": 1439,
      "tokens": 363,
      "context_length": 46797
    },
    {
      "position": 125,
      "id": "/tmp/repos/astropy/astropy/io/fits/diff.py_HDUDiff._report_HDUDiff._report.7.3",
      "distance": 1.1372365951538086,
      "file_path": "astropy/io/fits/diff.py",
      "start_line": 499,
      "end_line": 524,
      "tokens": 270,
      "context_length": 47067
    },
    {
      "position": 126,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU.14_BinTableHDU._dump_data.6",
      "distance": 1.1379278898239136,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 1194,
      "end_line": 1219,
      "tokens": 211,
      "context_length": 47278
    },
    {
      "position": 127,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/groups.py_GroupsHDU._verify_GroupsHDU._verify.10.1",
      "distance": 1.1382102966308594,
      "file_path": "astropy/io/fits/hdu/groups.py",
      "start_line": 501,
      "end_line": 518,
      "tokens": 213,
      "context_length": 47491
    },
    {
      "position": 128,
      "id": "/tmp/repos/astropy/astropy/io/fits/convenience.py__getext__getext.12.1",
      "distance": 1.1385548114776611,
      "file_path": "astropy/io/fits/convenience.py",
      "start_line": 945,
      "end_line": 1013,
      "tokens": 686,
      "context_length": 48177
    },
    {
      "position": 129,
      "id": "/tmp/repos/astropy/astropy/io/fits/convenience.py_operator___all__.1",
      "distance": 1.139493465423584,
      "file_path": "astropy/io/fits/convenience.py",
      "start_line": 58,
      "end_line": 81,
      "tokens": 218,
      "context_length": 48395
    },
    {
      "position": 130,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU._verify__ValidHDU.10",
      "distance": 1.141359567642212,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 971,
      "end_line": 1039,
      "tokens": 639,
      "context_length": 49034
    },
    {
      "position": 131,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_Section.__getitem___Section.__getitem__.19.1",
      "distance": 1.1419787406921387,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 872,
      "end_line": 925,
      "tokens": 530,
      "context_length": 49564
    },
    {
      "position": 132,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/base.py__ValidHDU.add_checksum__ValidHDU.add_checksum.7",
      "distance": 1.143057942390442,
      "file_path": "astropy/io/fits/hdu/base.py",
      "start_line": 1194,
      "end_line": 1247,
      "tokens": 482,
      "context_length": 50046
    },
    {
      "position": 133,
      "id": "/tmp/repos/astropy/astropy/io/fits/scripts/fitsheader.py_HeaderFormatter._get_cards_HeaderFormatter._get_cards.5.1",
      "distance": 1.1434636116027832,
      "file_path": "astropy/io/fits/scripts/fitsheader.py",
      "start_line": 143,
      "end_line": 197,
      "tokens": 410,
      "context_length": 50456
    },
    {
      "position": 134,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU.header_CompImageHDU.header.6.45.1",
      "distance": 1.144382119178772,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1464,
      "end_line": 1582,
      "tokens": 1216,
      "context_length": 51672
    },
    {
      "position": 135,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py_BinTableHDU._tdump_file_format_BinTableHDU._tdump_file_format.1",
      "distance": 1.1455705165863037,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 992,
      "end_line": 1043,
      "tokens": 676,
      "context_length": 52348
    },
    {
      "position": 136,
      "id": "/tmp/repos/astropy/astropy/nddata/ccddata.py_CCDData.copy_CCDData._insert_in_metadata_fits_safe.2.4.1",
      "distance": 1.1455814838409424,
      "file_path": "astropy/nddata/ccddata.py",
      "start_line": 334,
      "end_line": 375,
      "tokens": 347,
      "context_length": 52695
    },
    {
      "position": 137,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._update_header_data.84_CompImageHDU._update_header_data.84.4.6.5.1",
      "distance": 1.1465229988098145,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1266,
      "end_line": 1346,
      "tokens": 808,
      "context_length": 53503
    },
    {
      "position": 138,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/compressed.py_CompImageHDU._update_header_data.83_CompImageHDU._update_header_data.83.2",
      "distance": 1.1500709056854248,
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "start_line": 1208,
      "end_line": 1264,
      "tokens": 620,
      "context_length": 54123
    },
    {
      "position": 139,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_Section._getdata_Section._getdata.3.3.2.1",
      "distance": 1.1504253149032593,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 927,
      "end_line": 946,
      "tokens": 201,
      "context_length": 54324
    },
    {
      "position": 140,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/image.py_PrimaryHDU._verify_PrimaryHDU._verify.7.1",
      "distance": 1.1513378620147705,
      "file_path": "astropy/io/fits/hdu/image.py",
      "start_line": 1030,
      "end_line": 1041,
      "tokens": 150,
      "context_length": 54474
    },
    {
      "position": 141,
      "id": "/tmp/repos/astropy/astropy/table/column.py_col_copy_col_copy.13.1",
      "distance": 1.152263879776001,
      "file_path": "astropy/table/column.py",
      "start_line": 68,
      "end_line": 107,
      "tokens": 270,
      "context_length": 54744
    },
    {
      "position": 142,
      "id": "/tmp/repos/astropy/astropy/io/fits/util.py__free_space_check__free_space_check.1.2.6",
      "distance": 1.1529960632324219,
      "file_path": "astropy/io/fits/util.py",
      "start_line": 824,
      "end_line": 844,
      "tokens": 167,
      "context_length": 54911
    },
    {
      "position": 143,
      "id": "/tmp/repos/astropy/astropy/io/fits/hdu/table.py__TableLikeHDU._update_column_added__TableLikeHDU._update_column_removed.6.1",
      "distance": 1.1544357538223267,
      "file_path": "astropy/io/fits/hdu/table.py",
      "start_line": 210,
      "end_line": 234,
      "tokens": 224,
      "context_length": 55135
    }
  ],
  "files": [
    {
      "file_path": "astropy/io/fits/hdu/hdulist.py",
      "position": 1,
      "tokens": 11238,
      "context_length": 11238
    },
    {
      "file_path": "astropy/io/fits/hdu/nonstandard.py",
      "position": 2,
      "tokens": 953,
      "context_length": 12191
    },
    {
      "file_path": "astropy/nddata/ccddata.py",
      "position": 3,
      "tokens": 4962,
      "context_length": 17153
    },
    {
      "file_path": "astropy/io/fits/hdu/base.py",
      "position": 4,
      "tokens": 13031,
      "context_length": 30184
    },
    {
      "file_path": "astropy/io/fits/hdu/__init__.py",
      "position": 5,
      "tokens": 214,
      "context_length": 30398
    },
    {
      "file_path": "astropy/io/fits/hdu/groups.py",
      "position": 6,
      "tokens": 4954,
      "context_length": 35352
    },
    {
      "file_path": "examples/io/create-mef.py",
      "position": 7,
      "tokens": 331,
      "context_length": 35683
    },
    {
      "file_path": "astropy/wcs/wcs.py",
      "position": 8,
      "tokens": 28399,
      "context_length": 64082
    },
    {
      "file_path": "astropy/io/fits/hdu/table.py",
      "position": 9,
      "tokens": 13091,
      "context_length": 77173
    },
    {
      "file_path": "astropy/io/fits/convenience.py",
      "position": 10,
      "tokens": 9126,
      "context_length": 86299
    },
    {
      "file_path": "astropy/io/fits/hdu/image.py",
      "position": 11,
      "tokens": 9984,
      "context_length": 96283
    },
    {
      "file_path": "astropy/io/fits/hdu/compressed.py",
      "position": 12,
      "tokens": 18798,
      "context_length": 115081
    },
    {
      "file_path": "astropy/io/fits/hdu/streaming.py",
      "position": 13,
      "tokens": 1728,
      "context_length": 116809
    },
    {
      "file_path": "astropy/io/fits/diff.py",
      "position": 14,
      "tokens": 12038,
      "context_length": 128847
    },
    {
      "file_path": "astropy/table/column.py",
      "position": 15,
      "tokens": 10765,
      "context_length": 139612
    },
    {
      "file_path": "astropy/io/misc/asdf/tags/fits/fits.py",
      "position": 16,
      "tokens": 600,
      "context_length": 140212
    },
    {
      "file_path": "astropy/table/table.py",
      "position": 17,
      "tokens": 22891,
      "context_length": 163103
    },
    {
      "file_path": "astropy/io/fits/fitsrec.py",
      "position": 18,
      "tokens": 11511,
      "context_length": 174614
    },
    {
      "file_path": "astropy/io/fits/header.py",
      "position": 19,
      "tokens": 15371,
      "context_length": 189985
    },
    {
      "file_path": "astropy/io/fits/scripts/fitsheader.py",
      "position": 20,
      "tokens": 2502,
      "context_length": 192487
    },
    {
      "file_path": "astropy/io/fits/util.py",
      "position": 21,
      "tokens": 6936,
      "context_length": 199423
    }
  ]
}