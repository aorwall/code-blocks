{
  "instance_id": "django__django-11179",
  "model_patch": "diff --git a/django/db/models/deletion.py b/django/db/models/deletion.py\nindex 92fe4affb9..3f21e59418 100644\n--- a/django/db/models/deletion.py\n+++ b/django/db/models/deletion.py\n@@ -272,8 +272,9 @@ class Collector:\n         deleted_counter = Counter()\n \n         # Optimize for the case with a single obj and no dependencies\n-        if len(self.data) == 1 and len(instances) == 1:\n-            instance = list(instances)[0]\n+        if len(self.data) == 1:\n+            model, instances = next(iter(self.data.items()))\n+            instance = next(iter(instances))\n             if self.can_fast_delete(instance):\n                 with transaction.mark_for_rollback_on_error():\n                     count = sql.DeleteQuery(model).delete_batch([instance.pk], self.using)\n@@ -316,12 +317,10 @@ class Collector:\n                             sender=model, instance=obj, using=self.using\n                         )\n \n-        # update collected instances\n-        for instances_for_fieldvalues in self.field_updates.values():\n-            for (field, value), instances in instances_for_fieldvalues.items():\n-                for obj in instances:\n-                    setattr(obj, field.attname, value)\n+        # Update collected instances\n         for model, instances in self.data.items():\n-            for instance in instances:\n-                setattr(instance, model._meta.pk.attname, None)\n+            # Check if the model has no dependencies before setting PK to None\n+            if not self.dependencies.get(model._meta.concrete_model):\n+                for instance in instances:\n+                    setattr(instance, model._meta.pk.attname, None)\n         return sum(deleted_counter.values()), dict(deleted_counter)\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "django/db/models/deletion.py"
  ],
  "repo": "django/django",
  "base_commit": "19fc6376ce67d01ca37a91ef2f55ef769f50513a",
  "patch": "diff --git a/django/db/models/deletion.py b/django/db/models/deletion.py\n--- a/django/db/models/deletion.py\n+++ b/django/db/models/deletion.py\n@@ -277,6 +277,7 @@ def delete(self):\n             if self.can_fast_delete(instance):\n                 with transaction.mark_for_rollback_on_error():\n                     count = sql.DeleteQuery(model).delete_batch([instance.pk], self.using)\n+                setattr(instance, model._meta.pk.attname, None)\n                 return count, {model._meta.label: count}\n \n         with transaction.atomic(using=self.using, savepoint=False):\n",
  "test_patch": "diff --git a/tests/delete/tests.py b/tests/delete/tests.py\n--- a/tests/delete/tests.py\n+++ b/tests/delete/tests.py\n@@ -1,6 +1,7 @@\n from math import ceil\n \n from django.db import IntegrityError, connection, models\n+from django.db.models.deletion import Collector\n from django.db.models.sql.constants import GET_ITERATOR_CHUNK_SIZE\n from django.test import TestCase, skipIfDBFeature, skipUnlessDBFeature\n \n@@ -471,6 +472,14 @@ def test_fast_delete_qs(self):\n         self.assertEqual(User.objects.count(), 1)\n         self.assertTrue(User.objects.filter(pk=u2.pk).exists())\n \n+    def test_fast_delete_instance_set_pk_none(self):\n+        u = User.objects.create()\n+        # User can be fast-deleted.\n+        collector = Collector(using='default')\n+        self.assertTrue(collector.can_fast_delete(u))\n+        u.delete()\n+        self.assertIsNone(u.pk)\n+\n     def test_fast_delete_joined_qs(self):\n         a = Avatar.objects.create(desc='a')\n         User.objects.create(avatar=a)\n",
  "problem_statement": "delete() on instances of models without any dependencies doesn't clear PKs.\nDescription\n\t\nDeleting any model with no dependencies not updates the PK on the model. It should be set to None after .delete() call.\nSee Django.db.models.deletion:276-281. Should update the model line 280.\n",
  "hints_text": "Reproduced at 1ffddfc233e2d5139cc6ec31a4ec6ef70b10f87f. Regression in bc7dd8490b882b2cefdc7faf431dc64c532b79c9. Thanks for the report.\nRegression test.\nI have attached a simple fix which mimics what \u200bhttps://github.com/django/django/blob/master/django/db/models/deletion.py#L324-L326 does for multiple objects. I am not sure if we need \u200bhttps://github.com/django/django/blob/master/django/db/models/deletion.py#L320-L323 (the block above) because I think field_updates is only ever filled if the objects are not fast-deletable -- ie \u200bhttps://github.com/django/django/blob/master/django/db/models/deletion.py#L224 is not called due to the can_fast_delete check at the beginning of the collect function. That said, if we want to be extra \"safe\" we can just move lines 320 - 326 into an extra function and call that from the old and new location (though I do not think it is needed).",
  "created_at": "2019-04-05T15:54:39Z",
  "version": "3.0",
  "FAIL_TO_PASS": "[\"test_fast_delete_instance_set_pk_none (delete.tests.FastDeleteTests)\"]",
  "PASS_TO_PASS": "[\"test_auto (delete.tests.OnDeleteTests)\", \"test_auto_nullable (delete.tests.OnDeleteTests)\", \"test_bulk (delete.tests.DeletionTests)\", \"test_can_defer_constraint_checks (delete.tests.DeletionTests)\", \"test_cascade (delete.tests.OnDeleteTests)\", \"test_cascade_from_child (delete.tests.OnDeleteTests)\", \"test_cascade_from_parent (delete.tests.OnDeleteTests)\", \"test_cascade_nullable (delete.tests.OnDeleteTests)\", \"test_delete_with_keeping_parents (delete.tests.DeletionTests)\", \"test_delete_with_keeping_parents_relationships (delete.tests.DeletionTests)\", \"test_deletion_order (delete.tests.DeletionTests)\", \"test_do_nothing (delete.tests.OnDeleteTests)\", \"test_do_nothing_qscount (delete.tests.OnDeleteTests)\", \"test_fast_delete_empty_no_update_can_self_select (delete.tests.FastDeleteTests)\", \"test_fast_delete_fk (delete.tests.FastDeleteTests)\", \"test_fast_delete_inheritance (delete.tests.FastDeleteTests)\", \"test_fast_delete_joined_qs (delete.tests.FastDeleteTests)\", \"test_fast_delete_large_batch (delete.tests.FastDeleteTests)\", \"test_fast_delete_m2m (delete.tests.FastDeleteTests)\", \"test_fast_delete_qs (delete.tests.FastDeleteTests)\", \"test_fast_delete_revm2m (delete.tests.FastDeleteTests)\", \"test_hidden_related (delete.tests.DeletionTests)\", \"test_inheritance_cascade_down (delete.tests.OnDeleteTests)\", \"test_inheritance_cascade_up (delete.tests.OnDeleteTests)\", \"test_instance_update (delete.tests.DeletionTests)\", \"test_large_delete (delete.tests.DeletionTests)\", \"test_large_delete_related (delete.tests.DeletionTests)\", \"test_m2m (delete.tests.DeletionTests)\", \"test_model_delete_returns_num_rows (delete.tests.DeletionTests)\", \"test_o2o_setnull (delete.tests.OnDeleteTests)\", \"test_protect (delete.tests.OnDeleteTests)\", \"test_proxied_model_duplicate_queries (delete.tests.DeletionTests)\", \"test_queryset_delete_returns_num_rows (delete.tests.DeletionTests)\", \"test_relational_post_delete_signals_happen_before_parent_object (delete.tests.DeletionTests)\", \"test_setdefault (delete.tests.OnDeleteTests)\", \"test_setdefault_none (delete.tests.OnDeleteTests)\", \"test_setnull (delete.tests.OnDeleteTests)\", \"test_setnull_from_child (delete.tests.OnDeleteTests)\", \"test_setnull_from_parent (delete.tests.OnDeleteTests)\", \"test_setvalue (delete.tests.OnDeleteTests)\"]",
  "environment_setup_commit": "419a78300f7cd27611196e1e464d50fd0385ff27",
  "patch_files": [
    "django/db/models/deletion.py"
  ],
  "test_patch_files": [
    "tests/delete/tests.py"
  ],
  "patch_diff_details": {
    "django/db/models/deletion.py": {
      "diffs": [
        {
          "start_line_old": 280,
          "end_line_old": 280,
          "file_pos": 1,
          "file_context_length": 2761,
          "pos": 1,
          "context_length": 556
        }
      ]
    }
  },
  "vectors": 3371,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.delete_",
      "distance": 0.8785327672958374,
      "file_path": "django/db/models/deletion.py",
      "start_line": 262,
      "end_line": 328,
      "tokens": 556,
      "context_length": 556,
      "file_pos": 1
    },
    {
      "position": 2,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor.delete_model_BaseDatabaseSchemaEditor.delete_model.7.1.1",
      "distance": 0.9668017029762268,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 318,
      "end_line": 332,
      "tokens": 141,
      "context_length": 697
    },
    {
      "position": 3,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector_Collector.__init__.15",
      "distance": 0.9849832057952881,
      "file_path": "django/db/models/deletion.py",
      "start_line": 63,
      "end_line": 78,
      "tokens": 162,
      "context_length": 859,
      "file_pos": 2
    },
    {
      "position": 4,
      "id": "/tmp/repos/django/django/db/backends/oracle/schema.py_DatabaseSchemaEditor.delete_model_DatabaseSchemaEditor.delete_model.2",
      "distance": 0.9997560977935791,
      "file_path": "django/db/backends/oracle/schema.py",
      "start_line": 41,
      "end_line": 55,
      "tokens": 133,
      "context_length": 992
    },
    {
      "position": 5,
      "id": "/tmp/repos/django/django/contrib/gis/db/backends/spatialite/schema.py_SpatialiteSchemaEditor.delete_model_SpatialiteSchemaEditor.delete_model.6",
      "distance": 1.0261855125427246,
      "file_path": "django/contrib/gis/db/backends/spatialite/schema.py",
      "start_line": 84,
      "end_line": 101,
      "tokens": 154,
      "context_length": 1146
    },
    {
      "position": 6,
      "id": "/tmp/repos/django/django/db/migrations/operations/models.py_DeleteModel_DeleteModel.describe.1.1",
      "distance": 1.0360209941864014,
      "file_path": "django/db/migrations/operations/models.py",
      "start_line": 242,
      "end_line": 274,
      "tokens": 232,
      "context_length": 1378
    },
    {
      "position": 7,
      "id": "/tmp/repos/django/django/db/models/sql/subqueries.py_DeleteQuery.delete_qs_DeleteQuery.delete_qs.10.1",
      "distance": 1.0615477561950684,
      "file_path": "django/db/models/sql/subqueries.py",
      "start_line": 44,
      "end_line": 76,
      "tokens": 312,
      "context_length": 1690
    },
    {
      "position": 8,
      "id": "/tmp/repos/django/django/db/migrations/autodetector.py_MigrationAutodetector.generate_deleted_models_MigrationAutodetector.generate_deleted_models.6.25",
      "distance": 1.0635986328125,
      "file_path": "django/db/migrations/autodetector.py",
      "start_line": 707,
      "end_line": 794,
      "tokens": 789,
      "context_length": 2479
    },
    {
      "position": 9,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._delete_primary_key_",
      "distance": 1.0651676654815674,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 1152,
      "end_line": 1181,
      "tokens": 268,
      "context_length": 2747
    },
    {
      "position": 10,
      "id": "/tmp/repos/django/django/db/models/deletion.py_1_get_candidate_relations_to_delete.3.1",
      "distance": 1.067608118057251,
      "file_path": "django/db/models/deletion.py",
      "start_line": 1,
      "end_line": 60,
      "tokens": 462,
      "context_length": 3209,
      "file_pos": 7
    },
    {
      "position": 11,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.delete_QuerySet.delete.18.1",
      "distance": 1.0801210403442383,
      "file_path": "django/db/models/query.py",
      "start_line": 678,
      "end_line": 704,
      "tokens": 223,
      "context_length": 3432
    },
    {
      "position": 12,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor.remove_field_BaseDatabaseSchemaEditor.remove_field.14.1.1",
      "distance": 1.1036581993103027,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 480,
      "end_line": 508,
      "tokens": 289,
      "context_length": 3721
    },
    {
      "position": 13,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ForeignKey._check_on_delete_ForeignKey._check_on_delete.2.3.1.1",
      "distance": 1.1042871475219727,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 822,
      "end_line": 843,
      "tokens": 169,
      "context_length": 3890
    },
    {
      "position": 14,
      "id": "/tmp/repos/django/django/contrib/sites/models.py_clear_site_cache_",
      "distance": 1.1066455841064453,
      "file_path": "django/contrib/sites/models.py",
      "start_line": 103,
      "end_line": 121,
      "tokens": 121,
      "context_length": 4011
    },
    {
      "position": 15,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.delete.alters_data_QuerySet.update.10.1",
      "distance": 1.1081808805465698,
      "file_path": "django/db/models/query.py",
      "start_line": 706,
      "end_line": 732,
      "tokens": 226,
      "context_length": 4237
    },
    {
      "position": 16,
      "id": "/tmp/repos/django/django/db/backends/mysql/schema.py_DatabaseSchemaEditor._delete_composed_index_DatabaseSchemaEditor._delete_composed_index.4.1",
      "distance": 1.1127548217773438,
      "file_path": "django/db/backends/mysql/schema.py",
      "start_line": 73,
      "end_line": 87,
      "tokens": 201,
      "context_length": 4438
    },
    {
      "position": 17,
      "id": "/tmp/repos/django/django/db/backends/sqlite3/schema.py_DatabaseSchemaEditor.remove_field_DatabaseSchemaEditor.remove_field.3.4.2.2",
      "distance": 1.1172131299972534,
      "file_path": "django/db/backends/sqlite3/schema.py",
      "start_line": 329,
      "end_line": 345,
      "tokens": 173,
      "context_length": 4611
    },
    {
      "position": 18,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._delete_composed_index_BaseDatabaseSchemaEditor._delete_composed_index.6",
      "distance": 1.1199463605880737,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 386,
      "end_line": 400,
      "tokens": 174,
      "context_length": 4785
    },
    {
      "position": 19,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._delete_unique_sql_BaseDatabaseSchemaEditor._delete_constraint_sql.1.1",
      "distance": 1.1278489828109741,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 1090,
      "end_line": 1120,
      "tokens": 240,
      "context_length": 5025
    },
    {
      "position": 20,
      "id": "/tmp/repos/django/django/db/migrations/operations/models.py_RemoveIndex_RemoveIndex.describe.1.1",
      "distance": 1.144277811050415,
      "file_path": "django/db/migrations/operations/models.py",
      "start_line": 770,
      "end_line": 809,
      "tokens": 360,
      "context_length": 5385
    },
    {
      "position": 21,
      "id": "/tmp/repos/django/django/db/models/sql/subqueries.py_1_DeleteQuery.delete_batch.6.1",
      "distance": 1.1448957920074463,
      "file_path": "django/db/models/sql/subqueries.py",
      "start_line": 1,
      "end_line": 42,
      "tokens": 318,
      "context_length": 5703
    },
    {
      "position": 22,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._perform_unique_checks_Model._perform_unique_checks.3.1",
      "distance": 1.1450893878936768,
      "file_path": "django/db/models/base.py",
      "start_line": 1048,
      "end_line": 1091,
      "tokens": 404,
      "context_length": 6107
    },
    {
      "position": 23,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._do_update_Model._do_update.5.1",
      "distance": 1.1507009267807007,
      "file_path": "django/db/models/base.py",
      "start_line": 875,
      "end_line": 900,
      "tokens": 314,
      "context_length": 6421
    },
    {
      "position": 24,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._do_insert_Model._get_FIELD_display.3.1",
      "distance": 1.1553231477737427,
      "file_path": "django/db/models/base.py",
      "start_line": 902,
      "end_line": 926,
      "tokens": 238,
      "context_length": 6659
    },
    {
      "position": 25,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_ModelAdmin.log_deletion_ModelAdmin.log_deletion.3.1",
      "distance": 1.1687047481536865,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 825,
      "end_line": 839,
      "tokens": 124,
      "context_length": 6783
    },
    {
      "position": 26,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.can_fast_delete_Collector.get_del_batches.3.2.1.1",
      "distance": 1.1729841232299805,
      "file_path": "django/db/models/deletion.py",
      "start_line": 119,
      "end_line": 167,
      "tokens": 450,
      "context_length": 7233,
      "file_pos": 14
    },
    {
      "position": 27,
      "id": "/tmp/repos/django/django/db/models/query.py_InstanceCheckMeta_RawQuerySet.__init__.self._prefetch_done.1",
      "distance": 1.1740384101867676,
      "file_path": "django/db/models/query.py",
      "start_line": 1304,
      "end_line": 1335,
      "tokens": 246,
      "context_length": 7479
    },
    {
      "position": 28,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_InlineModelAdmin.get_formset.DeleteProtectedModelForm_InlineModelAdmin.get_formset.18.1",
      "distance": 1.1804258823394775,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 2051,
      "end_line": 2103,
      "tokens": 451,
      "context_length": 7930
    },
    {
      "position": 29,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.save_Model.save.10",
      "distance": 1.1804835796356201,
      "file_path": "django/db/models/base.py",
      "start_line": 663,
      "end_line": 741,
      "tokens": 785,
      "context_length": 8715
    },
    {
      "position": 30,
      "id": "/tmp/repos/django/django/core/cache/backends/db.py_DatabaseCache.pickle_protocol.delete_DatabaseCache.pickle_protocol._base_delete_many.6.1",
      "distance": 1.1895112991333008,
      "file_path": "django/core/cache/backends/db.py",
      "start_line": 199,
      "end_line": 226,
      "tokens": 265,
      "context_length": 8980
    },
    {
      "position": 31,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.collect_Collector.collect.7.3.1.sub_objs.2",
      "distance": 1.1903289556503296,
      "file_path": "django/db/models/deletion.py",
      "start_line": 169,
      "end_line": 229,
      "tokens": 595,
      "context_length": 9575,
      "file_pos": 15
    },
    {
      "position": 32,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor.alter_unique_together_BaseDatabaseSchemaEditor.alter_unique_together.7.2",
      "distance": 1.1932413578033447,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 354,
      "end_line": 368,
      "tokens": 182,
      "context_length": 9757
    },
    {
      "position": 33,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.prepare_database_save_Model.validate_unique.6.1",
      "distance": 1.1950854063034058,
      "file_path": "django/db/models/base.py",
      "start_line": 959,
      "end_line": 987,
      "tokens": 230,
      "context_length": 9987
    },
    {
      "position": 34,
      "id": "/tmp/repos/django/django/contrib/gis/db/backends/spatialite/schema.py_SpatialiteSchemaEditor.remove_geometry_metadata_SpatialiteSchemaEditor.create_model.self.geometry_sql.1",
      "distance": 1.1952964067459106,
      "file_path": "django/contrib/gis/db/backends/spatialite/schema.py",
      "start_line": 63,
      "end_line": 82,
      "tokens": 133,
      "context_length": 10120
    },
    {
      "position": 35,
      "id": "/tmp/repos/django/django/db/models/base.py_Model_Model.__init__.cls.19",
      "distance": 1.1968858242034912,
      "file_path": "django/db/models/base.py",
      "start_line": 399,
      "end_line": 503,
      "tokens": 903,
      "context_length": 11023
    },
    {
      "position": 36,
      "id": "/tmp/repos/django/django/db/migrations/autodetector.py_MigrationAutodetector.generate_deleted_proxies_MigrationAutodetector.generate_renamed_fields.3.6.1.6.1.5",
      "distance": 1.1991298198699951,
      "file_path": "django/db/migrations/autodetector.py",
      "start_line": 796,
      "end_line": 845,
      "tokens": 570,
      "context_length": 11593
    },
    {
      "position": 37,
      "id": "/tmp/repos/django/django/db/models/base.py_32_",
      "distance": 1.2003121376037598,
      "file_path": "django/db/models/base.py",
      "start_line": 1807,
      "end_line": 1858,
      "tokens": 351,
      "context_length": 11944
    },
    {
      "position": 38,
      "id": "/tmp/repos/django/django/contrib/contenttypes/models.py_ContentTypeManager.clear_cache_ContentTypeManager._add_to_cache.6",
      "distance": 1.208920955657959,
      "file_path": "django/contrib/contenttypes/models.py",
      "start_line": 118,
      "end_line": 130,
      "tokens": 133,
      "context_length": 12077
    },
    {
      "position": 39,
      "id": "/tmp/repos/django/django/db/migrations/operations/fields.py_RemoveField_RemoveField.state_forwards.7",
      "distance": 1.2107566595077515,
      "file_path": "django/db/migrations/operations/fields.py",
      "start_line": 148,
      "end_line": 173,
      "tokens": 183,
      "context_length": 12260
    },
    {
      "position": 40,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.clear_limits_Query.add_distinct_fields.self.distinct.1",
      "distance": 1.211066722869873,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1739,
      "end_line": 1780,
      "tokens": 283,
      "context_length": 12543
    },
    {
      "position": 41,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_BaseModelAdmin.has_delete_permission_BaseModelAdmin.has_delete_permission.4.1",
      "distance": 1.2121679782867432,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 487,
      "end_line": 500,
      "tokens": 165,
      "context_length": 12708
    },
    {
      "position": 42,
      "id": "/tmp/repos/django/django/db/migrations/operations/models.py_RemoveConstraint_",
      "distance": 1.2142791748046875,
      "file_path": "django/db/migrations/operations/models.py",
      "start_line": 844,
      "end_line": 879,
      "tokens": 347,
      "context_length": 13055
    },
    {
      "position": 43,
      "id": "/tmp/repos/django/django/db/backends/sqlite3/schema.py_DatabaseSchemaEditor.delete_model_DatabaseSchemaEditor.add_field.4",
      "distance": 1.2150661945343018,
      "file_path": "django/db/backends/sqlite3/schema.py",
      "start_line": 306,
      "end_line": 327,
      "tokens": 218,
      "context_length": 13273
    },
    {
      "position": 44,
      "id": "/tmp/repos/django/django/core/cache/backends/db.py_DatabaseCache.pickle_protocol._cull_",
      "distance": 1.218191146850586,
      "file_path": "django/core/cache/backends/db.py",
      "start_line": 253,
      "end_line": 278,
      "tokens": 308,
      "context_length": 13581
    },
    {
      "position": 45,
      "id": "/tmp/repos/django/django/db/models/base.py_ModelStateFieldsCacheDescriptor_ModelState.fields_cache.1",
      "distance": 1.2184562683105469,
      "file_path": "django/db/models/base.py",
      "start_line": 380,
      "end_line": 396,
      "tokens": 128,
      "context_length": 13709
    },
    {
      "position": 46,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.full_clean_Model.full_clean.10.1",
      "distance": 1.2190009355545044,
      "file_path": "django/db/models/base.py",
      "start_line": 1169,
      "end_line": 1203,
      "tokens": 230,
      "context_length": 13939
    },
    {
      "position": 47,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_ModelAdmin.get_deleted_objects_ModelAdmin._delete_view.16.1",
      "distance": 1.2212767601013184,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 1805,
      "end_line": 1873,
      "tokens": 584,
      "context_length": 14523
    },
    {
      "position": 48,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_model_name_db_lookup_clashes_Model._check_model_name_db_lookup_clashes.4.1",
      "distance": 1.222409963607788,
      "file_path": "django/db/models/base.py",
      "start_line": 1450,
      "end_line": 1472,
      "tokens": 171,
      "context_length": 14694
    },
    {
      "position": 49,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ForeignKey._check_unique_ForeignKey.deconstruct.10.1",
      "distance": 1.2268933057785034,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 845,
      "end_line": 871,
      "tokens": 240,
      "context_length": 14934
    },
    {
      "position": 50,
      "id": "/tmp/repos/django/django/forms/models.py_BaseModelFormSet.save_existing_objects_BaseModelFormSet.save_new_objects.3.1",
      "distance": 1.2290643453598022,
      "file_path": "django/forms/models.py",
      "start_line": 770,
      "end_line": 808,
      "tokens": 314,
      "context_length": 15248
    },
    {
      "position": 51,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._alter_field_BaseDatabaseSchemaEditor._alter_field.20",
      "distance": 1.2312626838684082,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 551,
      "end_line": 609,
      "tokens": 676,
      "context_length": 15924
    },
    {
      "position": 52,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._perform_date_checks_Model._perform_date_checks.3.1",
      "distance": 1.2313095331192017,
      "file_path": "django/db/models/base.py",
      "start_line": 1093,
      "end_line": 1120,
      "tokens": 286,
      "context_length": 16210
    },
    {
      "position": 53,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._fk_constraint_name_BaseDatabaseSchemaEditor._delete_fk_sql.1.1",
      "distance": 1.2335329055786133,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 1032,
      "end_line": 1046,
      "tokens": 123,
      "context_length": 16333
    },
    {
      "position": 54,
      "id": "/tmp/repos/django/django/db/backends/sqlite3/schema.py_DatabaseSchemaEditor._remake_table.28_DatabaseSchemaEditor._remake_table.67.restore_pk_field.primary_key.1",
      "distance": 1.235032558441162,
      "file_path": "django/db/backends/sqlite3/schema.py",
      "start_line": 222,
      "end_line": 304,
      "tokens": 729,
      "context_length": 17062
    },
    {
      "position": 55,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._get_pk_val_Model.get_deferred_fields.2.1",
      "distance": 1.2382850646972656,
      "file_path": "django/db/models/base.py",
      "start_line": 567,
      "end_line": 583,
      "tokens": 133,
      "context_length": 17195
    },
    {
      "position": 56,
      "id": "/tmp/repos/django/django/forms/models.py_BaseModelForm._post_clean_BaseModelForm._post_clean.14.1",
      "distance": 1.2401906251907349,
      "file_path": "django/forms/models.py",
      "start_line": 379,
      "end_line": 407,
      "tokens": 240,
      "context_length": 17435
    },
    {
      "position": 57,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ManyToManyField._check_relationship_model_ManyToManyField._check_relationship_model.3.3.11.3.seen_from.5.1",
      "distance": 1.2418384552001953,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 1193,
      "end_line": 1316,
      "tokens": 1010,
      "context_length": 18445
    },
    {
      "position": 58,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.__setstate___Model.__setstate__.5",
      "distance": 1.2418816089630127,
      "file_path": "django/db/models/base.py",
      "start_line": 549,
      "end_line": 565,
      "tokens": 142,
      "context_length": 18587
    },
    {
      "position": 59,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_ModelAdmin.render_delete_form_ModelAdmin.render_delete_form.5.1",
      "distance": 1.2452439069747925,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 1442,
      "end_line": 1461,
      "tokens": 133,
      "context_length": 18720
    },
    {
      "position": 60,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.check_Model.check.3.1",
      "distance": 1.2457106113433838,
      "file_path": "django/db/models/base.py",
      "start_line": 1230,
      "end_line": 1259,
      "tokens": 242,
      "context_length": 18962
    },
    {
      "position": 61,
      "id": "/tmp/repos/django/django/db/backends/mysql/schema.py_DatabaseSchemaEditor._set_field_new_type_null_status_",
      "distance": 1.2474148273468018,
      "file_path": "django/db/backends/mysql/schema.py",
      "start_line": 89,
      "end_line": 107,
      "tokens": 192,
      "context_length": 19154
    },
    {
      "position": 62,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLDeleteCompiler_SQLDeleteCompiler.as_sql.7.1",
      "distance": 1.2474454641342163,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 1329,
      "end_line": 1342,
      "tokens": 141,
      "context_length": 19295
    },
    {
      "position": 63,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_local_fields_Model._check_local_fields.7.1",
      "distance": 1.2477984428405762,
      "file_path": "django/db/models/base.py",
      "start_line": 1568,
      "end_line": 1614,
      "tokens": 324,
      "context_length": 19619
    },
    {
      "position": 64,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_constraints_Model._check_constraints.3.1",
      "distance": 1.2484629154205322,
      "file_path": "django/db/models/base.py",
      "start_line": 1783,
      "end_line": 1804,
      "tokens": 155,
      "context_length": 19774
    },
    {
      "position": 65,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.clear_deferred_loading_Query.add_deferred_loading.7.3.self.deferred_loading.1",
      "distance": 1.252123236656189,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1930,
      "end_line": 1952,
      "tokens": 249,
      "context_length": 20023
    },
    {
      "position": 66,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.add_Collector.add_field_update.4",
      "distance": 1.2531386613845825,
      "file_path": "django/db/models/deletion.py",
      "start_line": 80,
      "end_line": 117,
      "tokens": 327,
      "context_length": 20350,
      "file_pos": 20
    },
    {
      "position": 67,
      "id": "/tmp/repos/django/django/contrib/admin/options.py_ModelAdmin._create_formsets_ModelAdmin._create_formsets.8.1",
      "distance": 1.2564237117767334,
      "file_path": "django/contrib/admin/options.py",
      "start_line": 1914,
      "end_line": 1957,
      "tokens": 403,
      "context_length": 20753
    },
    {
      "position": 68,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_id_field_Model._check_id_field.4.2.1.1",
      "distance": 1.2584075927734375,
      "file_path": "django/db/models/base.py",
      "start_line": 1351,
      "end_line": 1366,
      "tokens": 153,
      "context_length": 20906
    },
    {
      "position": 69,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.none_QuerySet._filter_or_exclude.4.1",
      "distance": 1.2597076892852783,
      "file_path": "django/db/models/query.py",
      "start_line": 859,
      "end_line": 900,
      "tokens": 287,
      "context_length": 21193
    },
    {
      "position": 70,
      "id": "/tmp/repos/django/django/db/models/manager.py_Manager_",
      "distance": 1.263852834701538,
      "file_path": "django/db/models/manager.py",
      "start_line": 165,
      "end_line": 202,
      "tokens": 211,
      "context_length": 21404
    },
    {
      "position": 71,
      "id": "/tmp/repos/django/django/contrib/sessions/backends/base.py_SessionBase.flush_",
      "distance": 1.2640125751495361,
      "file_path": "django/contrib/sessions/backends/base.py",
      "start_line": 292,
      "end_line": 359,
      "tokens": 459,
      "context_length": 21863
    },
    {
      "position": 72,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_m2m_through_same_relationship_Model._check_m2m_through_same_relationship.10.1",
      "distance": 1.2663557529449463,
      "file_path": "django/db/models/base.py",
      "start_line": 1319,
      "end_line": 1349,
      "tokens": 244,
      "context_length": 22107
    },
    {
      "position": 73,
      "id": "/tmp/repos/django/django/db/backends/sqlite3/schema.py_DatabaseSchemaEditor._remake_table_DatabaseSchemaEditor._remake_table.unique_together.1",
      "distance": 1.2675236463546753,
      "file_path": "django/db/backends/sqlite3/schema.py",
      "start_line": 139,
      "end_line": 220,
      "tokens": 820,
      "context_length": 22927
    },
    {
      "position": 74,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.save_base.alters_data_Model._save_parents.5.1",
      "distance": 1.274488925933838,
      "file_path": "django/db/models/base.py",
      "start_line": 793,
      "end_line": 821,
      "tokens": 307,
      "context_length": 23234
    },
    {
      "position": 75,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._save_table_Model._save_table.13.1",
      "distance": 1.276160717010498,
      "file_path": "django/db/models/base.py",
      "start_line": 823,
      "end_line": 873,
      "tokens": 539,
      "context_length": 23773
    },
    {
      "position": 76,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_property_name_related_field_accessor_clashes_Model._check_single_primary_key.3.1",
      "distance": 1.278374195098877,
      "file_path": "django/db/models/base.py",
      "start_line": 1474,
      "end_line": 1506,
      "tokens": 231,
      "context_length": 24004
    },
    {
      "position": 77,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ForeignObject._check_unique_target_ForeignObject._check_unique_target.9.5.1.1",
      "distance": 1.2790069580078125,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 509,
      "end_line": 563,
      "tokens": 409,
      "context_length": 24413
    },
    {
      "position": 78,
      "id": "/tmp/repos/django/django/views/generic/edit.py_DeletionMixin_",
      "distance": 1.2804858684539795,
      "file_path": "django/views/generic/edit.py",
      "start_line": 202,
      "end_line": 242,
      "tokens": 263,
      "context_length": 24676
    },
    {
      "position": 79,
      "id": "/tmp/repos/django/django/db/models/sql/__init__.py__",
      "distance": 1.280570387840271,
      "file_path": "django/db/models/sql/__init__.py",
      "start_line": 1,
      "end_line": 8,
      "tokens": 0,
      "context_length": 24676
    },
    {
      "position": 80,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.refresh_from_db_Model.refresh_from_db.self._state.db.1",
      "distance": 1.2814457416534424,
      "file_path": "django/db/models/base.py",
      "start_line": 585,
      "end_line": 644,
      "tokens": 527,
      "context_length": 25203
    },
    {
      "position": 81,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.unique_error_message_Model.unique_error_message.4.5.3.1",
      "distance": 1.2817001342773438,
      "file_path": "django/db/models/base.py",
      "start_line": 1139,
      "end_line": 1167,
      "tokens": 213,
      "context_length": 25416
    },
    {
      "position": 82,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_RelatedField._check_relation_model_exists_RelatedField._check_relation_model_exists.5.1",
      "distance": 1.283914566040039,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 156,
      "end_line": 169,
      "tokens": 144,
      "context_length": 25560
    },
    {
      "position": 83,
      "id": "/tmp/repos/django/django/db/models/sql/where.py_NothingNode_ExtraWhere.contains_aggregate.as_sql.2.1",
      "distance": 1.284665822982788,
      "file_path": "django/db/models/sql/where.py",
      "start_line": 207,
      "end_line": 225,
      "tokens": 131,
      "context_length": 25691
    },
    {
      "position": 84,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.is_nullable_Query.is_nullable.7.1",
      "distance": 1.2850532531738281,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 2163,
      "end_line": 2179,
      "tokens": 177,
      "context_length": 25868
    },
    {
      "position": 85,
      "id": "/tmp/repos/django/django/forms/models.py_BaseModelFormSet.save_new_BaseModelFormSet.clean.1",
      "distance": 1.2851459980010986,
      "file_path": "django/forms/models.py",
      "start_line": 642,
      "end_line": 672,
      "tokens": 217,
      "context_length": 26085
    },
    {
      "position": 86,
      "id": "/tmp/repos/django/django/db/migrations/operations/models.py_CreateModel.reduce_CreateModel.reduce.2.1",
      "distance": 1.2851788997650146,
      "file_path": "django/db/migrations/operations/models.py",
      "start_line": 120,
      "end_line": 239,
      "tokens": 827,
      "context_length": 26912
    },
    {
      "position": 87,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ManyToManyField._check_ignored_options_ManyToManyField._check_ignored_options.5.1",
      "distance": 1.2855197191238403,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 1160,
      "end_line": 1191,
      "tokens": 180,
      "context_length": 27092
    },
    {
      "position": 88,
      "id": "/tmp/repos/django/django/contrib/admin/checks.py_InlineModelAdminChecks._check_exclude_of_parent_model_InlineModelAdminChecks._check_exclude_of_parent_model.errors.7.2.1.1",
      "distance": 1.2865309715270996,
      "file_path": "django/contrib/admin/checks.py",
      "start_line": 1008,
      "end_line": 1035,
      "tokens": 204,
      "context_length": 27296
    },
    {
      "position": 89,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor._delete_index_sql_BaseDatabaseSchemaEditor._model_indexes_sql.7.1",
      "distance": 1.2887599468231201,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 958,
      "end_line": 985,
      "tokens": 245,
      "context_length": 27541
    },
    {
      "position": 90,
      "id": "/tmp/repos/django/django/contrib/contenttypes/management/commands/remove_stale_contenttypes.py_1_",
      "distance": 1.288905143737793,
      "file_path": "django/contrib/contenttypes/management/commands/remove_stale_contenttypes.py",
      "start_line": 1,
      "end_line": 81,
      "tokens": 598,
      "context_length": 28139
    },
    {
      "position": 91,
      "id": "/tmp/repos/django/django/db/backends/oracle/creation.py_DatabaseCreation._handle_objects_preventing_db_destruction_DatabaseCreation._handle_objects_preventing_db_destruction.3",
      "distance": 1.2890408039093018,
      "file_path": "django/db/backends/oracle/creation.py",
      "start_line": 130,
      "end_line": 165,
      "tokens": 399,
      "context_length": 28538
    },
    {
      "position": 92,
      "id": "/tmp/repos/django/django/core/checks/model_checks.py__check_lazy_references__check_lazy_references.model_signals.1",
      "distance": 1.289731502532959,
      "file_path": "django/core/checks/model_checks.py",
      "start_line": 45,
      "end_line": 66,
      "tokens": 168,
      "context_length": 28706
    },
    {
      "position": 93,
      "id": "/tmp/repos/django/django/contrib/gis/db/backends/mysql/schema.py_MySQLGISSchemaEditor.create_model_MySQLGISSchemaEditor.remove_field.2",
      "distance": 1.290032148361206,
      "file_path": "django/contrib/gis/db/backends/mysql/schema.py",
      "start_line": 40,
      "end_line": 63,
      "tokens": 190,
      "context_length": 28896
    },
    {
      "position": 94,
      "id": "/tmp/repos/django/django/db/migrations/autodetector.py_MigrationAutodetector.generate_renamed_models_MigrationAutodetector.generate_renamed_models.5.4.1.3.1.10",
      "distance": 1.290393590927124,
      "file_path": "django/db/migrations/autodetector.py",
      "start_line": 465,
      "end_line": 506,
      "tokens": 418,
      "context_length": 29314
    },
    {
      "position": 95,
      "id": "/tmp/repos/django/django/db/models/options.py_Options.setup_pk_Options.__str__.1.1",
      "distance": 1.291525959968567,
      "file_path": "django/db/models/options.py",
      "start_line": 278,
      "end_line": 296,
      "tokens": 136,
      "context_length": 29450
    },
    {
      "position": 96,
      "id": "/tmp/repos/django/django/db/models/fields/__init__.py_collections.abc_return_None.1.1",
      "distance": 1.292069673538208,
      "file_path": "django/db/models/fields/__init__.py",
      "start_line": 1,
      "end_line": 85,
      "tokens": 673,
      "context_length": 30123
    }
  ],
  "files": [
    {
      "file_path": "django/db/models/deletion.py",
      "position": 1,
      "tokens": 2761,
      "context_length": 2761
    },
    {
      "file_path": "django/db/backends/base/schema.py",
      "position": 2,
      "tokens": 11198,
      "context_length": 13959
    },
    {
      "file_path": "django/db/backends/oracle/schema.py",
      "position": 3,
      "tokens": 1745,
      "context_length": 15704
    },
    {
      "file_path": "django/contrib/gis/db/backends/spatialite/schema.py",
      "position": 4,
      "tokens": 1358,
      "context_length": 17062
    },
    {
      "file_path": "django/db/migrations/operations/models.py",
      "position": 5,
      "tokens": 6746,
      "context_length": 23808
    },
    {
      "file_path": "django/db/models/sql/subqueries.py",
      "position": 6,
      "tokens": 1519,
      "context_length": 25327
    },
    {
      "file_path": "django/db/migrations/autodetector.py",
      "position": 7,
      "tokens": 11671,
      "context_length": 36998
    },
    {
      "file_path": "django/db/models/query.py",
      "position": 8,
      "tokens": 16380,
      "context_length": 53378
    },
    {
      "file_path": "django/db/models/fields/related.py",
      "position": 9,
      "tokens": 13495,
      "context_length": 66873
    },
    {
      "file_path": "django/contrib/sites/models.py",
      "position": 10,
      "tokens": 789,
      "context_length": 67662
    },
    {
      "file_path": "django/db/backends/mysql/schema.py",
      "position": 11,
      "tokens": 1065,
      "context_length": 68727
    },
    {
      "file_path": "django/db/backends/sqlite3/schema.py",
      "position": 12,
      "tokens": 3954,
      "context_length": 72681
    },
    {
      "file_path": "django/db/models/base.py",
      "position": 13,
      "tokens": 14890,
      "context_length": 87571
    },
    {
      "file_path": "django/contrib/admin/options.py",
      "position": 14,
      "tokens": 18328,
      "context_length": 105899
    },
    {
      "file_path": "django/core/cache/backends/db.py",
      "position": 15,
      "tokens": 2086,
      "context_length": 107985
    },
    {
      "file_path": "django/contrib/contenttypes/models.py",
      "position": 16,
      "tokens": 1416,
      "context_length": 109401
    },
    {
      "file_path": "django/db/migrations/operations/fields.py",
      "position": 17,
      "tokens": 3267,
      "context_length": 112668
    },
    {
      "file_path": "django/db/models/sql/query.py",
      "position": 18,
      "tokens": 21049,
      "context_length": 133717
    },
    {
      "file_path": "django/forms/models.py",
      "position": 19,
      "tokens": 11449,
      "context_length": 145166
    },
    {
      "file_path": "django/db/models/sql/compiler.py",
      "position": 20,
      "tokens": 13444,
      "context_length": 158610
    },
    {
      "file_path": "django/db/models/manager.py",
      "position": 21,
      "tokens": 1434,
      "context_length": 160044
    },
    {
      "file_path": "django/contrib/sessions/backends/base.py",
      "position": 22,
      "tokens": 2525,
      "context_length": 162569
    },
    {
      "file_path": "django/views/generic/edit.py",
      "position": 23,
      "tokens": 1716,
      "context_length": 164285
    },
    {
      "file_path": "django/db/models/sql/__init__.py",
      "position": 24,
      "tokens": 72,
      "context_length": 164357
    },
    {
      "file_path": "django/db/models/sql/where.py",
      "position": 25,
      "tokens": 1775,
      "context_length": 166132
    },
    {
      "file_path": "django/contrib/admin/checks.py",
      "position": 26,
      "tokens": 8961,
      "context_length": 175093
    },
    {
      "file_path": "django/contrib/contenttypes/management/commands/remove_stale_contenttypes.py",
      "position": 27,
      "tokens": 618,
      "context_length": 175711
    },
    {
      "file_path": "django/db/backends/oracle/creation.py",
      "position": 28,
      "tokens": 3895,
      "context_length": 179606
    },
    {
      "file_path": "django/core/checks/model_checks.py",
      "position": 29,
      "tokens": 1402,
      "context_length": 181008
    },
    {
      "file_path": "django/contrib/gis/db/backends/mysql/schema.py",
      "position": 30,
      "tokens": 600,
      "context_length": 181608
    },
    {
      "file_path": "django/db/models/options.py",
      "position": 31,
      "tokens": 6866,
      "context_length": 188474
    },
    {
      "file_path": "django/db/models/fields/__init__.py",
      "position": 32,
      "tokens": 16929,
      "context_length": 205403
    }
  ]
}