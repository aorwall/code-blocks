{
  "instance_id": "django__django-14140",
  "model_patch": "diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py\nindex ae0f886107..9bbb3f87a1 100644\n--- a/django/db/models/query_utils.py\n+++ b/django/db/models/query_utils.py\n@@ -85,13 +85,16 @@ class Q(tree.Node):\n         if path.startswith('django.db.models.query_utils'):\n             path = path.replace('django.db.models.query_utils', 'django.db.models')\n         args, kwargs = (), {}\n-        if len(self.children) == 1 and not isinstance(self.children[0], Q):\n+        if len(self.children) == 1:\n             child = self.children[0]\n-            kwargs = {child[0]: child[1]}\n+            if isinstance(child, tuple) and len(child) == 2:\n+                kwargs = {child[0]: child[1]}\n+            else:\n+                args = (child,)\n         else:\n             args = tuple(self.children)\n-            if self.connector != self.default:\n-                kwargs = {'_connector': self.connector}\n+        if self.connector != self.default:\n+            kwargs = {'_connector': self.connector}\n         if self.negated:\n             kwargs['_negated'] = True\n         return path, args, kwargs\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "django/db/models/query_utils.py"
  ],
  "repo": "django/django",
  "base_commit": "45814af6197cfd8f4dc72ee43b90ecde305a1d5a",
  "patch": "diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py\n--- a/django/db/models/query_utils.py\n+++ b/django/db/models/query_utils.py\n@@ -84,14 +84,10 @@ def deconstruct(self):\n         path = '%s.%s' % (self.__class__.__module__, self.__class__.__name__)\n         if path.startswith('django.db.models.query_utils'):\n             path = path.replace('django.db.models.query_utils', 'django.db.models')\n-        args, kwargs = (), {}\n-        if len(self.children) == 1 and not isinstance(self.children[0], Q):\n-            child = self.children[0]\n-            kwargs = {child[0]: child[1]}\n-        else:\n-            args = tuple(self.children)\n-            if self.connector != self.default:\n-                kwargs = {'_connector': self.connector}\n+        args = tuple(self.children)\n+        kwargs = {}\n+        if self.connector != self.default:\n+            kwargs['_connector'] = self.connector\n         if self.negated:\n             kwargs['_negated'] = True\n         return path, args, kwargs\n",
  "test_patch": "diff --git a/tests/expressions/tests.py b/tests/expressions/tests.py\n--- a/tests/expressions/tests.py\n+++ b/tests/expressions/tests.py\n@@ -833,11 +833,21 @@ def test_boolean_expression_combined_with_empty_Q(self):\n             Q() & Exists(is_poc),\n             Exists(is_poc) | Q(),\n             Q() | Exists(is_poc),\n+            Q(Exists(is_poc)) & Q(),\n+            Q() & Q(Exists(is_poc)),\n+            Q(Exists(is_poc)) | Q(),\n+            Q() | Q(Exists(is_poc)),\n         ]\n         for conditions in tests:\n             with self.subTest(conditions):\n                 self.assertCountEqual(Employee.objects.filter(conditions), [self.max])\n \n+    def test_boolean_expression_in_Q(self):\n+        is_poc = Company.objects.filter(point_of_contact=OuterRef('pk'))\n+        self.gmbh.point_of_contact = self.max\n+        self.gmbh.save()\n+        self.assertCountEqual(Employee.objects.filter(Q(Exists(is_poc))), [self.max])\n+\n \n class IterableLookupInnerExpressionsTests(TestCase):\n     @classmethod\ndiff --git a/tests/queries/test_q.py b/tests/queries/test_q.py\n--- a/tests/queries/test_q.py\n+++ b/tests/queries/test_q.py\n@@ -1,6 +1,8 @@\n-from django.db.models import F, Q\n+from django.db.models import Exists, F, OuterRef, Q\n from django.test import SimpleTestCase\n \n+from .models import Tag\n+\n \n class QTests(SimpleTestCase):\n     def test_combine_and_empty(self):\n@@ -39,17 +41,14 @@ def test_deconstruct(self):\n         q = Q(price__gt=F('discounted_price'))\n         path, args, kwargs = q.deconstruct()\n         self.assertEqual(path, 'django.db.models.Q')\n-        self.assertEqual(args, ())\n-        self.assertEqual(kwargs, {'price__gt': F('discounted_price')})\n+        self.assertEqual(args, (('price__gt', F('discounted_price')),))\n+        self.assertEqual(kwargs, {})\n \n     def test_deconstruct_negated(self):\n         q = ~Q(price__gt=F('discounted_price'))\n         path, args, kwargs = q.deconstruct()\n-        self.assertEqual(args, ())\n-        self.assertEqual(kwargs, {\n-            'price__gt': F('discounted_price'),\n-            '_negated': True,\n-        })\n+        self.assertEqual(args, (('price__gt', F('discounted_price')),))\n+        self.assertEqual(kwargs, {'_negated': True})\n \n     def test_deconstruct_or(self):\n         q1 = Q(price__gt=F('discounted_price'))\n@@ -88,6 +87,13 @@ def test_deconstruct_nested(self):\n         self.assertEqual(args, (Q(price__gt=F('discounted_price')),))\n         self.assertEqual(kwargs, {})\n \n+    def test_deconstruct_boolean_expression(self):\n+        tagged = Tag.objects.filter(category=OuterRef('pk'))\n+        q = Q(Exists(tagged))\n+        _, args, kwargs = q.deconstruct()\n+        self.assertEqual(args, (Exists(tagged),))\n+        self.assertEqual(kwargs, {})\n+\n     def test_reconstruct(self):\n         q = Q(price__gt=F('discounted_price'))\n         path, args, kwargs = q.deconstruct()\ndiff --git a/tests/queryset_pickle/tests.py b/tests/queryset_pickle/tests.py\n--- a/tests/queryset_pickle/tests.py\n+++ b/tests/queryset_pickle/tests.py\n@@ -172,6 +172,17 @@ def test_pickle_prefetch_related_with_m2m_and_objects_deletion(self):\n         m2ms = pickle.loads(pickle.dumps(m2ms))\n         self.assertSequenceEqual(m2ms, [m2m])\n \n+    def test_pickle_boolean_expression_in_Q__queryset(self):\n+        group = Group.objects.create(name='group')\n+        Event.objects.create(title='event', group=group)\n+        groups = Group.objects.filter(\n+            models.Q(models.Exists(\n+                Event.objects.filter(group_id=models.OuterRef('id')),\n+            )),\n+        )\n+        groups2 = pickle.loads(pickle.dumps(groups))\n+        self.assertSequenceEqual(groups2, [group])\n+\n     def test_pickle_exists_queryset_still_usable(self):\n         group = Group.objects.create(name='group')\n         Event.objects.create(title='event', group=group)\n",
  "problem_statement": "Combining Q() objects with boolean expressions crashes.\nDescription\n\t \n\t\t(last modified by jonathan-golorry)\n\t \nCurrently Q objects with 1 child are treated differently during deconstruct.\n>>> from django.db.models import Q\n>>> Q(x=1).deconstruct()\n('django.db.models.Q', (), {'x': 1})\n>>> Q(x=1, y=2).deconstruct()\n('django.db.models.Q', (('x', 1), ('y', 2)), {})\nThis causes issues when deconstructing Q objects with a non-subscriptable child.\n>>> from django.contrib.auth import get_user_model\n>>> from django.db.models import Exists\n>>> Q(Exists(get_user_model().objects.filter(username='jim'))).deconstruct()\nTraceback (most recent call last):\n File \"<console>\", line 1, in <module>\n File \"...\", line 90, in deconstruct\n\tkwargs = {child[0]: child[1]}\nTypeError: 'Exists' object is not subscriptable\nPatch \u200bhttps://github.com/django/django/pull/14126 removes the special case, meaning single-child Q objects deconstruct into args instead of kwargs. A more backward-compatible approach would be to keep the special case and explicitly check that the child is a length-2 tuple, but it's unlikely that anyone is relying on this undocumented behavior.\n",
  "hints_text": "Conditional expressions can be combined together, so it's not necessary to encapsulate Exists() with Q(). Moreover it's an undocumented and untested to pass conditional expressions to Q(). Nevertheless I think it makes sense to support this. There is no need to change the current format of deconstruct(), it should be enough to handle conditional expressions, e.g. diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py index ae0f886107..5dc71ad619 100644 --- a/django/db/models/query_utils.py +++ b/django/db/models/query_utils.py @@ -85,7 +85,7 @@ class Q(tree.Node): if path.startswith('django.db.models.query_utils'): path = path.replace('django.db.models.query_utils', 'django.db.models') args, kwargs = (), {} - if len(self.children) == 1 and not isinstance(self.children[0], Q): + if len(self.children) == 1 and not isinstance(self.children[0], Q) and getattr(self.children[0], 'conditional', False) is False: child = self.children[0] kwargs = {child[0]: child[1]} else:\nAs Q() has .conditional set to True, we can amend Mariusz' example above to the following: django/db/models/query_utils.py diff --git a/django/db/models/query_utils.py b/django/db/models/query_utils.py index ae0f886107..5dc71ad619 100644 a b class Q(tree.Node): 8585 if path.startswith('django.db.models.query_utils'): 8686 path = path.replace('django.db.models.query_utils', 'django.db.models') 8787 args, kwargs = (), {} 88 if len(self.children) == 1 and not isinstance(self.children[0], Q): 88 if len(self.children) == 1 and getattr(self.children[0], 'conditional', False) is False: 8989 child = self.children[0] 9090 kwargs = {child[0]: child[1]} 9191 else:\nDjango already passes conditional expressions to Q objects internally. \u200bhttps://github.com/django/django/blob/main/django/db/models/expressions.py#L113 Tested here \u200bhttps://github.com/django/django/blob/main/tests/expressions/tests.py#L827 That test is only succeeding because Q(...) | Q(Q()) is treated differently from Q(...) | Q(). As for the form of .deconstruct(), is there any reason for keeping the special case? It's: Inconsistent: Q(x=1).deconstruct() vs Q(x=1, y=2).deconstruct() Fragile: Unsupported inputs like Q(False) sometimes (but not always!) lead to \"not subscriptable\" errors. Incorrect: Q((\"x\", 1)).deconstruct() incorrectly puts the condition in kwargs instead of args.\nDjango already passes conditional expressions to Q objects internally. \u200bhttps://github.com/django/django/blob/main/django/db/models/expressions.py#L113 Tested here \u200bhttps://github.com/django/django/blob/main/tests/expressions/tests.py#L827 These are example of combining conditional expressions. Again, initializing Q objects with conditional expressions is undocumented and untested. That test is only succeeding because Q(...) | Q(Q()) is treated differently from Q(...) | Q(). I'm not sure how it's related with the ticket \ud83e\udd14 As for the form of .deconstruct(), is there any reason for keeping the special case? It's: Inconsistent: Q(x=1).deconstruct() vs Q(x=1, y=2).deconstruct() First is a single condition without a connector. Fragile: Unsupported inputs like Q(False) sometimes (but not always!) lead to \"not subscriptable\" errors. Incorrect: Q((\"x\", 1)).deconstruct() incorrectly puts the condition in kwargs instead of args. I wouldn't say that is incorrect Q(('x', 1)) is equivalent to the Q(x=1) so I don't see anything wrong with this behavior.\nI suppose it's a semantics argument whether Q(Exists...) is untested if there's a test that runs that exact expression, but isn't solely checking that functionality. My point is that Q((\"x\", 1)) and Q(x=1) are equivalent, so it's impossible for the deconstruct to correctly recreate the original args and kwargs in all cases. Therefore, unless there's an argument for keeping the special case, it's better to consistently use args for both Q(x=1).deconstruct() and Q(x=1, y=2).deconstruct(). I point out Q(Exists...) | Q(Q()) to show that the fragility of the special case is problematic and hard to catch. An internal optimization for nested empty Q objects can cause conditional expression combination to fail. That's why I'd like this patch to be focused on removing the special case and making Q objects more robust for all inputs, rather than only adding support for expressions. Both would make my future work on Q objects possible, but the current patch would put django in a better position for future development. Edit: To clarify on my future work, I intend to add .empty() to detect nested empty Q objects -- such as Q(Q()) -- and remove them from logical operations. This would currently cause a regression in test_boolean_expression_combined_with_empty_Q. Ultimately the goal is to add robust implementations of Q.any() and Q.all() that can't return empty Q objects that accidentally leak the entire table \u200bhttps://forum.djangoproject.com/t/improving-q-objects-with-true-false-and-none/851/9 Edit 2: Patches are up. https://code.djangoproject.com/ticket/32549 and https://code.djangoproject.com/ticket/32554\nIan, can I ask for your opinion? We need another pair of eyes, I really don't see why the current format of deconstruct() is problematic \ud83e\udd37.\nI like the consistency and simplicity of the reworked deconstruct method. I think removing weird edge-cases in Q is a good thing. I think I would personally prefer a deconstruct api that always uses kwargs where possible, rather than args: ('django.db.models.Q', (), {'x': 1, 'y': 2}) looks nicer than ('django.db.models.Q', (('x', 1), ('y', 2)), {}) to me. I don't know how much harder this would be to implement though, and it's a machine facing interface, so human readability isn't the highest priority.\nUnfortunately we can't use kwargs for Q objects with multiple children. (Q(x=1) & Q(x=2)).deconstruct() would lose an argument.\nReplying to jonathan-golorry: Unfortunately we can't use kwargs for Q objects with multiple children. (Q(x=1) & Q(x=2)).deconstruct() would lose an argument. Excellent point!",
  "created_at": "2021-03-17T11:37:55Z",
  "version": "4.0",
  "FAIL_TO_PASS": "[\"test_boolean_expression_combined_with_empty_Q (expressions.tests.BasicExpressionsTests)\", \"test_deconstruct (queries.test_q.QTests)\", \"test_deconstruct_boolean_expression (queries.test_q.QTests)\", \"test_deconstruct_negated (queries.test_q.QTests)\"]",
  "PASS_TO_PASS": "[\"#21430 -- Verifies a warning is raised for querysets that are\", \"#24831 -- Cached properties on ManyToOneRel created in QuerySet.delete()\", \"A model not defined on module level is picklable.\", \"Complex expressions of different connection types are possible.\", \"Neither pickling nor unpickling a QuerySet.query with an __in=inner_qs\", \"Special characters (e.g. %, _ and \\\\) stored in database are\", \"Test intentionally the automatically created through model.\", \"This tests that SQL injection isn't possible using compilation of\", \"We can fill a value in all objects with an other value of the\", \"We can filter for objects, where a value is not equals the value\", \"We can increment a value of all objects in a query set.\", \"test_F_reuse (expressions.tests.ExpressionsTests)\", \"test_aggregate_rawsql_annotation (expressions.tests.BasicExpressionsTests)\", \"test_aggregate_subquery_annotation (expressions.tests.BasicExpressionsTests)\", \"test_aggregates (expressions.tests.ReprTests)\", \"test_and (expressions.tests.CombinableTests)\", \"test_annotate_values_aggregate (expressions.tests.BasicExpressionsTests)\", \"test_annotate_values_count (expressions.tests.BasicExpressionsTests)\", \"test_annotate_values_filter (expressions.tests.BasicExpressionsTests)\", \"test_annotation_values (queryset_pickle.tests.PickleabilityTestCase)\", \"test_annotation_values_list (queryset_pickle.tests.PickleabilityTestCase)\", \"test_annotation_with_callable_default (queryset_pickle.tests.PickleabilityTestCase)\", \"test_annotation_with_nested_outerref (expressions.tests.BasicExpressionsTests)\", \"test_annotation_with_outerref (expressions.tests.BasicExpressionsTests)\", \"test_annotations_within_subquery (expressions.tests.BasicExpressionsTests)\", \"test_arithmetic (expressions.tests.BasicExpressionsTests)\", \"test_boolean_expression_combined (expressions.tests.BasicExpressionsTests)\", \"test_boolean_expression_in_Q (expressions.tests.BasicExpressionsTests)\", \"test_case_in_filter_if_boolean_output_field (expressions.tests.BasicExpressionsTests)\", \"test_combine_and_both_empty (queries.test_q.QTests)\", \"test_combine_and_empty (queries.test_q.QTests)\", \"test_combine_not_q_object (queries.test_q.QTests)\", \"test_combine_or_both_empty (queries.test_q.QTests)\", \"test_combine_or_empty (queries.test_q.QTests)\", \"test_compile_unresolved (expressions.tests.ValueTests)\", \"test_date_case_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_date_comparison (expressions.tests.FTimeDeltaTests)\", \"test_date_minus_duration (expressions.tests.FTimeDeltaTests)\", \"test_date_subquery_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_date_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_datetime_callable_default_all (queryset_pickle.tests.PickleabilityTestCase)\", \"test_datetime_callable_default_filter (queryset_pickle.tests.PickleabilityTestCase)\", \"test_datetime_subquery_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_datetime_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_datetime_subtraction_microseconds (expressions.tests.FTimeDeltaTests)\", \"test_deconstruct (expressions.tests.FTests)\", \"test_deconstruct (expressions.tests.ValueTests)\", \"test_deconstruct_and (queries.test_q.QTests)\", \"test_deconstruct_multiple_kwargs (queries.test_q.QTests)\", \"test_deconstruct_nested (queries.test_q.QTests)\", \"test_deconstruct_or (queries.test_q.QTests)\", \"test_deconstruct_output_field (expressions.tests.ValueTests)\", \"test_deepcopy (expressions.tests.FTests)\", \"test_delta_add (expressions.tests.FTimeDeltaTests)\", \"test_delta_subtract (expressions.tests.FTimeDeltaTests)\", \"test_delta_update (expressions.tests.FTimeDeltaTests)\", \"test_distinct_aggregates (expressions.tests.ReprTests)\", \"test_doesnotexist_class (queryset_pickle.tests.PickleabilityTestCase)\", \"test_doesnotexist_exception (queryset_pickle.tests.PickleabilityTestCase)\", \"test_duration_expressions (expressions.tests.FTimeDeltaTests)\", \"test_duration_with_datetime (expressions.tests.FTimeDeltaTests)\", \"test_duration_with_datetime_microseconds (expressions.tests.FTimeDeltaTests)\", \"test_durationfield_add (expressions.tests.FTimeDeltaTests)\", \"test_empty_group_by (expressions.tests.ExpressionWrapperTests)\", \"test_equal (expressions.tests.FTests)\", \"test_equal (expressions.tests.SimpleExpressionTests)\", \"test_equal (expressions.tests.ValueTests)\", \"test_equal_output_field (expressions.tests.ValueTests)\", \"test_exclude (expressions.tests.FTimeDeltaTests)\", \"test_exist_single_field_output_field (expressions.tests.BasicExpressionsTests)\", \"test_exists_in_filter (expressions.tests.BasicExpressionsTests)\", \"test_explicit_output_field (expressions.tests.BasicExpressionsTests)\", \"test_expressions (expressions.tests.ReprTests)\", \"test_expressions_in_lookups_join_choice (expressions.tests.IterableLookupInnerExpressionsTests)\", \"test_filter_deferred (queryset_pickle.tests.PickleabilityTestCase)\", \"test_filter_inter_attribute (expressions.tests.BasicExpressionsTests)\", \"test_filter_reverse_fk (queryset_pickle.tests.PickleabilityTestCase)\", \"test_filter_with_join (expressions.tests.BasicExpressionsTests)\", \"test_filtered_aggregates (expressions.tests.ReprTests)\", \"test_filtering_on_annotate_that_uses_q (expressions.tests.BasicExpressionsTests)\", \"test_filtering_on_q_that_is_boolean (expressions.tests.BasicExpressionsTests)\", \"test_filtering_on_rawsql_that_is_boolean (expressions.tests.BasicExpressionsTests)\", \"test_forward_relatedobjectdoesnotexist_class (queryset_pickle.tests.PickleabilityTestCase)\", \"test_functions (expressions.tests.ReprTests)\", \"test_hash (expressions.tests.FTests)\", \"test_hash (expressions.tests.SimpleExpressionTests)\", \"test_hash (expressions.tests.ValueTests)\", \"test_in_lookup_allows_F_expressions_and_expressions_for_datetimes (expressions.tests.IterableLookupInnerExpressionsTests)\", \"test_in_lookup_allows_F_expressions_and_expressions_for_integers (expressions.tests.IterableLookupInnerExpressionsTests)\", \"test_in_lookup_query_evaluation (queryset_pickle.tests.InLookupTests)\", \"test_in_subquery (expressions.tests.BasicExpressionsTests)\", \"test_incorrect_field_in_F_expression (expressions.tests.BasicExpressionsTests)\", \"test_incorrect_joined_field_in_F_expression (expressions.tests.BasicExpressionsTests)\", \"test_invalid_operator (expressions.tests.FTimeDeltaTests)\", \"test_lefthand_addition (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_and (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_left_shift_operator (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_or (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_right_shift_operator (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_xor (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_bitwise_xor_null (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_division (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_modulo (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_multiplication (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_power (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_subtraction (expressions.tests.ExpressionOperatorTests)\", \"test_lefthand_transformed_field_bitwise_or (expressions.tests.ExpressionOperatorTests)\", \"test_manager_pickle (queryset_pickle.tests.PickleabilityTestCase)\", \"test_mixed_comparisons2 (expressions.tests.FTimeDeltaTests)\", \"test_model_pickle_dynamic (queryset_pickle.tests.PickleabilityTestCase)\", \"test_month_aggregation (expressions.tests.FieldTransformTests)\", \"test_multiple_query_compilation (expressions.tests.FTimeDeltaTests)\", \"test_multiple_transforms_in_values (expressions.tests.FieldTransformTests)\", \"test_multipleobjectsreturned_class (queryset_pickle.tests.PickleabilityTestCase)\", \"test_negation (expressions.tests.CombinableTests)\", \"test_negative_timedelta_update (expressions.tests.FTimeDeltaTests)\", \"test_nested_outerref_with_function (expressions.tests.BasicExpressionsTests)\", \"test_nested_subquery (expressions.tests.BasicExpressionsTests)\", \"test_nested_subquery_join_outer_ref (expressions.tests.BasicExpressionsTests)\", \"test_nested_subquery_outer_ref_2 (expressions.tests.BasicExpressionsTests)\", \"test_nested_subquery_outer_ref_with_autofield (expressions.tests.BasicExpressionsTests)\", \"test_new_object_create (expressions.tests.BasicExpressionsTests)\", \"test_new_object_save (expressions.tests.BasicExpressionsTests)\", \"test_non_empty_group_by (expressions.tests.ExpressionWrapperTests)\", \"test_not_equal_Value (expressions.tests.FTests)\", \"test_object_create_with_aggregate (expressions.tests.BasicExpressionsTests)\", \"test_object_update (expressions.tests.BasicExpressionsTests)\", \"test_object_update_fk (expressions.tests.BasicExpressionsTests)\", \"test_object_update_unsaved_objects (expressions.tests.BasicExpressionsTests)\", \"test_optimizations (expressions.tests.ExistsTests)\", \"test_or (expressions.tests.CombinableTests)\", \"test_order_by_exists (expressions.tests.BasicExpressionsTests)\", \"test_order_by_model_with_abstract_inheritance_and_meta_ordering (queryset_pickle.tests.PickleabilityTestCase)\", \"test_order_by_multiline_sql (expressions.tests.BasicExpressionsTests)\", \"test_order_of_operations (expressions.tests.BasicExpressionsTests)\", \"test_outerref (expressions.tests.BasicExpressionsTests)\", \"test_outerref_mixed_case_table_name (expressions.tests.BasicExpressionsTests)\", \"test_outerref_with_operator (expressions.tests.BasicExpressionsTests)\", \"test_parenthesis_priority (expressions.tests.BasicExpressionsTests)\", \"test_pickle_boolean_expression_in_Q__queryset (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_exists_kwargs_queryset_not_evaluated (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_exists_queryset_not_evaluated (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_exists_queryset_still_usable (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_expression (expressions.tests.BasicExpressionsTests)\", \"test_pickle_filteredrelation (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_filteredrelation_m2m (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_prefetch_queryset_not_evaluated (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_prefetch_queryset_still_usable (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_prefetch_queryset_usable_outside_of_prefetch (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_prefetch_related_idempotence (queryset_pickle.tests.PickleabilityTestCase)\", \"test_pickle_subquery_queryset_not_evaluated (queryset_pickle.tests.PickleabilityTestCase)\", \"test_query_clone (expressions.tests.FTimeDeltaTests)\", \"test_raise_empty_expressionlist (expressions.tests.ValueTests)\", \"test_range_lookup_allows_F_expressions_and_expressions_for_integers (expressions.tests.IterableLookupInnerExpressionsTests)\", \"test_range_lookup_namedtuple (expressions.tests.IterableLookupInnerExpressionsTests)\", \"test_reconstruct (queries.test_q.QTests)\", \"test_reconstruct_and (queries.test_q.QTests)\", \"test_reconstruct_negated (queries.test_q.QTests)\", \"test_reconstruct_or (queries.test_q.QTests)\", \"test_related_field (queryset_pickle.tests.PickleabilityTestCase)\", \"test_resolve_output_field (expressions.tests.CombinedExpressionTests)\", \"test_resolve_output_field (expressions.tests.ValueTests)\", \"test_resolve_output_field_failure (expressions.tests.ValueTests)\", \"test_reverse_one_to_one_relatedobjectdoesnotexist_class (queryset_pickle.tests.PickleabilityTestCase)\", \"test_reversed_and (expressions.tests.CombinableTests)\", \"test_reversed_or (expressions.tests.CombinableTests)\", \"test_right_hand_addition (expressions.tests.ExpressionOperatorTests)\", \"test_right_hand_division (expressions.tests.ExpressionOperatorTests)\", \"test_right_hand_modulo (expressions.tests.ExpressionOperatorTests)\", \"test_right_hand_multiplication (expressions.tests.ExpressionOperatorTests)\", \"test_right_hand_subtraction (expressions.tests.ExpressionOperatorTests)\", \"test_righthand_power (expressions.tests.ExpressionOperatorTests)\", \"test_specialized_queryset (queryset_pickle.tests.PickleabilityTestCase)\", \"test_standalone_method_as_default (queryset_pickle.tests.PickleabilityTestCase)\", \"test_staticmethod_as_default (queryset_pickle.tests.PickleabilityTestCase)\", \"test_string_as_default (queryset_pickle.tests.PickleabilityTestCase)\", \"test_subquery (expressions.tests.BasicExpressionsTests)\", \"test_subquery_eq (expressions.tests.BasicExpressionsTests)\", \"test_subquery_filter_by_aggregate (expressions.tests.BasicExpressionsTests)\", \"test_subquery_filter_by_lazy (expressions.tests.BasicExpressionsTests)\", \"test_subquery_group_by_outerref_in_filter (expressions.tests.BasicExpressionsTests)\", \"test_subquery_in_filter (expressions.tests.BasicExpressionsTests)\", \"test_subquery_references_joined_table_twice (expressions.tests.BasicExpressionsTests)\", \"test_ticket_11722_iexact_lookup (expressions.tests.BasicExpressionsTests)\", \"test_ticket_16731_startswith_lookup (expressions.tests.BasicExpressionsTests)\", \"test_ticket_18375_chained_filters (expressions.tests.BasicExpressionsTests)\", \"test_ticket_18375_join_reuse (expressions.tests.BasicExpressionsTests)\", \"test_ticket_18375_kwarg_ordering (expressions.tests.BasicExpressionsTests)\", \"test_ticket_18375_kwarg_ordering_2 (expressions.tests.BasicExpressionsTests)\", \"test_time_subquery_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_time_subtraction (expressions.tests.FTimeDeltaTests)\", \"test_transform_in_values (expressions.tests.FieldTransformTests)\", \"test_update (expressions.tests.BasicExpressionsTests)\", \"test_update_TimeField_using_Value (expressions.tests.ValueTests)\", \"test_update_UUIDField_using_Value (expressions.tests.ValueTests)\", \"test_update_inherited_field_value (expressions.tests.BasicExpressionsTests)\", \"test_update_with_fk (expressions.tests.BasicExpressionsTests)\", \"test_update_with_none (expressions.tests.BasicExpressionsTests)\", \"test_uuid_pk_subquery (expressions.tests.BasicExpressionsTests)\"]",
  "environment_setup_commit": "475cffd1d64c690cdad16ede4d5e81985738ceb4",
  "patch_files": [
    "django/db/models/query_utils.py"
  ],
  "test_patch_files": [
    "tests/expressions/tests.py",
    "tests/queries/test_q.py",
    "tests/queryset_pickle/tests.py"
  ],
  "patch_diff_details": {
    "django/db/models/query_utils.py": {
      "diffs": [
        {
          "start_line_old": 87,
          "end_line_old": 94,
          "file_pos": 1,
          "file_context_length": 2563,
          "closest_snippet_id": "/tmp/repos/django/django/db/models/query_utils.py_Q.__or___Q.resolve_expression.3",
          "closest_snippet_line_distance": 13,
          "pos": 2,
          "context_length": 338
        }
      ]
    }
  },
  "vectors": 3521,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_Q.__or___Q.resolve_expression.3",
      "distance": 0.8722240924835205,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 61,
      "end_line": 81,
      "tokens": 181,
      "context_length": 181,
      "file_pos": 1
    },
    {
      "position": 2,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_Q.deconstruct_Q.deconstruct.6.1",
      "distance": 0.8730592727661133,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 83,
      "end_line": 97,
      "tokens": 157,
      "context_length": 338,
      "file_pos": 1
    },
    {
      "position": 3,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query._add_q_Query._add_q.9.1",
      "distance": 0.9414867758750916,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1401,
      "end_line": 1421,
      "tokens": 247,
      "context_length": 585
    },
    {
      "position": 4,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_Q_Q._combine.8.1",
      "distance": 0.9601966142654419,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 28,
      "end_line": 59,
      "tokens": 259,
      "context_length": 844,
      "file_pos": 2
    },
    {
      "position": 5,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.add_filter_Query.build_where.1.1",
      "distance": 0.9945091009140015,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1378,
      "end_line": 1399,
      "tokens": 250,
      "context_length": 1094
    },
    {
      "position": 6,
      "id": "/tmp/repos/django/django/db/models/expressions.py_Combinable_Combinable.__ror__.1",
      "distance": 0.9997285604476929,
      "file_path": "django/db/models/expressions.py",
      "start_line": 33,
      "end_line": 147,
      "tokens": 836,
      "context_length": 1930
    },
    {
      "position": 7,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet._combinator_query_QuerySet.union.2.5.1",
      "distance": 1.0161995887756348,
      "file_path": "django/db/models/query.py",
      "start_line": 1006,
      "end_line": 1026,
      "tokens": 239,
      "context_length": 2169
    },
    {
      "position": 8,
      "id": "/tmp/repos/django/django/db/models/__init__.py_1_",
      "distance": 1.05950129032135,
      "file_path": "django/db/models/__init__.py",
      "start_line": 1,
      "end_line": 53,
      "tokens": 619,
      "context_length": 2788
    },
    {
      "position": 9,
      "id": "/tmp/repos/django/django/contrib/postgres/search.py_SearchQueryCombinable_SearchQueryCombinable.__rand__.1.1",
      "distance": 1.0626120567321777,
      "file_path": "django/contrib/postgres/search.py",
      "start_line": 130,
      "end_line": 157,
      "tokens": 248,
      "context_length": 3036
    },
    {
      "position": 10,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.combine.40_Query.combine.self.extra_order_by.1",
      "distance": 1.075352668762207,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 641,
      "end_line": 665,
      "tokens": 269,
      "context_length": 3305
    },
    {
      "position": 11,
      "id": "/tmp/repos/django/django/db/models/sql/subqueries.py_1_DeleteQuery.delete_batch.6.1",
      "distance": 1.078138828277588,
      "file_path": "django/db/models/sql/subqueries.py",
      "start_line": 1,
      "end_line": 44,
      "tokens": 320,
      "context_length": 3625
    },
    {
      "position": 12,
      "id": "/tmp/repos/django/django/db/models/deletion.py_operator_get_candidate_relations_to_delete.3.1",
      "distance": 1.0815904140472412,
      "file_path": "django/db/models/deletion.py",
      "start_line": 1,
      "end_line": 76,
      "tokens": 566,
      "context_length": 4191
    },
    {
      "position": 13,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.build_filter.19_Query.build_filter.31.1",
      "distance": 1.0817983150482178,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1311,
      "end_line": 1376,
      "tokens": 772,
      "context_length": 4963
    },
    {
      "position": 14,
      "id": "/tmp/repos/django/django/db/models/expressions.py_Exists_Exists.select_format.4.2.1",
      "distance": 1.084465503692627,
      "file_path": "django/db/models/expressions.py",
      "start_line": 1153,
      "end_line": 1185,
      "tokens": 254,
      "context_length": 5217
    },
    {
      "position": 15,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.__class_getitem___QuerySet.__or__.9.1",
      "distance": 1.0889252424240112,
      "file_path": "django/db/models/query.py",
      "start_line": 320,
      "end_line": 346,
      "tokens": 222,
      "context_length": 5439
    },
    {
      "position": 16,
      "id": "/tmp/repos/django/django/db/models/expressions.py_BaseExpression.identity_BaseExpression.__hash__.1.1",
      "distance": 1.094107985496521,
      "file_path": "django/db/models/expressions.py",
      "start_line": 392,
      "end_line": 417,
      "tokens": 186,
      "context_length": 5625
    },
    {
      "position": 17,
      "id": "/tmp/repos/django/django/db/models/expressions.py_TemporalSubtraction_F.__hash__.1.1",
      "distance": 1.0965285301208496,
      "file_path": "django/db/models/expressions.py",
      "start_line": 550,
      "end_line": 591,
      "tokens": 298,
      "context_length": 5923
    },
    {
      "position": 18,
      "id": "/tmp/repos/django/django/db/models/constraints.py_CheckConstraint_Deferrable.IMMEDIATE.1",
      "distance": 1.0978294610977173,
      "file_path": "django/db/models/constraints.py",
      "start_line": 38,
      "end_line": 86,
      "tokens": 378,
      "context_length": 6301
    },
    {
      "position": 19,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ForeignObject.deconstruct_ForeignObject.deconstruct.11.1",
      "distance": 1.0984903573989868,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 576,
      "end_line": 609,
      "tokens": 334,
      "context_length": 6635
    },
    {
      "position": 20,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_1_JoinInfo.1",
      "distance": 1.1158690452575684,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1,
      "end_line": 63,
      "tokens": 460,
      "context_length": 7095
    },
    {
      "position": 21,
      "id": "/tmp/repos/django/django/db/migrations/serializer.py_DeconstructableSerializer_DeconstructableSerializer.serialize.1.1",
      "distance": 1.1180052757263184,
      "file_path": "django/db/migrations/serializer.py",
      "start_line": 78,
      "end_line": 105,
      "tokens": 233,
      "context_length": 7328
    },
    {
      "position": 22,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.check_related_objects_Query.check_filterable.3.1.1",
      "distance": 1.1182003021240234,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1132,
      "end_line": 1164,
      "tokens": 338,
      "context_length": 7666
    },
    {
      "position": 23,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.names_to_path.3_Query.names_to_path.4.1",
      "distance": 1.120548963546753,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1490,
      "end_line": 1575,
      "tokens": 801,
      "context_length": 8467
    },
    {
      "position": 24,
      "id": "/tmp/repos/django/django/db/models/expressions.py_When_When.get_group_by_cols.cols.3.1",
      "distance": 1.1239168643951416,
      "file_path": "django/db/models/expressions.py",
      "start_line": 940,
      "end_line": 1004,
      "tokens": 591,
      "context_length": 9058
    },
    {
      "position": 25,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLCompiler.ordering_parts.get_combinator_sql_SQLCompiler.ordering_parts.get_combinator_sql.14.1",
      "distance": 1.1267585754394531,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 443,
      "end_line": 496,
      "tokens": 564,
      "context_length": 9622
    },
    {
      "position": 26,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.deferred_to_data.8_Query.deferred_to_data.8.6.6.1",
      "distance": 1.1292122602462769,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 716,
      "end_line": 751,
      "tokens": 389,
      "context_length": 10011
    },
    {
      "position": 27,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet._merge_known_related_objects_QuerySet._not_support_combined_queries.1.1",
      "distance": 1.1297476291656494,
      "file_path": "django/db/models/query.py",
      "start_line": 1372,
      "end_line": 1420,
      "tokens": 405,
      "context_length": 10416
    },
    {
      "position": 28,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet._annotate_QuerySet._annotate.10.1",
      "distance": 1.131490707397461,
      "file_path": "django/db/models/query.py",
      "start_line": 1119,
      "end_line": 1160,
      "tokens": 323,
      "context_length": 10739
    },
    {
      "position": 29,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLCompiler.ordering_parts.collapse_group_by_SQLCompiler.ordering_parts.collapse_group_by.5.4.1",
      "distance": 1.1315006017684937,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 150,
      "end_line": 198,
      "tokens": 523,
      "context_length": 11262
    },
    {
      "position": 30,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.combine_Query.combine.39",
      "distance": 1.1362313032150269,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 566,
      "end_line": 640,
      "tokens": 809,
      "context_length": 12071
    },
    {
      "position": 31,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.add_filtered_relation_Query.add_filtered_relation.6",
      "distance": 1.136712670326233,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1445,
      "end_line": 1472,
      "tokens": 283,
      "context_length": 12354
    },
    {
      "position": 32,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.clear_limits_Query.add_distinct_fields.self.distinct.1",
      "distance": 1.1376283168792725,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1868,
      "end_line": 1917,
      "tokens": 329,
      "context_length": 12683
    },
    {
      "position": 33,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLCompiler.ordering_parts.as_subquery_condition_SQLCompiler.ordering_parts.explain_query.4.1.2.1",
      "distance": 1.137707233428955,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 1209,
      "end_line": 1230,
      "tokens": 223,
      "context_length": 12906
    },
    {
      "position": 34,
      "id": "/tmp/repos/django/django/db/models/constraints.py_UniqueConstraint.__eq___",
      "distance": 1.1388823986053467,
      "file_path": "django/db/models/constraints.py",
      "start_line": 226,
      "end_line": 252,
      "tokens": 205,
      "context_length": 13111
    },
    {
      "position": 35,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ManyToManyField.deconstruct_ManyToManyField.deconstruct.12.1",
      "distance": 1.1410133838653564,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 1471,
      "end_line": 1505,
      "tokens": 356,
      "context_length": 13467
    },
    {
      "position": 36,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.split_exclude_Query.split_exclude.21.1",
      "distance": 1.141557216644287,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1770,
      "end_line": 1835,
      "tokens": 666,
      "context_length": 14133
    },
    {
      "position": 37,
      "id": "/tmp/repos/django/django/db/models/base.py_Model_Model.__init__.cls.20",
      "distance": 1.141632080078125,
      "file_path": "django/db/models/base.py",
      "start_line": 404,
      "end_line": 509,
      "tokens": 913,
      "context_length": 15046
    },
    {
      "position": 38,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.resolve_ref_Query.resolve_ref.2.3.12.1",
      "distance": 1.1418101787567139,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1726,
      "end_line": 1768,
      "tokens": 436,
      "context_length": 15482
    },
    {
      "position": 39,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.setup_joins.16_Query.setup_joins.17.1",
      "distance": 1.143887996673584,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1655,
      "end_line": 1679,
      "tokens": 227,
      "context_length": 15709
    },
    {
      "position": 40,
      "id": "/tmp/repos/django/django/db/migrations/questioner.py_NonInteractiveMigrationQuestioner_",
      "distance": 1.1443406343460083,
      "file_path": "django/db/migrations/questioner.py",
      "start_line": 226,
      "end_line": 239,
      "tokens": 123,
      "context_length": 15832
    },
    {
      "position": 41,
      "id": "/tmp/repos/django/django/contrib/postgres/constraints.py_ExclusionConstraint.deconstruct_ExclusionConstraint.__eq__.2.1",
      "distance": 1.152148723602295,
      "file_path": "django/contrib/postgres/constraints.py",
      "start_line": 129,
      "end_line": 155,
      "tokens": 231,
      "context_length": 16063
    },
    {
      "position": 42,
      "id": "/tmp/repos/django/django/db/models/constraints.py_1_BaseConstraint.clone.2.1",
      "distance": 1.1526339054107666,
      "file_path": "django/db/models/constraints.py",
      "start_line": 1,
      "end_line": 35,
      "tokens": 250,
      "context_length": 16313
    },
    {
      "position": 43,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_functools_RECURSIVE_RELATIONSHIP_CONSTANT.1",
      "distance": 1.1540685892105103,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 1,
      "end_line": 34,
      "tokens": 246,
      "context_length": 16559
    },
    {
      "position": 44,
      "id": "/tmp/repos/django/django/db/migrations/autodetector.py_MigrationAutodetector.deep_deconstruct_MigrationAutodetector.deep_deconstruct.2.8.1.1",
      "distance": 1.1556668281555176,
      "file_path": "django/db/migrations/autodetector.py",
      "start_line": 47,
      "end_line": 85,
      "tokens": 322,
      "context_length": 16881
    },
    {
      "position": 45,
      "id": "/tmp/repos/django/django/db/models/base.py_copy_DEFERRED.1",
      "distance": 1.1570320129394531,
      "file_path": "django/db/models/base.py",
      "start_line": 1,
      "end_line": 50,
      "tokens": 328,
      "context_length": 17209
    },
    {
      "position": 46,
      "id": "/tmp/repos/django/django/db/models/sql/where.py_SubqueryConstraint_",
      "distance": 1.1572120189666748,
      "file_path": "django/db/models/sql/where.py",
      "start_line": 233,
      "end_line": 249,
      "tokens": 130,
      "context_length": 17339
    },
    {
      "position": 47,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.intersection_QuerySet.difference.2.2.1",
      "distance": 1.1588866710662842,
      "file_path": "django/db/models/query.py",
      "start_line": 1028,
      "end_line": 1041,
      "tokens": 126,
      "context_length": 17465
    },
    {
      "position": 48,
      "id": "/tmp/repos/django/django/contrib/postgres/search.py_SearchQuery_SearchQuery.__str__.2.1",
      "distance": 1.1628698110580444,
      "file_path": "django/contrib/postgres/search.py",
      "start_line": 160,
      "end_line": 195,
      "tokens": 313,
      "context_length": 17778
    },
    {
      "position": 49,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet._prefetch_related_objects_QuerySet.values.4.1",
      "distance": 1.1631247997283936,
      "file_path": "django/db/models/query.py",
      "start_line": 832,
      "end_line": 863,
      "tokens": 272,
      "context_length": 18050
    },
    {
      "position": 50,
      "id": "/tmp/repos/django/django/db/models/expressions.py_CombinedExpression.resolve_expression_CombinedExpression.resolve_expression.8.1",
      "distance": 1.163675308227539,
      "file_path": "django/db/models/expressions.py",
      "start_line": 492,
      "end_line": 517,
      "tokens": 303,
      "context_length": 18353
    },
    {
      "position": 51,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_ordering_Model._check_ordering.29.1",
      "distance": 1.165217638015747,
      "file_path": "django/db/models/base.py",
      "start_line": 1771,
      "end_line": 1871,
      "tokens": 729,
      "context_length": 19082
    },
    {
      "position": 52,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.collect.11_Collector.collect.15.3.3.3.1",
      "distance": 1.1658434867858887,
      "file_path": "django/db/models/deletion.py",
      "start_line": 269,
      "end_line": 344,
      "tokens": 800,
      "context_length": 19882
    },
    {
      "position": 53,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.update_or_create_QuerySet.update_or_create.5.1",
      "distance": 1.1675419807434082,
      "file_path": "django/db/models/query.py",
      "start_line": 596,
      "end_line": 614,
      "tokens": 178,
      "context_length": 20060
    },
    {
      "position": 54,
      "id": "/tmp/repos/django/django/db/models/expressions.py_Expression__resolve_combined_type.2.1.1.1",
      "distance": 1.1714437007904053,
      "file_path": "django/db/models/expressions.py",
      "start_line": 420,
      "end_line": 442,
      "tokens": 204,
      "context_length": 20264
    },
    {
      "position": 55,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_collections_16",
      "distance": 1.1717673540115356,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 1,
      "end_line": 19,
      "tokens": 170,
      "context_length": 20434
    },
    {
      "position": 56,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector_Collector.__init__.17",
      "distance": 1.1718432903289795,
      "file_path": "django/db/models/deletion.py",
      "start_line": 79,
      "end_line": 97,
      "tokens": 199,
      "context_length": 20633
    },
    {
      "position": 57,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.bump_prefix.3_Query.bump_prefix.12",
      "distance": 1.1730239391326904,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 912,
      "end_line": 934,
      "tokens": 248,
      "context_length": 20881
    },
    {
      "position": 58,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.delete.alters_data_QuerySet.update.11.1",
      "distance": 1.173696517944336,
      "file_path": "django/db/models/query.py",
      "start_line": 752,
      "end_line": 785,
      "tokens": 274,
      "context_length": 21155
    },
    {
      "position": 59,
      "id": "/tmp/repos/django/django/db/backends/base/schema.py_BaseDatabaseSchemaEditor.alter_unique_together_BaseDatabaseSchemaEditor.alter_unique_together.7.2",
      "distance": 1.1742291450500488,
      "file_path": "django/db/backends/base/schema.py",
      "start_line": 391,
      "end_line": 405,
      "tokens": 182,
      "context_length": 21337
    },
    {
      "position": 60,
      "id": "/tmp/repos/django/django/contrib/postgres/constraints.py_1_ExclusionConstraint.__init__.17",
      "distance": 1.1745507717132568,
      "file_path": "django/contrib/postgres/constraints.py",
      "start_line": 1,
      "end_line": 67,
      "tokens": 550,
      "context_length": 21887
    },
    {
      "position": 61,
      "id": "/tmp/repos/django/django/db/models/fields/related.py_ForeignKey._check_unique_ForeignKey.deconstruct.10.1",
      "distance": 1.175457239151001,
      "file_path": "django/db/models/fields/related.py",
      "start_line": 864,
      "end_line": 890,
      "tokens": 240,
      "context_length": 22127
    },
    {
      "position": 62,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.__setstate___QuerySet.__len__.2.1",
      "distance": 1.175462007522583,
      "file_path": "django/db/models/query.py",
      "start_line": 236,
      "end_line": 263,
      "tokens": 221,
      "context_length": 22348
    },
    {
      "position": 63,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.join_parent_model_Query.join_parent_model.7.1",
      "distance": 1.175797939300537,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1004,
      "end_line": 1035,
      "tokens": 307,
      "context_length": 22655
    },
    {
      "position": 64,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_constraints_Model._check_constraints.3.1",
      "distance": 1.178083896636963,
      "file_path": "django/db/models/base.py",
      "start_line": 1964,
      "end_line": 2120,
      "tokens": 1158,
      "context_length": 23813
    },
    {
      "position": 65,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.can_fast_delete_Collector.can_fast_delete.8.1",
      "distance": 1.1788077354431152,
      "file_path": "django/db/models/deletion.py",
      "start_line": 165,
      "end_line": 199,
      "tokens": 325,
      "context_length": 24138
    },
    {
      "position": 66,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet._merge_sanity_check_QuerySet._merge_sanity_check.2.1",
      "distance": 1.1791462898254395,
      "file_path": "django/db/models/query.py",
      "start_line": 1361,
      "end_line": 1370,
      "tokens": 114,
      "context_length": 24252
    },
    {
      "position": 67,
      "id": "/tmp/repos/django/django/contrib/admin/utils.py_NestedObjects_NestedObjects.collect.2.3.1",
      "distance": 1.1810805797576904,
      "file_path": "django/contrib/admin/utils.py",
      "start_line": 160,
      "end_line": 186,
      "tokens": 239,
      "context_length": 24491
    },
    {
      "position": 68,
      "id": "/tmp/repos/django/django/contrib/postgres/search.py_CombinedSearchQuery_SearchRank.__init__.7",
      "distance": 1.1823912858963013,
      "file_path": "django/contrib/postgres/search.py",
      "start_line": 198,
      "end_line": 230,
      "tokens": 243,
      "context_length": 24734
    },
    {
      "position": 69,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._get_expr_references_Model._get_expr_references.1.3.1.1",
      "distance": 1.1838335990905762,
      "file_path": "django/db/models/base.py",
      "start_line": 1948,
      "end_line": 1962,
      "tokens": 136,
      "context_length": 24870
    },
    {
      "position": 70,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLCompiler_SQLCompiler.ordering_parts.setup_query.self.col_count.1",
      "distance": 1.1841709613800049,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 22,
      "end_line": 47,
      "tokens": 257,
      "context_length": 25127
    },
    {
      "position": 71,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.bulk_update.alters_data_QuerySet.get_or_create.5.2.3.2.2",
      "distance": 1.1852166652679443,
      "file_path": "django/db/models/query.py",
      "start_line": 569,
      "end_line": 594,
      "tokens": 202,
      "context_length": 25329
    },
    {
      "position": 72,
      "id": "/tmp/repos/django/django/db/models/aggregates.py_Aggregate.resolve_expression_Aggregate.get_group_by_cols.1.1",
      "distance": 1.1873366832733154,
      "file_path": "django/db/models/aggregates.py",
      "start_line": 45,
      "end_line": 68,
      "tokens": 294,
      "context_length": 25623
    },
    {
      "position": 73,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_1_subclasses.2.1",
      "distance": 1.1878024339675903,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 1,
      "end_line": 25,
      "tokens": 180,
      "context_length": 25803,
      "file_pos": 20
    },
    {
      "position": 74,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.solve_lookup_type_Query.check_query_object_type.2.1.1",
      "distance": 1.1880813837051392,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1103,
      "end_line": 1130,
      "tokens": 285,
      "context_length": 26088
    },
    {
      "position": 75,
      "id": "/tmp/repos/django/django/core/serializers/__init__.py_unregister_serializer_deserialize.3.1",
      "distance": 1.1904714107513428,
      "file_path": "django/core/serializers/__init__.py",
      "start_line": 86,
      "end_line": 141,
      "tokens": 369,
      "context_length": 26457
    },
    {
      "position": 76,
      "id": "/tmp/repos/django/django/db/models/sql/datastructures.py_1_Empty.1",
      "distance": 1.1907176971435547,
      "file_path": "django/db/models/sql/datastructures.py",
      "start_line": 1,
      "end_line": 21,
      "tokens": 126,
      "context_length": 26583
    },
    {
      "position": 77,
      "id": "/tmp/repos/django/django/db/models/expressions.py_CombinedExpression_CombinedExpression.as_sql.12.1",
      "distance": 1.191157341003418,
      "file_path": "django/db/models/expressions.py",
      "start_line": 445,
      "end_line": 490,
      "tokens": 314,
      "context_length": 26897
    },
    {
      "position": 78,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.delete_QuerySet.delete.20.1",
      "distance": 1.19197416305542,
      "file_path": "django/db/models/query.py",
      "start_line": 722,
      "end_line": 750,
      "tokens": 262,
      "context_length": 27159
    },
    {
      "position": 79,
      "id": "/tmp/repos/django/django/contrib/gis/db/models/__init__.py_1_",
      "distance": 1.1922035217285156,
      "file_path": "django/contrib/gis/db/models/__init__.py",
      "start_line": 1,
      "end_line": 19,
      "tokens": 204,
      "context_length": 27363
    },
    {
      "position": 80,
      "id": "/tmp/repos/django/django/db/models/constraints.py_UniqueConstraint_UniqueConstraint._get_index_expressions.4.1",
      "distance": 1.1928787231445312,
      "file_path": "django/db/models/constraints.py",
      "start_line": 89,
      "end_line": 181,
      "tokens": 685,
      "context_length": 28048
    },
    {
      "position": 81,
      "id": "/tmp/repos/django/django/db/models/expressions.py_BaseExpression.contains_aggregate_BaseExpression.resolve_expression.5.1",
      "distance": 1.1933941841125488,
      "file_path": "django/db/models/expressions.py",
      "start_line": 219,
      "end_line": 253,
      "tokens": 285,
      "context_length": 28333
    },
    {
      "position": 82,
      "id": "/tmp/repos/django/django/db/models/sql/where.py_WhereNode._resolve_node_WhereNode.resolve_expression.4.1",
      "distance": 1.19503915309906,
      "file_path": "django/db/models/sql/where.py",
      "start_line": 195,
      "end_line": 209,
      "tokens": 156,
      "context_length": 28489
    },
    {
      "position": 83,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.only_QuerySet.only.8.1",
      "distance": 1.1958250999450684,
      "file_path": "django/db/models/query.py",
      "start_line": 1217,
      "end_line": 1236,
      "tokens": 209,
      "context_length": 28698
    },
    {
      "position": 84,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_unique_together_Model._check_unique_together.2.3.3.1",
      "distance": 1.1961922645568848,
      "file_path": "django/db/models/base.py",
      "start_line": 1605,
      "end_line": 1630,
      "tokens": 183,
      "context_length": 28881
    },
    {
      "position": 85,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.delete_",
      "distance": 1.1975135803222656,
      "file_path": "django/db/models/deletion.py",
      "start_line": 379,
      "end_line": 448,
      "tokens": 580,
      "context_length": 29461
    },
    {
      "position": 86,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_RegisterLookupMixin_RegisterLookupMixin._unregister_lookup.3",
      "distance": 1.1986136436462402,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 140,
      "end_line": 204,
      "tokens": 492,
      "context_length": 29953,
      "file_pos": 23
    },
    {
      "position": 87,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.rewrite_cols_Query.rewrite_cols.orig_exprs.5.1",
      "distance": 1.199093222618103,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 376,
      "end_line": 426,
      "tokens": 494,
      "context_length": 30447
    },
    {
      "position": 88,
      "id": "/tmp/repos/django/django/db/models/base.py_Model.check_Model.check.3.1",
      "distance": 1.1993128061294556,
      "file_path": "django/db/models/base.py",
      "start_line": 1269,
      "end_line": 1300,
      "tokens": 267,
      "context_length": 30714
    },
    {
      "position": 89,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.related_objects_Collector.instances_with_model.1.1.1",
      "distance": 1.1997907161712646,
      "file_path": "django/db/models/deletion.py",
      "start_line": 346,
      "end_line": 359,
      "tokens": 116,
      "context_length": 30830
    },
    {
      "position": 90,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._perform_unique_checks_Model._perform_unique_checks.3.1",
      "distance": 1.2004735469818115,
      "file_path": "django/db/models/base.py",
      "start_line": 1087,
      "end_line": 1130,
      "tokens": 404,
      "context_length": 31234
    },
    {
      "position": 91,
      "id": "/tmp/repos/django/django/db/models/base.py_Model._check_index_together_Model._check_index_together.2.3.3.1",
      "distance": 1.2015807628631592,
      "file_path": "django/db/models/base.py",
      "start_line": 1578,
      "end_line": 1603,
      "tokens": 183,
      "context_length": 31417
    },
    {
      "position": 92,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLDeleteCompiler_SQLDeleteCompiler._as_sql.4.1",
      "distance": 1.2017362117767334,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 1424,
      "end_line": 1438,
      "tokens": 127,
      "context_length": 31544
    },
    {
      "position": 93,
      "id": "/tmp/repos/django/django/db/models/fields/__init__.py_Field.clone_Field.__eq__.2.2.1",
      "distance": 1.201845645904541,
      "file_path": "django/db/models/fields/__init__.py",
      "start_line": 507,
      "end_line": 522,
      "tokens": 130,
      "context_length": 31674
    },
    {
      "position": 94,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.none_QuerySet._filter_or_exclude_inplace.1.2.1",
      "distance": 1.202078104019165,
      "file_path": "django/db/models/query.py",
      "start_line": 939,
      "end_line": 987,
      "tokens": 371,
      "context_length": 32045
    },
    {
      "position": 95,
      "id": "/tmp/repos/django/django/forms/models.py_ModelChoiceField_ModelChoiceField.label_from_instance.2.1",
      "distance": 1.2020841836929321,
      "file_path": "django/forms/models.py",
      "start_line": 1186,
      "end_line": 1251,
      "tokens": 543,
      "context_length": 32588
    },
    {
      "position": 96,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.get_external_cols_Query.resolve_lookup_value.2.1",
      "distance": 1.2025930881500244,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 1072,
      "end_line": 1101,
      "tokens": 249,
      "context_length": 32837
    },
    {
      "position": 97,
      "id": "/tmp/repos/django/django/db/models/fields/__init__.py_Field.deconstruct_Field.deconstruct.path.1",
      "distance": 1.2028696537017822,
      "file_path": "django/db/models/fields/__init__.py",
      "start_line": 416,
      "end_line": 493,
      "tokens": 667,
      "context_length": 33504
    },
    {
      "position": 98,
      "id": "/tmp/repos/django/django/db/models/options.py_bisect_DEFAULT_NAMES.1",
      "distance": 1.2040681838989258,
      "file_path": "django/db/models/options.py",
      "start_line": 1,
      "end_line": 35,
      "tokens": 300,
      "context_length": 33804
    },
    {
      "position": 99,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query_Query.__init__.self.explain_options.1",
      "distance": 1.2066614627838135,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 140,
      "end_line": 234,
      "tokens": 833,
      "context_length": 34637
    },
    {
      "position": 100,
      "id": "/tmp/repos/django/django/db/backends/oracle/creation.py_DatabaseCreation._handle_objects_preventing_db_destruction_DatabaseCreation._handle_objects_preventing_db_destruction.3",
      "distance": 1.207648515701294,
      "file_path": "django/db/backends/oracle/creation.py",
      "start_line": 130,
      "end_line": 165,
      "tokens": 399,
      "context_length": 35036
    },
    {
      "position": 101,
      "id": "/tmp/repos/django/django/db/models/deletion.py_Collector.sort_Collector.sort.self.data.1",
      "distance": 1.208920955657959,
      "file_path": "django/db/models/deletion.py",
      "start_line": 361,
      "end_line": 377,
      "tokens": 130,
      "context_length": 35166
    },
    {
      "position": 102,
      "id": "/tmp/repos/django/django/db/models/indexes.py_Index.__repr___Index.__eq__.2.1",
      "distance": 1.2090483903884888,
      "file_path": "django/db/models/indexes.py",
      "start_line": 171,
      "end_line": 188,
      "tokens": 205,
      "context_length": 35371
    },
    {
      "position": 103,
      "id": "/tmp/repos/django/django/db/models/sql/where.py_WhereNode.relabeled_clone_WhereNode._resolve_leaf.2.1",
      "distance": 1.2093360424041748,
      "file_path": "django/db/models/sql/where.py",
      "start_line": 157,
      "end_line": 193,
      "tokens": 243,
      "context_length": 35614
    },
    {
      "position": 104,
      "id": "/tmp/repos/django/django/db/models/lookups.py_Lookup.rhs_is_direct_value_Lookup.__hash__.1.1",
      "distance": 1.2097501754760742,
      "file_path": "django/db/models/lookups.py",
      "start_line": 101,
      "end_line": 155,
      "tokens": 427,
      "context_length": 36041
    },
    {
      "position": 105,
      "id": "/tmp/repos/django/django/db/models/lookups.py_itertools_Lookup.apply_bilateral_transforms.2.1",
      "distance": 1.2097680568695068,
      "file_path": "django/db/models/lookups.py",
      "start_line": 1,
      "end_line": 41,
      "tokens": 313,
      "context_length": 36354
    },
    {
      "position": 106,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.update.alters_data_QuerySet.exists.2.1",
      "distance": 1.2103557586669922,
      "file_path": "django/db/models/query.py",
      "start_line": 786,
      "end_line": 809,
      "tokens": 207,
      "context_length": 36561
    },
    {
      "position": 107,
      "id": "/tmp/repos/django/django/db/models/query.py_QuerySet.complex_filter_QuerySet.complex_filter.2.4.1.1",
      "distance": 1.2108819484710693,
      "file_path": "django/db/models/query.py",
      "start_line": 989,
      "end_line": 1004,
      "tokens": 124,
      "context_length": 36685
    },
    {
      "position": 108,
      "id": "/tmp/repos/django/django/db/models/sql/query.py_Query.clone_Query.clone.30.1",
      "distance": 1.211740493774414,
      "file_path": "django/db/models/sql/query.py",
      "start_line": 300,
      "end_line": 349,
      "tokens": 444,
      "context_length": 37129
    },
    {
      "position": 109,
      "id": "/tmp/repos/django/django/db/models/query_utils.py_check_rel_lookup_compatibility_check_rel_lookup_compatibility.12.1",
      "distance": 1.2138590812683105,
      "file_path": "django/db/models/query_utils.py",
      "start_line": 257,
      "end_line": 282,
      "tokens": 293,
      "context_length": 37422,
      "file_pos": 29
    },
    {
      "position": 110,
      "id": "/tmp/repos/django/django/db/models/sql/compiler.py_SQLCompiler.ordering_parts.get_group_by_SQLCompiler.ordering_parts.get_group_by.45.1",
      "distance": 1.2143683433532715,
      "file_path": "django/db/models/sql/compiler.py",
      "start_line": 63,
      "end_line": 148,
      "tokens": 890,
      "context_length": 38312
    },
    {
      "position": 111,
      "id": "/tmp/repos/django/django/core/serializers/base.py_Serializer_Serializer.serialize.12.1",
      "distance": 1.2152814865112305,
      "file_path": "django/core/serializers/base.py",
      "start_line": 64,
      "end_line": 119,
      "tokens": 496,
      "context_length": 38808
    }
  ],
  "files": [
    {
      "file_path": "django/db/models/query_utils.py",
      "position": 1,
      "tokens": 2563,
      "context_length": 2563
    },
    {
      "file_path": "django/db/models/sql/query.py",
      "position": 2,
      "tokens": 22435,
      "context_length": 24998
    },
    {
      "file_path": "django/db/models/expressions.py",
      "position": 3,
      "tokens": 10987,
      "context_length": 35985
    },
    {
      "file_path": "django/db/models/query.py",
      "position": 4,
      "tokens": 17519,
      "context_length": 53504
    },
    {
      "file_path": "django/db/models/__init__.py",
      "position": 5,
      "tokens": 619,
      "context_length": 54123
    },
    {
      "file_path": "django/contrib/postgres/search.py",
      "position": 6,
      "tokens": 2222,
      "context_length": 56345
    },
    {
      "file_path": "django/db/models/sql/subqueries.py",
      "position": 7,
      "tokens": 1201,
      "context_length": 57546
    },
    {
      "file_path": "django/db/models/deletion.py",
      "position": 8,
      "tokens": 3828,
      "context_length": 61374
    },
    {
      "file_path": "django/db/models/constraints.py",
      "position": 9,
      "tokens": 2024,
      "context_length": 63398
    },
    {
      "file_path": "django/db/models/fields/related.py",
      "position": 10,
      "tokens": 13823,
      "context_length": 77221
    },
    {
      "file_path": "django/db/migrations/serializer.py",
      "position": 11,
      "tokens": 2671,
      "context_length": 79892
    },
    {
      "file_path": "django/db/models/sql/compiler.py",
      "position": 12,
      "tokens": 14400,
      "context_length": 94292
    },
    {
      "file_path": "django/db/models/base.py",
      "position": 13,
      "tokens": 17284,
      "context_length": 111576
    },
    {
      "file_path": "django/db/migrations/questioner.py",
      "position": 14,
      "tokens": 2057,
      "context_length": 113633
    },
    {
      "file_path": "django/contrib/postgres/constraints.py",
      "position": 15,
      "tokens": 1434,
      "context_length": 115067
    },
    {
      "file_path": "django/db/migrations/autodetector.py",
      "position": 16,
      "tokens": 11619,
      "context_length": 126686
    },
    {
      "file_path": "django/db/models/sql/where.py",
      "position": 17,
      "tokens": 1814,
      "context_length": 128500
    },
    {
      "file_path": "django/db/backends/base/schema.py",
      "position": 18,
      "tokens": 12692,
      "context_length": 141192
    },
    {
      "file_path": "django/contrib/admin/utils.py",
      "position": 19,
      "tokens": 4162,
      "context_length": 145354
    },
    {
      "file_path": "django/db/models/aggregates.py",
      "position": 20,
      "tokens": 1301,
      "context_length": 146655
    },
    {
      "file_path": "django/core/serializers/__init__.py",
      "position": 21,
      "tokens": 1757,
      "context_length": 148412
    },
    {
      "file_path": "django/db/models/sql/datastructures.py",
      "position": 22,
      "tokens": 1468,
      "context_length": 149880
    },
    {
      "file_path": "django/contrib/gis/db/models/__init__.py",
      "position": 23,
      "tokens": 204,
      "context_length": 150084
    },
    {
      "file_path": "django/db/models/fields/__init__.py",
      "position": 24,
      "tokens": 18418,
      "context_length": 168502
    },
    {
      "file_path": "django/forms/models.py",
      "position": 25,
      "tokens": 11774,
      "context_length": 180276
    },
    {
      "file_path": "django/db/models/options.py",
      "position": 26,
      "tokens": 7367,
      "context_length": 187643
    },
    {
      "file_path": "django/db/backends/oracle/creation.py",
      "position": 27,
      "tokens": 3893,
      "context_length": 191536
    },
    {
      "file_path": "django/db/models/indexes.py",
      "position": 28,
      "tokens": 2320,
      "context_length": 193856
    },
    {
      "file_path": "django/db/models/lookups.py",
      "position": 29,
      "tokens": 4955,
      "context_length": 198811
    },
    {
      "file_path": "django/core/serializers/base.py",
      "position": 30,
      "tokens": 2426,
      "context_length": 201237
    }
  ]
}