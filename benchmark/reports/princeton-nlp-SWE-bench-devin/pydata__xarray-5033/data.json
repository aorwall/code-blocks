{
  "instance_id": "pydata__xarray-5033",
  "model_patch": "diff --git a/xarray/backends/plugins.py b/xarray/backends/plugins.py\nindex f9790cfa..8d2e96b7 100644\n--- a/xarray/backends/plugins.py\n+++ b/xarray/backends/plugins.py\n@@ -114,6 +114,8 @@ def guess_engine(store_spec):\n \n def get_backend(engine):\n     \"\"\"Select open_dataset method based on current engine\"\"\"\n+    if callable(engine):\n+        return engine\n     engines = list_engines()\n     if engine not in engines:\n         raise ValueError(\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "pass",
  "model_patch_files": [
    "xarray/backends/plugins.py"
  ],
  "repo": "pydata/xarray",
  "base_commit": "f94de6b4504482ab206f93ec800608f2e1f47b19",
  "patch": "diff --git a/xarray/backends/api.py b/xarray/backends/api.py\n--- a/xarray/backends/api.py\n+++ b/xarray/backends/api.py\n@@ -375,10 +375,11 @@ def open_dataset(\n         scipy.io.netcdf (only netCDF3 supported). Byte-strings or file-like\n         objects are opened by scipy.io.netcdf (netCDF3) or h5py (netCDF4/HDF).\n     engine : {\"netcdf4\", \"scipy\", \"pydap\", \"h5netcdf\", \"pynio\", \"cfgrib\", \\\n-        \"pseudonetcdf\", \"zarr\"}, optional\n+        \"pseudonetcdf\", \"zarr\"} or subclass of xarray.backends.BackendEntrypoint, optional\n         Engine to use when reading files. If not provided, the default engine\n         is chosen based on available dependencies, with a preference for\n-        \"netcdf4\".\n+        \"netcdf4\". A custom backend class (a subclass of ``BackendEntrypoint``)\n+        can also be used.\n     chunks : int or dict, optional\n         If chunks is provided, it is used to load the new dataset into dask\n         arrays. ``chunks=-1`` loads the dataset with dask using a single\ndiff --git a/xarray/backends/plugins.py b/xarray/backends/plugins.py\n--- a/xarray/backends/plugins.py\n+++ b/xarray/backends/plugins.py\n@@ -5,7 +5,7 @@\n \n import pkg_resources\n \n-from .common import BACKEND_ENTRYPOINTS\n+from .common import BACKEND_ENTRYPOINTS, BackendEntrypoint\n \n STANDARD_BACKENDS_ORDER = [\"netcdf4\", \"h5netcdf\", \"scipy\"]\n \n@@ -113,10 +113,22 @@ def guess_engine(store_spec):\n \n \n def get_backend(engine):\n-    \"\"\"Select open_dataset method based on current engine\"\"\"\n-    engines = list_engines()\n-    if engine not in engines:\n-        raise ValueError(\n-            f\"unrecognized engine {engine} must be one of: {list(engines)}\"\n+    \"\"\"Select open_dataset method based on current engine.\"\"\"\n+    if isinstance(engine, str):\n+        engines = list_engines()\n+        if engine not in engines:\n+            raise ValueError(\n+                f\"unrecognized engine {engine} must be one of: {list(engines)}\"\n+            )\n+        backend = engines[engine]\n+    elif isinstance(engine, type) and issubclass(engine, BackendEntrypoint):\n+        backend = engine\n+    else:\n+        raise TypeError(\n+            (\n+                \"engine must be a string or a subclass of \"\n+                f\"xarray.backends.BackendEntrypoint: {engine}\"\n+            )\n         )\n-    return engines[engine]\n+\n+    return backend\n",
  "test_patch": "diff --git a/xarray/tests/test_backends_api.py b/xarray/tests/test_backends_api.py\n--- a/xarray/tests/test_backends_api.py\n+++ b/xarray/tests/test_backends_api.py\n@@ -1,6 +1,9 @@\n+import numpy as np\n+\n+import xarray as xr\n from xarray.backends.api import _get_default_engine\n \n-from . import requires_netCDF4, requires_scipy\n+from . import assert_identical, requires_netCDF4, requires_scipy\n \n \n @requires_netCDF4\n@@ -14,3 +17,20 @@ def test__get_default_engine():\n \n     engine_default = _get_default_engine(\"/example\")\n     assert engine_default == \"netcdf4\"\n+\n+\n+def test_custom_engine():\n+    expected = xr.Dataset(\n+        dict(a=2 * np.arange(5)), coords=dict(x=(\"x\", np.arange(5), dict(units=\"s\")))\n+    )\n+\n+    class CustomBackend(xr.backends.BackendEntrypoint):\n+        def open_dataset(\n+            filename_or_obj,\n+            drop_variables=None,\n+            **kwargs,\n+        ):\n+            return expected.copy(deep=True)\n+\n+    actual = xr.open_dataset(\"fake_filename\", engine=CustomBackend)\n+    assert_identical(expected, actual)\n",
  "problem_statement": "Simplify adding custom backends\n<!-- Please do a quick search of existing issues to make sure that this has not been asked before. -->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\nI've been working on opening custom hdf formats in xarray, reading up on the apiv2 it is currently only possible to declare a new external plugin in setup.py but that doesn't seem easy or intuitive to me.\r\n\r\n**Describe the solution you'd like**\r\nWhy can't we simply be allowed to add functions to the engine parameter? Example:\r\n```python\r\nfrom custom_backend import engine\r\n\r\nds = xr.load_dataset(filename, engine=engine)\r\n```\r\nThis seems like a small function change to me from my initial _quick_ look because there's mainly a bunch of string checks in the normal case until we get to the registered backend functions, if we send in a function instead in the engine-parameter we can just bypass those checks.\r\n\n",
  "hints_text": "",
  "created_at": "2021-03-13T22:12:39Z",
  "version": "0.12",
  "FAIL_TO_PASS": "[\"xarray/tests/test_backends_api.py::test_custom_engine\"]",
  "PASS_TO_PASS": "[]",
  "environment_setup_commit": "1c198a191127c601d091213c4b3292a8bb3054e1",
  "patch_files": [
    "xarray/backends/api.py",
    "xarray/backends/plugins.py"
  ],
  "test_patch_files": [
    "xarray/tests/test_backends_api.py"
  ],
  "patch_diff_details": {
    "xarray/backends/api.py": {
      "diffs": [
        {
          "start_line_old": 378,
          "end_line_old": 381,
          "file_pos": 2,
          "file_context_length": 12940,
          "closest_snippet_id": "/tmp/repos/xarray/xarray/backends/api.py__resolve_decoders_kwargs__finalize_store.4",
          "closest_snippet_line_distance": 154,
          "pos": 21,
          "context_length": 9379
        }
      ]
    },
    "xarray/backends/plugins.py": {
      "diffs": [
        {
          "start_line_old": 8,
          "end_line_old": 8,
          "file_pos": 1,
          "file_context_length": 872,
          "closest_snippet_id": "/tmp/repos/xarray/xarray/backends/plugins.py_detect_parameters_",
          "closest_snippet_line_distance": 27,
          "pos": 8,
          "context_length": 3043
        },
        {
          "start_line_old": 116,
          "end_line_old": 122,
          "file_pos": 1,
          "file_context_length": 872,
          "pos": 1,
          "context_length": 624
        }
      ]
    }
  },
  "vectors": 1088,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/xarray/xarray/backends/plugins.py_detect_parameters_",
      "distance": 0.97707200050354,
      "file_path": "xarray/backends/plugins.py",
      "start_line": 35,
      "end_line": 123,
      "tokens": 624,
      "context_length": 624,
      "file_pos": 1
    },
    {
      "position": 2,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_os__normalize_path.3.1",
      "distance": 1.0337157249450684,
      "file_path": "xarray/backends/api.py",
      "start_line": 1,
      "end_line": 119,
      "tokens": 713,
      "context_length": 1337,
      "file_pos": 2
    },
    {
      "position": 3,
      "id": "/tmp/repos/xarray/xarray/backends/api.py__dataset_from_backend_dataset__dataset_from_backend_dataset.7.1",
      "distance": 1.0617566108703613,
      "file_path": "xarray/backends/api.py",
      "start_line": 311,
      "end_line": 347,
      "tokens": 218,
      "context_length": 1555,
      "file_pos": 2
    },
    {
      "position": 4,
      "id": "/tmp/repos/xarray/xarray/backends/api.py__chunk_ds__chunk_ds.8.1",
      "distance": 1.071962833404541,
      "file_path": "xarray/backends/api.py",
      "start_line": 282,
      "end_line": 308,
      "tokens": 162,
      "context_length": 1717,
      "file_pos": 2
    },
    {
      "position": 5,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_mfdataset.17_WRITEABLE_STORES.1",
      "distance": 1.0751255750656128,
      "file_path": "xarray/backends/api.py",
      "start_line": 923,
      "end_line": 977,
      "tokens": 420,
      "context_length": 2137,
      "file_pos": 2
    },
    {
      "position": 6,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_dataset.2_open_dataset.11.1",
      "distance": 1.098528504371643,
      "file_path": "xarray/backends/api.py",
      "start_line": 480,
      "end_line": 527,
      "tokens": 353,
      "context_length": 2490,
      "file_pos": 2
    },
    {
      "position": 7,
      "id": "/tmp/repos/xarray/xarray/backends/common.py_BackendEntrypoint_",
      "distance": 1.1064221858978271,
      "file_path": "xarray/backends/common.py",
      "start_line": 346,
      "end_line": 386,
      "tokens": 306,
      "context_length": 2796
    },
    {
      "position": 8,
      "id": "/tmp/repos/xarray/xarray/backends/plugins.py_functools_remove_duplicates.pkg_entrypoints.6.1",
      "distance": 1.1134753227233887,
      "file_path": "xarray/backends/plugins.py",
      "start_line": 1,
      "end_line": 32,
      "tokens": 247,
      "context_length": 3043,
      "file_pos": 3
    },
    {
      "position": 9,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_mfdataset.2_open_mfdataset.16",
      "distance": 1.1170973777770996,
      "file_path": "xarray/backends/api.py",
      "start_line": 855,
      "end_line": 922,
      "tokens": 652,
      "context_length": 3695,
      "file_pos": 3
    },
    {
      "position": 10,
      "id": "/tmp/repos/xarray/xarray/backends/scipy_.py_ScipyBackendEntrypoint_",
      "distance": 1.1193840503692627,
      "file_path": "xarray/backends/scipy_.py",
      "start_line": 235,
      "end_line": 286,
      "tokens": 308,
      "context_length": 4003
    },
    {
      "position": 11,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_dataarray.2_open_mfdataset",
      "distance": 1.1417388916015625,
      "file_path": "xarray/backends/api.py",
      "start_line": 661,
      "end_line": 970,
      "tokens": 459,
      "context_length": 4462,
      "file_pos": 4
    },
    {
      "position": 12,
      "id": "/tmp/repos/xarray/xarray/backends/pydap_.py_PydapBackendEntrypoint_",
      "distance": 1.1595890522003174,
      "file_path": "xarray/backends/pydap_.py",
      "start_line": 110,
      "end_line": 148,
      "tokens": 231,
      "context_length": 4693
    },
    {
      "position": 13,
      "id": "/tmp/repos/xarray/doc/conf.py_1_nbsphinx_execute.1",
      "distance": 1.1730060577392578,
      "file_path": "doc/conf.py",
      "start_line": 1,
      "end_line": 101,
      "tokens": 670,
      "context_length": 5363
    },
    {
      "position": 14,
      "id": "/tmp/repos/xarray/xarray/backends/pynio_.py_PynioBackendEntrypoint_",
      "distance": 1.174358606338501,
      "file_path": "xarray/backends/pynio_.py",
      "start_line": 100,
      "end_line": 137,
      "tokens": 216,
      "context_length": 5579
    },
    {
      "position": 15,
      "id": "/tmp/repos/xarray/xarray/backends/cfgrib_.py_CfgribfBackendEntrypoint_",
      "distance": 1.1918115615844727,
      "file_path": "xarray/backends/cfgrib_.py",
      "start_line": 96,
      "end_line": 151,
      "tokens": 355,
      "context_length": 5934
    },
    {
      "position": 16,
      "id": "/tmp/repos/xarray/xarray/backends/api.py__resolve_decoders_kwargs__finalize_store.4",
      "distance": 1.1941990852355957,
      "file_path": "xarray/backends/api.py",
      "start_line": 189,
      "end_line": 227,
      "tokens": 259,
      "context_length": 6193,
      "file_pos": 8
    },
    {
      "position": 17,
      "id": "/tmp/repos/xarray/xarray/backends/zarr.py_ZarrBackendEntrypoint_",
      "distance": 1.2047311067581177,
      "file_path": "xarray/backends/zarr.py",
      "start_line": 685,
      "end_line": 732,
      "tokens": 277,
      "context_length": 6470
    },
    {
      "position": 18,
      "id": "/tmp/repos/xarray/doc/conf.py_nbsphinx_prolog_53",
      "distance": 1.2080626487731934,
      "file_path": "doc/conf.py",
      "start_line": 102,
      "end_line": 172,
      "tokens": 767,
      "context_length": 7237
    },
    {
      "position": 19,
      "id": "/tmp/repos/xarray/xarray/backends/pseudonetcdf_.py_PseudoNetCDFBackendEntrypoint_",
      "distance": 1.2118394374847412,
      "file_path": "xarray/backends/pseudonetcdf_.py",
      "start_line": 103,
      "end_line": 155,
      "tokens": 322,
      "context_length": 7559
    },
    {
      "position": 20,
      "id": "/tmp/repos/xarray/xarray/backends/h5netcdf_.py_H5netcdfBackendEntrypoint_",
      "distance": 1.2220306396484375,
      "file_path": "xarray/backends/h5netcdf_.py",
      "start_line": 336,
      "end_line": 396,
      "tokens": 353,
      "context_length": 7912
    },
    {
      "position": 21,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_dataset_open_dataset.1",
      "distance": 1.2305643558502197,
      "file_path": "xarray/backends/api.py",
      "start_line": 350,
      "end_line": 479,
      "tokens": 1467,
      "context_length": 9379,
      "file_pos": 11
    },
    {
      "position": 22,
      "id": "/tmp/repos/xarray/doc/conf.py_ogp_custom_meta_tags_114",
      "distance": 1.2306873798370361,
      "file_path": "doc/conf.py",
      "start_line": 260,
      "end_line": 309,
      "tokens": 586,
      "context_length": 9965
    },
    {
      "position": 23,
      "id": "/tmp/repos/xarray/xarray/backends/file_manager.py_contextlib__DEFAULT_MODE.1",
      "distance": 1.2513492107391357,
      "file_path": "xarray/backends/file_manager.py",
      "start_line": 1,
      "end_line": 21,
      "tokens": 139,
      "context_length": 10104
    },
    {
      "position": 24,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_save_mfdataset.2_save_mfdataset.8.2.1",
      "distance": 1.2540602684020996,
      "file_path": "xarray/backends/api.py",
      "start_line": 1203,
      "end_line": 1246,
      "tokens": 320,
      "context_length": 10424,
      "file_pos": 12
    },
    {
      "position": 25,
      "id": "/tmp/repos/xarray/xarray/__init__.py_pkg_resources_",
      "distance": 1.2560869455337524,
      "file_path": "xarray/__init__.py",
      "start_line": 1,
      "end_line": 93,
      "tokens": 603,
      "context_length": 11027
    },
    {
      "position": 26,
      "id": "/tmp/repos/xarray/xarray/backends/api.py__validate_append_dim_and_encoding__validate_append_dim_and_encoding.4.1.7.1",
      "distance": 1.2573543787002563,
      "file_path": "xarray/backends/api.py",
      "start_line": 1273,
      "end_line": 1362,
      "tokens": 789,
      "context_length": 11816,
      "file_pos": 13
    },
    {
      "position": 27,
      "id": "/tmp/repos/xarray/doc/conf.py_templates_path_ogp_image.1",
      "distance": 1.2620865106582642,
      "file_path": "doc/conf.py",
      "start_line": 173,
      "end_line": 259,
      "tokens": 747,
      "context_length": 12563
    },
    {
      "position": 28,
      "id": "/tmp/repos/xarray/xarray/tutorial.py_1_overrides.1",
      "distance": 1.2653305530548096,
      "file_path": "xarray/tutorial.py",
      "start_line": 1,
      "end_line": 38,
      "tokens": 208,
      "context_length": 12771
    },
    {
      "position": 29,
      "id": "/tmp/repos/xarray/xarray/backends/store.py_conventions_",
      "distance": 1.268799066543579,
      "file_path": "xarray/backends/store.py",
      "start_line": 1,
      "end_line": 46,
      "tokens": 259,
      "context_length": 13030
    },
    {
      "position": 30,
      "id": "/tmp/repos/xarray/xarray/backends/pynio_.py_np_PYNIO_LOCK.1",
      "distance": 1.2712782621383667,
      "file_path": "xarray/backends/pynio_.py",
      "start_line": 1,
      "end_line": 27,
      "tokens": 186,
      "context_length": 13216
    },
    {
      "position": 31,
      "id": "/tmp/repos/xarray/xarray/core/common.py_DataWithCoords.pipe_DataWithCoords.pipe.2.5.1.1",
      "distance": 1.2742681503295898,
      "file_path": "xarray/core/common.py",
      "start_line": 511,
      "end_line": 643,
      "tokens": 1180,
      "context_length": 14396
    },
    {
      "position": 32,
      "id": "/tmp/repos/xarray/xarray/core/options.py_warnings__get_keep_attrs.2.3.1",
      "distance": 1.277167558670044,
      "file_path": "xarray/core/options.py",
      "start_line": 1,
      "end_line": 78,
      "tokens": 547,
      "context_length": 14943
    },
    {
      "position": 33,
      "id": "/tmp/repos/xarray/xarray/core/variable.py_Variable._as_sparse_Variable._to_dense.3.1",
      "distance": 1.2783029079437256,
      "file_path": "xarray/core/variable.py",
      "start_line": 1086,
      "end_line": 1114,
      "tokens": 242,
      "context_length": 15185
    },
    {
      "position": 34,
      "id": "/tmp/repos/xarray/xarray/plot/dataset_plot.py__dsplot.2__dsplot.newplotfunc.15.3",
      "distance": 1.2795653343200684,
      "file_path": "xarray/plot/dataset_plot.py",
      "start_line": 277,
      "end_line": 389,
      "tokens": 828,
      "context_length": 16013
    },
    {
      "position": 35,
      "id": "/tmp/repos/xarray/xarray/backends/netCDF4_.py_NetCDF4BackendEntrypoint_",
      "distance": 1.2805525064468384,
      "file_path": "xarray/backends/netCDF4_.py",
      "start_line": 515,
      "end_line": 574,
      "tokens": 353,
      "context_length": 16366
    },
    {
      "position": 36,
      "id": "/tmp/repos/xarray/xarray/plot/plot.py__plot2d.newplotfunc.4.add_colorbar__plot2d.newplotfunc.4.43.1",
      "distance": 1.2808820009231567,
      "file_path": "xarray/plot/plot.py",
      "start_line": 636,
      "end_line": 793,
      "tokens": 1739,
      "context_length": 18105
    },
    {
      "position": 37,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_os_vectorized_assignment_values.1",
      "distance": 1.2858742475509644,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 1,
      "end_line": 59,
      "tokens": 733,
      "context_length": 18838
    },
    {
      "position": 38,
      "id": "/tmp/repos/xarray/xarray/backends/pydap_.py_np_8.3.has_pydap.1",
      "distance": 1.288485050201416,
      "file_path": "xarray/backends/pydap_.py",
      "start_line": 1,
      "end_line": 21,
      "tokens": 118,
      "context_length": 18956
    },
    {
      "position": 39,
      "id": "/tmp/repos/xarray/xarray/core/common.py_full_like_full_like_29.1",
      "distance": 1.288809061050415,
      "file_path": "xarray/core/common.py",
      "start_line": 1506,
      "end_line": 1522,
      "tokens": 107,
      "context_length": 19063
    },
    {
      "position": 40,
      "id": "/tmp/repos/xarray/xarray/backends/zarr.py_open_zarr.open_dataset_open_zarr.7.1",
      "distance": 1.2898808717727661,
      "file_path": "xarray/backends/zarr.py",
      "start_line": 643,
      "end_line": 682,
      "tokens": 311,
      "context_length": 19374
    },
    {
      "position": 41,
      "id": "/tmp/repos/xarray/xarray/backends/scipy_.py_io__decode_attrs.3.1",
      "distance": 1.2909313440322876,
      "file_path": "xarray/backends/scipy_.py",
      "start_line": 1,
      "end_line": 37,
      "tokens": 251,
      "context_length": 19625
    },
    {
      "position": 42,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_dataarray_open_dataarray.1",
      "distance": 1.2919421195983887,
      "file_path": "xarray/backends/api.py",
      "start_line": 530,
      "end_line": 660,
      "tokens": 1491,
      "context_length": 21116,
      "file_pos": 22
    },
    {
      "position": 43,
      "id": "/tmp/repos/xarray/xarray/backends/pydap_.py__fix_attributes__fix_attributes.3.1",
      "distance": 1.2936108112335205,
      "file_path": "xarray/backends/pydap_.py",
      "start_line": 54,
      "end_line": 70,
      "tokens": 132,
      "context_length": 21248
    },
    {
      "position": 44,
      "id": "/tmp/repos/xarray/xarray/backends/__init__.py_1_",
      "distance": 1.2943365573883057,
      "file_path": "xarray/backends/__init__.py",
      "start_line": 1,
      "end_line": 37,
      "tokens": 297,
      "context_length": 21545
    },
    {
      "position": 45,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_open_mfdataset.1_open_mfdataset.1",
      "distance": 1.2955279350280762,
      "file_path": "xarray/backends/api.py",
      "start_line": 723,
      "end_line": 854,
      "tokens": 1610,
      "context_length": 23155,
      "file_pos": 23
    },
    {
      "position": 46,
      "id": "/tmp/repos/xarray/xarray/backends/common.py_ArrayWriter_ArrayWriter.sync.1.9.1",
      "distance": 1.297818899154663,
      "file_path": "xarray/backends/common.py",
      "start_line": 128,
      "end_line": 167,
      "tokens": 245,
      "context_length": 23400
    },
    {
      "position": 47,
      "id": "/tmp/repos/xarray/xarray/core/duck_array_ops.py__dask_or_eager_func__dask_or_eager_func.3.1",
      "distance": 1.303844690322876,
      "file_path": "xarray/core/duck_array_ops.py",
      "start_line": 33,
      "end_line": 63,
      "tokens": 209,
      "context_length": 23609
    },
    {
      "position": 48,
      "id": "/tmp/repos/xarray/xarray/backends/scipy_.py__open_scipy_netcdf__open_scipy_netcdf.5.2.errmsg.2.4.1",
      "distance": 1.3050847053527832,
      "file_path": "xarray/backends/scipy_.py",
      "start_line": 73,
      "end_line": 107,
      "tokens": 300,
      "context_length": 23909
    },
    {
      "position": 49,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/interp.py_Interpolation.time_interpolation_",
      "distance": 1.30540931224823,
      "file_path": "asv_bench/benchmarks/interp.py",
      "start_line": 41,
      "end_line": 56,
      "tokens": 162,
      "context_length": 24071
    },
    {
      "position": 50,
      "id": "/tmp/repos/xarray/doc/conf.py_intersphinx_mapping_intersphinx_mapping.1",
      "distance": 1.3115359544754028,
      "file_path": "doc/conf.py",
      "start_line": 310,
      "end_line": 322,
      "tokens": 204,
      "context_length": 24275
    },
    {
      "position": 51,
      "id": "/tmp/repos/xarray/xarray/plot/dataset_plot.py_functools__infer_meta_data.11.1",
      "distance": 1.313457727432251,
      "file_path": "xarray/plot/dataset_plot.py",
      "start_line": 1,
      "end_line": 101,
      "tokens": 728,
      "context_length": 25003
    },
    {
      "position": 52,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/dataarray_missing.py_pd_",
      "distance": 1.3142387866973877,
      "file_path": "asv_bench/benchmarks/dataarray_missing.py",
      "start_line": 1,
      "end_line": 75,
      "tokens": 531,
      "context_length": 25534
    },
    {
      "position": 53,
      "id": "/tmp/repos/xarray/xarray/backends/zarr.py_os_DIMENSION_KEY.1",
      "distance": 1.3169281482696533,
      "file_path": "xarray/backends/zarr.py",
      "start_line": 1,
      "end_line": 30,
      "tokens": 154,
      "context_length": 25688
    },
    {
      "position": 54,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py__decompose_outer_indexer.10__decompose_outer_indexer.15.1",
      "distance": 1.3182848691940308,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1030,
      "end_line": 1097,
      "tokens": 746,
      "context_length": 26434
    },
    {
      "position": 55,
      "id": "/tmp/repos/xarray/xarray/backends/file_manager.py__HashedSequence_",
      "distance": 1.3231892585754395,
      "file_path": "xarray/backends/file_manager.py",
      "start_line": 299,
      "end_line": 334,
      "tokens": 204,
      "context_length": 26638
    },
    {
      "position": 56,
      "id": "/tmp/repos/xarray/xarray/backends/common.py_WritableCFDataStore_WritableCFDataStore.encode.3",
      "distance": 1.3238216638565063,
      "file_path": "xarray/backends/common.py",
      "start_line": 334,
      "end_line": 343,
      "tokens": 109,
      "context_length": 26747
    },
    {
      "position": 57,
      "id": "/tmp/repos/xarray/xarray/backends/h5netcdf_.py_functools_14.3.has_h5netcdf.1",
      "distance": 1.324713110923767,
      "file_path": "xarray/backends/h5netcdf_.py",
      "start_line": 1,
      "end_line": 33,
      "tokens": 197,
      "context_length": 26944
    },
    {
      "position": 58,
      "id": "/tmp/repos/xarray/xarray/core/parallel.py_map_blocks.37_map_blocks.42.result[index].encoding.1",
      "distance": 1.3253206014633179,
      "file_path": "xarray/core/parallel.py",
      "start_line": 482,
      "end_line": 551,
      "tokens": 730,
      "context_length": 27674
    },
    {
      "position": 59,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/rolling.py_RollingDask_RollingMemory.setup.self.ds.1",
      "distance": 1.3253589868545532,
      "file_path": "asv_bench/benchmarks/rolling.py",
      "start_line": 64,
      "end_line": 86,
      "tokens": 215,
      "context_length": 27889
    },
    {
      "position": 60,
      "id": "/tmp/repos/xarray/xarray/tutorial.py_15_open_dataset.10.1",
      "distance": 1.32693612575531,
      "file_path": "xarray/tutorial.py",
      "start_line": 41,
      "end_line": 114,
      "tokens": 480,
      "context_length": 28369
    },
    {
      "position": 61,
      "id": "/tmp/repos/xarray/xarray/core/options.py_set_options_",
      "distance": 1.3273208141326904,
      "file_path": "xarray/core/options.py",
      "start_line": 81,
      "end_line": 164,
      "tokens": 810,
      "context_length": 29179
    },
    {
      "position": 62,
      "id": "/tmp/repos/xarray/xarray/plot/plot.py_14_override_signature",
      "distance": 1.32769775390625,
      "file_path": "xarray/plot/plot.py",
      "start_line": 432,
      "end_line": 472,
      "tokens": 293,
      "context_length": 29472
    },
    {
      "position": 63,
      "id": "/tmp/repos/xarray/xarray/plot/utils.py_itertools__determine_extend.4.1",
      "distance": 1.3279038667678833,
      "file_path": "xarray/plot/utils.py",
      "start_line": 1,
      "end_line": 54,
      "tokens": 283,
      "context_length": 29755
    },
    {
      "position": 64,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/interp.py_np_new_y_long.1",
      "distance": 1.331019639968872,
      "file_path": "asv_bench/benchmarks/interp.py",
      "start_line": 1,
      "end_line": 22,
      "tokens": 184,
      "context_length": 29939
    },
    {
      "position": 65,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/pandas.py_np_",
      "distance": 1.3325004577636719,
      "file_path": "asv_bench/benchmarks/pandas.py",
      "start_line": 1,
      "end_line": 25,
      "tokens": 160,
      "context_length": 30099
    },
    {
      "position": 66,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/dataset_io.py_IOWriteSingleNetCDF3_IOReadSingleNetCDF4.time_vectorized_indexing.ds_2.1",
      "distance": 1.3343465328216553,
      "file_path": "asv_bench/benchmarks/dataset_io.py",
      "start_line": 93,
      "end_line": 123,
      "tokens": 269,
      "context_length": 30368
    },
    {
      "position": 67,
      "id": "/tmp/repos/xarray/conftest.py_1_",
      "distance": 1.3349761962890625,
      "file_path": "conftest.py",
      "start_line": 1,
      "end_line": 42,
      "tokens": 278,
      "context_length": 30646
    },
    {
      "position": 68,
      "id": "/tmp/repos/xarray/xarray/core/missing.py__interpnd__interpnd.10.1",
      "distance": 1.335600733757019,
      "file_path": "xarray/core/missing.py",
      "start_line": 766,
      "end_line": 779,
      "tokens": 182,
      "context_length": 30828
    },
    {
      "position": 69,
      "id": "/tmp/repos/xarray/xarray/core/dataset.py__initialize_curvefit_params.param_defaults__initialize_curvefit_params.6.1",
      "distance": 1.3358088731765747,
      "file_path": "xarray/core/dataset.py",
      "start_line": 503,
      "end_line": 514,
      "tokens": 177,
      "context_length": 31005
    },
    {
      "position": 70,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_Assignment_Assignment.time_assignment_vectorized.params.1",
      "distance": 1.3359348773956299,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 99,
      "end_line": 122,
      "tokens": 231,
      "context_length": 31236
    },
    {
      "position": 71,
      "id": "/tmp/repos/xarray/xarray/backends/api.py_to_netcdf_to_netcdf.23",
      "distance": 1.3366049528121948,
      "file_path": "xarray/backends/api.py",
      "start_line": 980,
      "end_line": 1073,
      "tokens": 766,
      "context_length": 32002,
      "file_pos": 35
    },
    {
      "position": 72,
      "id": "/tmp/repos/xarray/xarray/backends/netCDF4_.py_functools_NETCDF4_PYTHON_LOCK.1",
      "distance": 1.336796522140503,
      "file_path": "xarray/backends/netCDF4_.py",
      "start_line": 1,
      "end_line": 40,
      "tokens": 265,
      "context_length": 32267
    },
    {
      "position": 73,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/dataset_io.py_IOReadMultipleNetCDF3Dask_IOReadMultipleNetCDF3Dask.time_open_dataset_scipy_with_time_chunks.1.1",
      "distance": 1.336998462677002,
      "file_path": "asv_bench/benchmarks/dataset_io.py",
      "start_line": 395,
      "end_line": 426,
      "tokens": 264,
      "context_length": 32531
    },
    {
      "position": 74,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/dataset_io.py_create_delayed_write_",
      "distance": 1.337017297744751,
      "file_path": "asv_bench/benchmarks/dataset_io.py",
      "start_line": 429,
      "end_line": 464,
      "tokens": 186,
      "context_length": 32717
    },
    {
      "position": 75,
      "id": "/tmp/repos/xarray/xarray/core/variable.py_Variable._binary_op_Variable._binary_op.2.1",
      "distance": 1.3377434015274048,
      "file_path": "xarray/core/variable.py",
      "start_line": 2303,
      "end_line": 2321,
      "tokens": 174,
      "context_length": 32891
    },
    {
      "position": 76,
      "id": "/tmp/repos/xarray/xarray/backends/pydap_.py_PydapArrayWrapper_PydapArrayWrapper._getitem.array.6.1",
      "distance": 1.338580846786499,
      "file_path": "xarray/backends/pydap_.py",
      "start_line": 24,
      "end_line": 51,
      "tokens": 215,
      "context_length": 33106
    },
    {
      "position": 77,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_Indexing_Indexing.time_indexing_vectorized.params.1",
      "distance": 1.3417354822158813,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 79,
      "end_line": 96,
      "tokens": 153,
      "context_length": 33259
    },
    {
      "position": 78,
      "id": "/tmp/repos/xarray/xarray/core/ops.py_inject_all_ops_and_reduce_methods_",
      "distance": 1.3422845602035522,
      "file_path": "xarray/core/ops.py",
      "start_line": 325,
      "end_line": 350,
      "tokens": 235,
      "context_length": 33494
    }
  ],
  "files": [
    {
      "file_path": "xarray/backends/plugins.py",
      "position": 1,
      "tokens": 872,
      "context_length": 872
    },
    {
      "file_path": "xarray/backends/api.py",
      "position": 2,
      "tokens": 12068,
      "context_length": 12940
    },
    {
      "file_path": "xarray/backends/common.py",
      "position": 3,
      "tokens": 2475,
      "context_length": 15415
    },
    {
      "file_path": "xarray/backends/scipy_.py",
      "position": 4,
      "tokens": 1976,
      "context_length": 17391
    },
    {
      "file_path": "xarray/backends/pydap_.py",
      "position": 5,
      "tokens": 917,
      "context_length": 18308
    },
    {
      "file_path": "doc/conf.py",
      "position": 6,
      "tokens": 3330,
      "context_length": 21638
    },
    {
      "file_path": "xarray/backends/pynio_.py",
      "position": 7,
      "tokens": 873,
      "context_length": 22511
    },
    {
      "file_path": "xarray/backends/cfgrib_.py",
      "position": 8,
      "tokens": 970,
      "context_length": 23481
    },
    {
      "file_path": "xarray/backends/zarr.py",
      "position": 9,
      "tokens": 5588,
      "context_length": 29069
    },
    {
      "file_path": "xarray/backends/pseudonetcdf_.py",
      "position": 10,
      "tokens": 991,
      "context_length": 30060
    },
    {
      "file_path": "xarray/backends/h5netcdf_.py",
      "position": 11,
      "tokens": 2767,
      "context_length": 32827
    },
    {
      "file_path": "xarray/backends/file_manager.py",
      "position": 12,
      "tokens": 2562,
      "context_length": 35389
    },
    {
      "file_path": "xarray/__init__.py",
      "position": 13,
      "tokens": 603,
      "context_length": 35992
    },
    {
      "file_path": "xarray/tutorial.py",
      "position": 14,
      "tokens": 999,
      "context_length": 36991
    },
    {
      "file_path": "xarray/backends/store.py",
      "position": 15,
      "tokens": 260,
      "context_length": 37251
    },
    {
      "file_path": "xarray/core/common.py",
      "position": 16,
      "tokens": 15702,
      "context_length": 52953
    },
    {
      "file_path": "xarray/core/options.py",
      "position": 17,
      "tokens": 1357,
      "context_length": 54310
    },
    {
      "file_path": "xarray/core/variable.py",
      "position": 18,
      "tokens": 22720,
      "context_length": 77030
    },
    {
      "file_path": "xarray/plot/dataset_plot.py",
      "position": 19,
      "tokens": 4686,
      "context_length": 81716
    },
    {
      "file_path": "xarray/backends/netCDF4_.py",
      "position": 20,
      "tokens": 4106,
      "context_length": 85822
    },
    {
      "file_path": "xarray/plot/plot.py",
      "position": 21,
      "tokens": 8354,
      "context_length": 94176
    },
    {
      "file_path": "asv_bench/benchmarks/indexing.py",
      "position": 22,
      "tokens": 1560,
      "context_length": 95736
    },
    {
      "file_path": "xarray/backends/__init__.py",
      "position": 23,
      "tokens": 297,
      "context_length": 96033
    },
    {
      "file_path": "xarray/core/duck_array_ops.py",
      "position": 24,
      "tokens": 5214,
      "context_length": 101247
    },
    {
      "file_path": "asv_bench/benchmarks/interp.py",
      "position": 25,
      "tokens": 485,
      "context_length": 101732
    },
    {
      "file_path": "asv_bench/benchmarks/dataarray_missing.py",
      "position": 26,
      "tokens": 531,
      "context_length": 102263
    },
    {
      "file_path": "xarray/core/indexing.py",
      "position": 27,
      "tokens": 11961,
      "context_length": 114224
    },
    {
      "file_path": "xarray/core/parallel.py",
      "position": 28,
      "tokens": 5046,
      "context_length": 119270
    },
    {
      "file_path": "asv_bench/benchmarks/rolling.py",
      "position": 29,
      "tokens": 993,
      "context_length": 120263
    },
    {
      "file_path": "xarray/plot/utils.py",
      "position": 30,
      "tokens": 6739,
      "context_length": 127002
    },
    {
      "file_path": "asv_bench/benchmarks/pandas.py",
      "position": 31,
      "tokens": 160,
      "context_length": 127162
    },
    {
      "file_path": "asv_bench/benchmarks/dataset_io.py",
      "position": 32,
      "tokens": 3581,
      "context_length": 130743
    },
    {
      "file_path": "conftest.py",
      "position": 33,
      "tokens": 278,
      "context_length": 131021
    },
    {
      "file_path": "xarray/core/missing.py",
      "position": 34,
      "tokens": 6099,
      "context_length": 137120
    },
    {
      "file_path": "xarray/core/dataset.py",
      "position": 35,
      "tokens": 61695,
      "context_length": 198815
    },
    {
      "file_path": "xarray/core/ops.py",
      "position": 36,
      "tokens": 2653,
      "context_length": 201468
    }
  ]
}