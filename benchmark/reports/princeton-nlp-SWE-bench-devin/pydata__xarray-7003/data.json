{
  "instance_id": "pydata__xarray-7003",
  "model_patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\nindex 8ff0d40f..50b0ede7 100644\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -1090,14 +1090,14 @@ class Indexes(collections.abc.Mapping, Generic[T_PandasOrXarrayIndex]):\n \n     def get_unique(self) -> list[T_PandasOrXarrayIndex]:\n         \"\"\"Return a list of unique indexes, preserving order.\"\"\"\n-\n         unique_indexes: list[T_PandasOrXarrayIndex] = []\n-        seen: set[T_PandasOrXarrayIndex] = set()\n+        seen_ids: set[int] = set()\n \n         for index in self._indexes.values():\n-            if index not in seen:\n+            index_id = id(index)\n+            if index_id not in seen_ids:\n                 unique_indexes.append(index)\n-                seen.add(index)\n+                seen_ids.add(index_id)\n \n         return unique_indexes\n \n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "xarray/core/indexes.py"
  ],
  "repo": "pydata/xarray",
  "base_commit": "5bec4662a7dd4330eca6412c477ca3f238323ed2",
  "patch": "diff --git a/xarray/core/indexes.py b/xarray/core/indexes.py\n--- a/xarray/core/indexes.py\n+++ b/xarray/core/indexes.py\n@@ -1092,12 +1092,13 @@ def get_unique(self) -> list[T_PandasOrXarrayIndex]:\n         \"\"\"Return a list of unique indexes, preserving order.\"\"\"\n \n         unique_indexes: list[T_PandasOrXarrayIndex] = []\n-        seen: set[T_PandasOrXarrayIndex] = set()\n+        seen: set[int] = set()\n \n         for index in self._indexes.values():\n-            if index not in seen:\n+            index_id = id(index)\n+            if index_id not in seen:\n                 unique_indexes.append(index)\n-                seen.add(index)\n+                seen.add(index_id)\n \n         return unique_indexes\n \n@@ -1201,9 +1202,24 @@ def copy_indexes(\n         \"\"\"\n         new_indexes = {}\n         new_index_vars = {}\n+\n         for idx, coords in self.group_by_index():\n+            if isinstance(idx, pd.Index):\n+                convert_new_idx = True\n+                dim = next(iter(coords.values())).dims[0]\n+                if isinstance(idx, pd.MultiIndex):\n+                    idx = PandasMultiIndex(idx, dim)\n+                else:\n+                    idx = PandasIndex(idx, dim)\n+            else:\n+                convert_new_idx = False\n+\n             new_idx = idx.copy(deep=deep)\n             idx_vars = idx.create_variables(coords)\n+\n+            if convert_new_idx:\n+                new_idx = cast(PandasIndex, new_idx).index\n+\n             new_indexes.update({k: new_idx for k in coords})\n             new_index_vars.update(idx_vars)\n \n",
  "test_patch": "diff --git a/xarray/tests/test_indexes.py b/xarray/tests/test_indexes.py\n--- a/xarray/tests/test_indexes.py\n+++ b/xarray/tests/test_indexes.py\n@@ -9,6 +9,7 @@\n \n import xarray as xr\n from xarray.core.indexes import (\n+    Hashable,\n     Index,\n     Indexes,\n     PandasIndex,\n@@ -535,7 +536,7 @@ def test_copy(self) -> None:\n \n class TestIndexes:\n     @pytest.fixture\n-    def unique_indexes(self) -> list[PandasIndex]:\n+    def indexes_and_vars(self) -> tuple[list[PandasIndex], dict[Hashable, Variable]]:\n         x_idx = PandasIndex(pd.Index([1, 2, 3], name=\"x\"), \"x\")\n         y_idx = PandasIndex(pd.Index([4, 5, 6], name=\"y\"), \"y\")\n         z_pd_midx = pd.MultiIndex.from_product(\n@@ -543,10 +544,29 @@ def unique_indexes(self) -> list[PandasIndex]:\n         )\n         z_midx = PandasMultiIndex(z_pd_midx, \"z\")\n \n-        return [x_idx, y_idx, z_midx]\n+        indexes = [x_idx, y_idx, z_midx]\n+\n+        variables = {}\n+        for idx in indexes:\n+            variables.update(idx.create_variables())\n+\n+        return indexes, variables\n+\n+    @pytest.fixture(params=[\"pd_index\", \"xr_index\"])\n+    def unique_indexes(\n+        self, request, indexes_and_vars\n+    ) -> list[PandasIndex] | list[pd.Index]:\n+        xr_indexes, _ = indexes_and_vars\n+\n+        if request.param == \"pd_index\":\n+            return [idx.index for idx in xr_indexes]\n+        else:\n+            return xr_indexes\n \n     @pytest.fixture\n-    def indexes(self, unique_indexes) -> Indexes[Index]:\n+    def indexes(\n+        self, unique_indexes, indexes_and_vars\n+    ) -> Indexes[Index] | Indexes[pd.Index]:\n         x_idx, y_idx, z_midx = unique_indexes\n         indexes: dict[Any, Index] = {\n             \"x\": x_idx,\n@@ -555,9 +575,8 @@ def indexes(self, unique_indexes) -> Indexes[Index]:\n             \"one\": z_midx,\n             \"two\": z_midx,\n         }\n-        variables: dict[Any, Variable] = {}\n-        for idx in unique_indexes:\n-            variables.update(idx.create_variables())\n+\n+        _, variables = indexes_and_vars\n \n         return Indexes(indexes, variables)\n \n",
  "problem_statement": "Indexes.get_unique() TypeError with pandas indexes\n@benbovy I also just tested the `get_unique()` method that you mentioned and maybe noticed a related issue here, which I'm not sure is wanted / expected.\r\n\r\nTaking the above dataset `ds`, accessing this function results in an error:\r\n\r\n```python\r\n> ds.indexes.get_unique()\r\n\r\nTypeError: unhashable type: 'MultiIndex'\r\n```\r\n\r\nHowever, for `xindexes` it works:\r\n```python\r\n> ds.xindexes.get_unique()\r\n\r\n[<xarray.core.indexes.PandasMultiIndex at 0x7f105bf1df20>]\r\n```\r\n\r\n_Originally posted by @lukasbindreiter in https://github.com/pydata/xarray/issues/6752#issuecomment-1236717180_\n",
  "hints_text": "",
  "created_at": "2022-09-07T11:05:02Z",
  "version": "2022.06",
  "FAIL_TO_PASS": "[\"xarray/tests/test_indexes.py::TestIndexes::test_copy_indexes[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_unique[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_group_by_index[pd_index]\"]",
  "PASS_TO_PASS": "[\"xarray/tests/test_indexes.py::TestIndex::test_concat\", \"xarray/tests/test_indexes.py::TestIndex::test_copy[False]\", \"xarray/tests/test_indexes.py::TestIndex::test_copy[True]\", \"xarray/tests/test_indexes.py::TestIndex::test_create_variables\", \"xarray/tests/test_indexes.py::TestIndex::test_equals\", \"xarray/tests/test_indexes.py::TestIndex::test_from_variables\", \"xarray/tests/test_indexes.py::TestIndex::test_getitem\", \"xarray/tests/test_indexes.py::TestIndex::test_isel\", \"xarray/tests/test_indexes.py::TestIndex::test_join\", \"xarray/tests/test_indexes.py::TestIndex::test_reindex_like\", \"xarray/tests/test_indexes.py::TestIndex::test_rename\", \"xarray/tests/test_indexes.py::TestIndex::test_roll\", \"xarray/tests/test_indexes.py::TestIndex::test_sel\", \"xarray/tests/test_indexes.py::TestIndex::test_stack\", \"xarray/tests/test_indexes.py::TestIndex::test_to_pandas_index\", \"xarray/tests/test_indexes.py::TestIndex::test_unstack\", \"xarray/tests/test_indexes.py::TestIndexes::test_copy_indexes[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_dims[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_dims[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_all_coords[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_all_coords[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_all_dims[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_all_dims[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_get_unique[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_group_by_index[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_interface[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_interface[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_is_multi[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_is_multi[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_to_pandas_indexes[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_to_pandas_indexes[xr_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_variables[pd_index]\", \"xarray/tests/test_indexes.py::TestIndexes::test_variables[xr_index]\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_concat_dim_error\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_concat_empty\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_concat_periods\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_concat_str_dtype[bytes]\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_concat_str_dtype[str]\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_constructor\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_copy\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_create_variables\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_equals\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_from_variables\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_from_variables_index_adapter\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_getitem\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_join\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_reindex_like\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_rename\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_sel\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_sel_boolean\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_sel_datetime\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_sel_unsorted_datetime_index_raises\", \"xarray/tests/test_indexes.py::TestPandasIndex::test_to_pandas_index\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_concat\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_constructor\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_copy\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_create_variables\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_from_variables\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_join\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_rename\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_sel\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_stack\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_stack_non_unique\", \"xarray/tests/test_indexes.py::TestPandasMultiIndex::test_unstack\", \"xarray/tests/test_indexes.py::test_asarray_tuplesafe\"]",
  "environment_setup_commit": "50ea159bfd0872635ebf4281e741f3c87f0bef6b",
  "patch_files": [
    "xarray/core/indexes.py"
  ],
  "test_patch_files": [
    "xarray/tests/test_indexes.py"
  ],
  "patch_diff_details": {
    "xarray/core/indexes.py": {
      "diffs": [
        {
          "start_line_old": 1095,
          "end_line_old": 1100,
          "file_pos": 1,
          "file_context_length": 10615,
          "closest_snippet_id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes.group_by_index_Indexes.to_pandas_indexes.4.1",
          "closest_snippet_line_distance": 69,
          "pos": 2,
          "context_length": 984
        },
        {
          "start_line_old": 1204,
          "end_line_old": 1204,
          "file_pos": 1,
          "file_context_length": 10615,
          "closest_snippet_id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.join_PandasMultiIndex.join.3.1",
          "closest_snippet_line_distance": 270,
          "pos": 9,
          "context_length": 2765
        }
      ]
    }
  },
  "vectors": 1285,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes.group_by_index_Indexes.to_pandas_indexes.4.1",
      "distance": 0.8034234046936035,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1164,
      "end_line": 1193,
      "tokens": 242,
      "context_length": 242,
      "file_pos": 1
    },
    {
      "position": 2,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes_Indexes.is_multi.2.1",
      "distance": 0.9051076173782349,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1008,
      "end_line": 1108,
      "tokens": 742,
      "context_length": 984,
      "file_pos": 1
    },
    {
      "position": 3,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_group_indexers_by_index_group_indexers_by_index.5.1",
      "distance": 0.9523708820343018,
      "file_path": "xarray/core/indexing.py",
      "start_line": 120,
      "end_line": 152,
      "tokens": 304,
      "context_length": 1288
    },
    {
      "position": 4,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.sel.8_PandasMultiIndex.sel.8.10.1.1",
      "distance": 0.9738682508468628,
      "file_path": "xarray/core/indexes.py",
      "start_line": 877,
      "end_line": 916,
      "tokens": 314,
      "context_length": 1602,
      "file_pos": 2
    },
    {
      "position": 5,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex.to_pandas_index_PandasIndex.isel.5.1",
      "distance": 0.9890060424804688,
      "file_path": "xarray/core/indexes.py",
      "start_line": 343,
      "end_line": 362,
      "tokens": 156,
      "context_length": 1758,
      "file_pos": 2
    },
    {
      "position": 6,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex.equals_PandasIndex.__getitem__.1.1",
      "distance": 0.9977653622627258,
      "file_path": "xarray/core/indexes.py",
      "start_line": 430,
      "end_line": 484,
      "tokens": 454,
      "context_length": 2212,
      "file_pos": 2
    },
    {
      "position": 7,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_1_IndexVars.1",
      "distance": 1.0001978874206543,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1,
      "end_line": 31,
      "tokens": 155,
      "context_length": 2367,
      "file_pos": 2
    },
    {
      "position": 8,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.join_PandasMultiIndex.join.3.1",
      "distance": 1.0033931732177734,
      "file_path": "xarray/core/indexes.py",
      "start_line": 918,
      "end_line": 934,
      "tokens": 147,
      "context_length": 2514,
      "file_pos": 2
    },
    {
      "position": 9,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes.copy_indexes_Indexes.__repr__.1.1",
      "distance": 1.0076942443847656,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1195,
      "end_line": 1225,
      "tokens": 251,
      "context_length": 2765,
      "file_pos": 2
    },
    {
      "position": 10,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex.from_variables_PandasIndex.from_variables.15.1",
      "distance": 1.014420986175537,
      "file_path": "xarray/core/indexes.py",
      "start_line": 249,
      "end_line": 282,
      "tokens": 287,
      "context_length": 3052,
      "file_pos": 2
    },
    {
      "position": 11,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.rename_PandasMultiIndex.rename.7.1",
      "distance": 1.0193325281143188,
      "file_path": "xarray/core/indexes.py",
      "start_line": 936,
      "end_line": 950,
      "tokens": 157,
      "context_length": 3209,
      "file_pos": 2
    },
    {
      "position": 12,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.concat_PandasMultiIndex.concat.3.1",
      "distance": 1.0257577896118164,
      "file_path": "xarray/core/indexes.py",
      "start_line": 586,
      "end_line": 604,
      "tokens": 156,
      "context_length": 3365,
      "file_pos": 2
    },
    {
      "position": 13,
      "id": "/tmp/repos/xarray/xarray/core/alignment.py_Aligner.assert_no_index_conflict_Aligner.assert_no_index_conflict.6.2.2",
      "distance": 1.0287792682647705,
      "file_path": "xarray/core/alignment.py",
      "start_line": 287,
      "end_line": 326,
      "tokens": 416,
      "context_length": 3781
    },
    {
      "position": 14,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.sel_PandasMultiIndex.sel.7.6.3.6.4.2.coords.indexer.1",
      "distance": 1.0292398929595947,
      "file_path": "xarray/core/indexes.py",
      "start_line": 771,
      "end_line": 875,
      "tokens": 898,
      "context_length": 4679,
      "file_pos": 3
    },
    {
      "position": 15,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_HugeAxisSmallSliceIndexing_",
      "distance": 1.036649465560913,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 133,
      "end_line": 150,
      "tokens": 145,
      "context_length": 4824
    },
    {
      "position": 16,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.from_variables_PandasMultiIndex.from_variables.7.1",
      "distance": 1.0446233749389648,
      "file_path": "xarray/core/indexes.py",
      "start_line": 572,
      "end_line": 584,
      "tokens": 122,
      "context_length": 4946,
      "file_pos": 4
    },
    {
      "position": 17,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex.sel_PandasIndex.sel.7.1",
      "distance": 1.0449864864349365,
      "file_path": "xarray/core/indexes.py",
      "start_line": 364,
      "end_line": 428,
      "tokens": 525,
      "context_length": 5471,
      "file_pos": 4
    },
    {
      "position": 18,
      "id": "/tmp/repos/xarray/conftest.py_1_",
      "distance": 1.0545461177825928,
      "file_path": "conftest.py",
      "start_line": 1,
      "end_line": 42,
      "tokens": 278,
      "context_length": 5749
    },
    {
      "position": 19,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex._concat_indexes_PandasIndex._concat_indexes.3.1",
      "distance": 1.059875726699829,
      "file_path": "xarray/core/indexes.py",
      "start_line": 284,
      "end_line": 304,
      "tokens": 178,
      "context_length": 5927,
      "file_pos": 5
    },
    {
      "position": 20,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.create_variables_PandasMultiIndex.create_variables.5.1",
      "distance": 1.061969518661499,
      "file_path": "xarray/core/indexes.py",
      "start_line": 735,
      "end_line": 769,
      "tokens": 204,
      "context_length": 6131,
      "file_pos": 5
    },
    {
      "position": 21,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py__apply_indexes__apply_indexes.4.1",
      "distance": 1.0620002746582031,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1329,
      "end_line": 1350,
      "tokens": 222,
      "context_length": 6353,
      "file_pos": 5
    },
    {
      "position": 22,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Index_Index.__getitem__.1",
      "distance": 1.0665531158447266,
      "file_path": "xarray/core/indexes.py",
      "start_line": 34,
      "end_line": 124,
      "tokens": 662,
      "context_length": 7015,
      "file_pos": 5
    },
    {
      "position": 23,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_IndexingDask_BooleanIndexing.time_indexing.1",
      "distance": 1.0744529962539673,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 113,
      "end_line": 130,
      "tokens": 147,
      "context_length": 7162
    },
    {
      "position": 24,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_isel_indexes_roll_indexes.1.1",
      "distance": 1.084665060043335,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1353,
      "end_line": 1364,
      "tokens": 103,
      "context_length": 7265,
      "file_pos": 5
    },
    {
      "position": 25,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_Indexing_Indexing.time_indexing_vectorized.1",
      "distance": 1.093488335609436,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 79,
      "end_line": 90,
      "tokens": 118,
      "context_length": 7383
    },
    {
      "position": 26,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_as_scalar_get_indexer_nd.5.1",
      "distance": 1.100939393043518,
      "file_path": "xarray/core/indexes.py",
      "start_line": 202,
      "end_line": 214,
      "tokens": 127,
      "context_length": 7510,
      "file_pos": 5
    },
    {
      "position": 27,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py__unique_and_monotonic__apply_loffset.grouper.loffset.1",
      "distance": 1.101592779159546,
      "file_path": "xarray/core/groupby.py",
      "start_line": 249,
      "end_line": 279,
      "tokens": 194,
      "context_length": 7704
    },
    {
      "position": 28,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py_unique_value_groups_unique_value_groups.6.1",
      "distance": 1.1070669889450073,
      "file_path": "xarray/core/groupby.py",
      "start_line": 67,
      "end_line": 95,
      "tokens": 236,
      "context_length": 7940
    },
    {
      "position": 29,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex.concat_PandasIndex.create_variables.8.1",
      "distance": 1.1175488233566284,
      "file_path": "xarray/core/indexes.py",
      "start_line": 306,
      "end_line": 341,
      "tokens": 263,
      "context_length": 8203,
      "file_pos": 6
    },
    {
      "position": 30,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_indexes_all_equal_indexes_all_equal.6.1",
      "distance": 1.1193528175354004,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1296,
      "end_line": 1326,
      "tokens": 216,
      "context_length": 8419,
      "file_pos": 6
    },
    {
      "position": 31,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_indexes_equal_indexes_equal.7.1",
      "distance": 1.1198590993881226,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1257,
      "end_line": 1293,
      "tokens": 210,
      "context_length": 8629,
      "file_pos": 6
    },
    {
      "position": 32,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_PandasIndexingAdapter.__getitem___PandasIndexingAdapter.__getitem__.5.2.1.1",
      "distance": 1.1270967721939087,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1463,
      "end_line": 1486,
      "tokens": 192,
      "context_length": 8821
    },
    {
      "position": 33,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/pandas.py_np_",
      "distance": 1.1293143033981323,
      "file_path": "asv_bench/benchmarks/pandas.py",
      "start_line": 1,
      "end_line": 27,
      "tokens": 167,
      "context_length": 8988
    },
    {
      "position": 34,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_remove_unused_levels_categories_remove_unused_levels_categories.3.1",
      "distance": 1.1303305625915527,
      "file_path": "xarray/core/indexes.py",
      "start_line": 510,
      "end_line": 534,
      "tokens": 264,
      "context_length": 9252,
      "file_pos": 7
    },
    {
      "position": 35,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_1_21.Variable",
      "distance": 1.1318252086639404,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1,
      "end_line": 33,
      "tokens": 201,
      "context_length": 9453
    },
    {
      "position": 36,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasIndex_PandasIndex._replace.3.1",
      "distance": 1.1406397819519043,
      "file_path": "xarray/core/indexes.py",
      "start_line": 217,
      "end_line": 247,
      "tokens": 236,
      "context_length": 9689,
      "file_pos": 7
    },
    {
      "position": 37,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py__sanitize_slice_element__query_slice.4.1",
      "distance": 1.1416807174682617,
      "file_path": "xarray/core/indexes.py",
      "start_line": 127,
      "end_line": 163,
      "tokens": 269,
      "context_length": 9958,
      "file_pos": 7
    },
    {
      "position": 38,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.keep_levels_PandasMultiIndex.reorder_levels.4.1",
      "distance": 1.1427326202392578,
      "file_path": "xarray/core/indexes.py",
      "start_line": 705,
      "end_line": 733,
      "tokens": 253,
      "context_length": 10211,
      "file_pos": 7
    },
    {
      "position": 39,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_os_vectorized_assignment_values.1",
      "distance": 1.143478512763977,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 1,
      "end_line": 59,
      "tokens": 738,
      "context_length": 10949
    },
    {
      "position": 40,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_PandasMultiIndexingAdapter_",
      "distance": 1.1439247131347656,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1506,
      "end_line": 1584,
      "tokens": 599,
      "context_length": 11548
    },
    {
      "position": 41,
      "id": "/tmp/repos/xarray/xarray/testing.py__assert_indexes_invariants_checks__assert_indexes_invariants_checks.7.3",
      "distance": 1.1457768678665161,
      "file_path": "xarray/testing.py",
      "start_line": 256,
      "end_line": 304,
      "tokens": 484,
      "context_length": 12032
    },
    {
      "position": 42,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_PandasIndexingAdapter._convert_scalar_PandasIndexingAdapter._convert_scalar.4.1",
      "distance": 1.1490415334701538,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1443,
      "end_line": 1461,
      "tokens": 225,
      "context_length": 12257
    },
    {
      "position": 43,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex_PandasMultiIndex._replace.4.1",
      "distance": 1.1541224718093872,
      "file_path": "xarray/core/indexes.py",
      "start_line": 537,
      "end_line": 570,
      "tokens": 281,
      "context_length": 12538,
      "file_pos": 8
    },
    {
      "position": 44,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes.get_all_dims_Indexes.get_all_dims.3.1",
      "distance": 1.155303955078125,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1141,
      "end_line": 1162,
      "tokens": 164,
      "context_length": 12702,
      "file_pos": 8
    },
    {
      "position": 45,
      "id": "/tmp/repos/xarray/xarray/testing.py__assert_dataset_invariants__assert_dataset_invariants.16",
      "distance": 1.1597988605499268,
      "file_path": "xarray/testing.py",
      "start_line": 345,
      "end_line": 381,
      "tokens": 430,
      "context_length": 13132
    },
    {
      "position": 46,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_assert_no_index_corrupted_",
      "distance": 1.1600362062454224,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1391,
      "end_line": 1409,
      "tokens": 189,
      "context_length": 13321,
      "file_pos": 8
    },
    {
      "position": 47,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_Indexes.get_all_coords_Indexes.get_all_coords.5.1",
      "distance": 1.1653685569763184,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1110,
      "end_line": 1139,
      "tokens": 242,
      "context_length": 13563,
      "file_pos": 8
    },
    {
      "position": 48,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py__check_dim_compat__check_dim_compat.5.1",
      "distance": 1.1668840646743774,
      "file_path": "xarray/core/indexes.py",
      "start_line": 487,
      "end_line": 507,
      "tokens": 217,
      "context_length": 13780,
      "file_pos": 8
    },
    {
      "position": 49,
      "id": "/tmp/repos/xarray/xarray/core/dataset.py__LocIndexer_Dataset",
      "distance": 1.169743537902832,
      "file_path": "xarray/core/dataset.py",
      "start_line": 406,
      "end_line": 8884,
      "tokens": 196,
      "context_length": 13976
    },
    {
      "position": 50,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_DaskIndexingAdapter.__setitem___DaskIndexingAdapter.transpose.1.1",
      "distance": 1.17058527469635,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1383,
      "end_line": 1409,
      "tokens": 258,
      "context_length": 14234
    },
    {
      "position": 51,
      "id": "/tmp/repos/xarray/xarray/core/utils.py_safe_cast_to_index_safe_cast_to_index.3.1",
      "distance": 1.1777311563491821,
      "file_path": "xarray/core/utils.py",
      "start_line": 115,
      "end_line": 140,
      "tokens": 232,
      "context_length": 14466
    },
    {
      "position": 52,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py_GroupBy._get_index_and_items_GroupBy._get_index_and_items.6.1",
      "distance": 1.1778135299682617,
      "file_path": "xarray/core/groupby.py",
      "start_line": 539,
      "end_line": 551,
      "tokens": 133,
      "context_length": 14599
    },
    {
      "position": 53,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_Assignment_Assignment.time_assignment_vectorized.3",
      "distance": 1.1785186529159546,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 93,
      "end_line": 110,
      "tokens": 201,
      "context_length": 14800
    },
    {
      "position": 54,
      "id": "/tmp/repos/xarray/xarray/coding/cftimeindex.py_CFTimeIndex.21_CFTimeIndex.contains.2.1",
      "distance": 1.179858684539795,
      "file_path": "xarray/coding/cftimeindex.py",
      "start_line": 487,
      "end_line": 513,
      "tokens": 226,
      "context_length": 15026
    },
    {
      "position": 55,
      "id": "/tmp/repos/xarray/xarray/core/missing.py_1_19.Dataset",
      "distance": 1.1810685396194458,
      "file_path": "xarray/core/missing.py",
      "start_line": 1,
      "end_line": 25,
      "tokens": 184,
      "context_length": 15210
    },
    {
      "position": 56,
      "id": "/tmp/repos/xarray/xarray/core/types.py_1_ReindexMethodOptions.1",
      "distance": 1.1816670894622803,
      "file_path": "xarray/core/types.py",
      "start_line": 1,
      "end_line": 79,
      "tokens": 771,
      "context_length": 15981
    },
    {
      "position": 57,
      "id": "/tmp/repos/xarray/xarray/core/nputils.py__advanced_indexer_subspaces__advanced_indexer_subspaces.9.1",
      "distance": 1.1844195127487183,
      "file_path": "xarray/core/nputils.py",
      "start_line": 96,
      "end_line": 115,
      "tokens": 212,
      "context_length": 16193
    },
    {
      "position": 58,
      "id": "/tmp/repos/xarray/xarray/core/utils.py_get_valid_numpy_dtype_maybe_coerce_to_str.4.1",
      "distance": 1.1844258308410645,
      "file_path": "xarray/core/utils.py",
      "start_line": 77,
      "end_line": 112,
      "tokens": 235,
      "context_length": 16428
    },
    {
      "position": 59,
      "id": "/tmp/repos/xarray/xarray/coding/frequencies.py__unique_deltas__maybe_add_count.2.4.1.1",
      "distance": 1.185641884803772,
      "file_path": "xarray/coding/frequencies.py",
      "start_line": 224,
      "end_line": 241,
      "tokens": 120,
      "context_length": 16548
    },
    {
      "position": 60,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_PandasIndexingAdapter.transpose_PandasIndexingAdapter.copy.array.2.1",
      "distance": 1.187450885772705,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1488,
      "end_line": 1503,
      "tokens": 205,
      "context_length": 16753
    },
    {
      "position": 61,
      "id": "/tmp/repos/xarray/xarray/core/common.py_DataWithCoords.get_index_DataWithCoords.assign_coords",
      "distance": 1.1875276565551758,
      "file_path": "xarray/core/common.py",
      "start_line": 453,
      "end_line": 606,
      "tokens": 192,
      "context_length": 16945
    },
    {
      "position": 62,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_LazilyIndexedArray.shape_LazilyOuterIndexedArray.1",
      "distance": 1.187598466873169,
      "file_path": "xarray/core/indexing.py",
      "start_line": 512,
      "end_line": 549,
      "tokens": 335,
      "context_length": 17280
    },
    {
      "position": 63,
      "id": "/tmp/repos/xarray/xarray/core/nputils.py_1_nanlast.4.1",
      "distance": 1.1916351318359375,
      "file_path": "xarray/core/nputils.py",
      "start_line": 1,
      "end_line": 37,
      "tokens": 264,
      "context_length": 17544
    },
    {
      "position": 64,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_map_index_queries_map_index_queries.14.1",
      "distance": 1.192199945449829,
      "file_path": "xarray/core/indexing.py",
      "start_line": 155,
      "end_line": 197,
      "tokens": 342,
      "context_length": 17886
    },
    {
      "position": 65,
      "id": "/tmp/repos/xarray/xarray/core/alignment.py_Aligner._need_reindex_Aligner._need_reindex.3.1",
      "distance": 1.193396806716919,
      "file_path": "xarray/core/alignment.py",
      "start_line": 328,
      "end_line": 340,
      "tokens": 160,
      "context_length": 18046
    },
    {
      "position": 66,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/reindexing.py_np_",
      "distance": 1.1967308521270752,
      "file_path": "asv_bench/benchmarks/reindexing.py",
      "start_line": 1,
      "end_line": 53,
      "tokens": 415,
      "context_length": 18461
    },
    {
      "position": 67,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/groupby.py_GroupBy.time_init_GroupBy.peakmem_groupby_binary_op_2d.1",
      "distance": 1.19673752784729,
      "file_path": "asv_bench/benchmarks/groupby.py",
      "start_line": 23,
      "end_line": 47,
      "tokens": 266,
      "context_length": 18727
    },
    {
      "position": 68,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_PandasMultiIndex.stack_PandasMultiIndex.unstack.4.1",
      "distance": 1.199491024017334,
      "file_path": "xarray/core/indexes.py",
      "start_line": 606,
      "end_line": 648,
      "tokens": 401,
      "context_length": 19128,
      "file_pos": 18
    },
    {
      "position": 69,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py_1_check_reduce_dims.1.2.1",
      "distance": 1.2047629356384277,
      "file_path": "xarray/core/groupby.py",
      "start_line": 1,
      "end_line": 64,
      "tokens": 387,
      "context_length": 19515
    },
    {
      "position": 70,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/indexing.py_Base_Base.setup.self.ds.1",
      "distance": 1.2061676979064941,
      "file_path": "asv_bench/benchmarks/indexing.py",
      "start_line": 62,
      "end_line": 76,
      "tokens": 151,
      "context_length": 19666
    },
    {
      "position": 71,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_as_indexable_as_indexable.8",
      "distance": 1.2064259052276611,
      "file_path": "xarray/core/indexing.py",
      "start_line": 666,
      "end_line": 685,
      "tokens": 157,
      "context_length": 19823
    },
    {
      "position": 72,
      "id": "/tmp/repos/xarray/xarray/coding/cftimeindex.py_CFTimeIndex.__add___CFTimeIndex.__rsub__.1.2.1",
      "distance": 1.2081917524337769,
      "file_path": "xarray/coding/cftimeindex.py",
      "start_line": 561,
      "end_line": 594,
      "tokens": 294,
      "context_length": 20117
    },
    {
      "position": 73,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/groupby.py_GroupByPandasDataFrame_GroupByPandasDataFrame.peakmem_groupby_binary_op_2d.1",
      "distance": 1.2084625959396362,
      "file_path": "asv_bench/benchmarks/groupby.py",
      "start_line": 63,
      "end_line": 78,
      "tokens": 120,
      "context_length": 20237
    },
    {
      "position": 74,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/groupby.py_np_GroupBy.setup.self.ds2d_mean.1",
      "distance": 1.2085373401641846,
      "file_path": "asv_bench/benchmarks/groupby.py",
      "start_line": 1,
      "end_line": 21,
      "tokens": 174,
      "context_length": 20411
    },
    {
      "position": 75,
      "id": "/tmp/repos/xarray/xarray/core/variable.py_IndexVariable.to_index_IndexVariable.to_index.7.1",
      "distance": 1.2085634469985962,
      "file_path": "xarray/core/variable.py",
      "start_line": 2894,
      "end_line": 2910,
      "tokens": 162,
      "context_length": 20573
    },
    {
      "position": 76,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/groupby.py_GroupByDask_GroupByDask.setup.self.ds2d_mean.1",
      "distance": 1.208787441253662,
      "file_path": "asv_bench/benchmarks/groupby.py",
      "start_line": 50,
      "end_line": 60,
      "tokens": 167,
      "context_length": 20740
    },
    {
      "position": 77,
      "id": "/tmp/repos/xarray/xarray/coding/times.py__infer_time_units_from_diff__infer_time_units_from_diff.3.1",
      "distance": 1.2089883089065552,
      "file_path": "xarray/coding/times.py",
      "start_line": 336,
      "end_line": 355,
      "tokens": 251,
      "context_length": 20991
    },
    {
      "position": 78,
      "id": "/tmp/repos/xarray/xarray/coding/cftimeindex.py_CFTimeIndex._get_string_slice_CFTimeIndex._get_nearest_indexer.9.1",
      "distance": 1.209463119506836,
      "file_path": "xarray/coding/cftimeindex.py",
      "start_line": 428,
      "end_line": 452,
      "tokens": 272,
      "context_length": 21263
    },
    {
      "position": 79,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_LazilyIndexedArray._updated_key_LazilyIndexedArray._updated_key.6.1",
      "distance": 1.2128849029541016,
      "file_path": "xarray/core/indexing.py",
      "start_line": 498,
      "end_line": 510,
      "tokens": 142,
      "context_length": 21405
    },
    {
      "position": 80,
      "id": "/tmp/repos/xarray/xarray/coding/cftimeindex.py_CFTimeIndex_CFTimeIndex.__new__.7.1",
      "distance": 1.2136166095733643,
      "file_path": "xarray/coding/cftimeindex.py",
      "start_line": 281,
      "end_line": 323,
      "tokens": 395,
      "context_length": 21800
    },
    {
      "position": 81,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py__ensure_1d__ensure_1d.DataArray",
      "distance": 1.2136971950531006,
      "file_path": "xarray/core/groupby.py",
      "start_line": 223,
      "end_line": 246,
      "tokens": 276,
      "context_length": 22076
    },
    {
      "position": 82,
      "id": "/tmp/repos/xarray/xarray/core/indexing.py_is_fancy_indexer_is_fancy_indexer.5.1",
      "distance": 1.2172735929489136,
      "file_path": "xarray/core/indexing.py",
      "start_line": 1214,
      "end_line": 1224,
      "tokens": 112,
      "context_length": 22188
    },
    {
      "position": 83,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py_filter_indexes_from_coords_filter_indexes_from_coords.6.1",
      "distance": 1.2179970741271973,
      "file_path": "xarray/core/indexes.py",
      "start_line": 1367,
      "end_line": 1388,
      "tokens": 159,
      "context_length": 22347,
      "file_pos": 20
    },
    {
      "position": 84,
      "id": "/tmp/repos/xarray/xarray/core/indexes.py__asarray_tuplesafe__is_nested_tuple.1.1",
      "distance": 1.2183010578155518,
      "file_path": "xarray/core/indexes.py",
      "start_line": 166,
      "end_line": 187,
      "tokens": 145,
      "context_length": 22492,
      "file_pos": 20
    },
    {
      "position": 85,
      "id": "/tmp/repos/xarray/xarray/core/coordinates.py_1__THIS_ARRAY.1",
      "distance": 1.220298171043396,
      "file_path": "xarray/core/coordinates.py",
      "start_line": 1,
      "end_line": 22,
      "tokens": 157,
      "context_length": 22649
    }
  ],
  "files": [
    {
      "file_path": "xarray/core/indexes.py",
      "position": 1,
      "tokens": 10615,
      "context_length": 10615
    },
    {
      "file_path": "xarray/core/indexing.py",
      "position": 2,
      "tokens": 12612,
      "context_length": 23227
    },
    {
      "file_path": "xarray/core/alignment.py",
      "position": 3,
      "tokens": 8512,
      "context_length": 31739
    },
    {
      "file_path": "asv_bench/benchmarks/indexing.py",
      "position": 4,
      "tokens": 1501,
      "context_length": 33240
    },
    {
      "file_path": "conftest.py",
      "position": 5,
      "tokens": 278,
      "context_length": 33518
    },
    {
      "file_path": "xarray/core/groupby.py",
      "position": 6,
      "tokens": 10930,
      "context_length": 44448
    },
    {
      "file_path": "asv_bench/benchmarks/pandas.py",
      "position": 7,
      "tokens": 167,
      "context_length": 44615
    },
    {
      "file_path": "xarray/testing.py",
      "position": 8,
      "tokens": 3502,
      "context_length": 48117
    },
    {
      "file_path": "xarray/core/dataset.py",
      "position": 9,
      "tokens": 76316,
      "context_length": 124433
    },
    {
      "file_path": "xarray/core/utils.py",
      "position": 10,
      "tokens": 6654,
      "context_length": 131087
    },
    {
      "file_path": "xarray/coding/cftimeindex.py",
      "position": 11,
      "tokens": 6955,
      "context_length": 138042
    },
    {
      "file_path": "xarray/core/missing.py",
      "position": 12,
      "tokens": 6247,
      "context_length": 144289
    },
    {
      "file_path": "xarray/core/types.py",
      "position": 13,
      "tokens": 985,
      "context_length": 145274
    },
    {
      "file_path": "xarray/core/nputils.py",
      "position": 14,
      "tokens": 1869,
      "context_length": 147143
    },
    {
      "file_path": "xarray/coding/frequencies.py",
      "position": 15,
      "tokens": 2174,
      "context_length": 149317
    },
    {
      "file_path": "xarray/core/common.py",
      "position": 16,
      "tokens": 14906,
      "context_length": 164223
    },
    {
      "file_path": "asv_bench/benchmarks/reindexing.py",
      "position": 17,
      "tokens": 415,
      "context_length": 164638
    },
    {
      "file_path": "asv_bench/benchmarks/groupby.py",
      "position": 18,
      "tokens": 1333,
      "context_length": 165971
    },
    {
      "file_path": "xarray/core/variable.py",
      "position": 19,
      "tokens": 24507,
      "context_length": 190478
    },
    {
      "file_path": "xarray/coding/times.py",
      "position": 20,
      "tokens": 6054,
      "context_length": 196532
    },
    {
      "file_path": "xarray/core/coordinates.py",
      "position": 21,
      "tokens": 3478,
      "context_length": 200010
    }
  ]
}