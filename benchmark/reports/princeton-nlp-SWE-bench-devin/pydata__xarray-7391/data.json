{
  "instance_id": "pydata__xarray-7391",
  "model_patch": "diff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\nindex 2a45a8f8..c7f6f8cd 100644\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -6581,7 +6581,9 @@ class Dataset(\n         attrs = self._attrs if keep_attrs else None\n         return self._replace_with_new_dims(variables, attrs=attrs)\n \n-    def _binary_op(self, other, f, reflexive=False, join=None) -> Dataset:\n+    def _binary_op(self, other, f, reflexive=False, join=None, keep_attrs=None) -> Dataset:\n+        if keep_attrs is None:\n+            keep_attrs = _get_keep_attrs(default=False)\n         from xarray.core.dataarray import DataArray\n         from xarray.core.groupby import GroupBy\n \n@@ -6591,7 +6593,9 @@ class Dataset(\n         if isinstance(other, (DataArray, Dataset)):\n             self, other = align(self, other, join=align_type, copy=False)  # type: ignore[assignment]\n         g = f if not reflexive else lambda x, y: f(y, x)\n-        ds = self._calculate_binary_op(g, other, join=align_type)\n+        ds = self._calculate_binary_op(g, other, join=align_type, keep_attrs=keep_attrs)\n+        if keep_attrs:\n+            ds._copy_attrs_from(self)\n         return ds\n \n     def _inplace_binary_op(self: T_Dataset, other, f) -> T_Dataset:\n@@ -6619,7 +6623,7 @@ class Dataset(\n         return self\n \n     def _calculate_binary_op(\n-        self, f, other, join=\"inner\", inplace: bool = False\n+        self, f, other, join=\"inner\", inplace: bool = False, keep_attrs: bool = False\n     ) -> Dataset:\n         def apply_over_both(lhs_data_vars, rhs_data_vars, lhs_vars, rhs_vars):\n             if inplace and set(lhs_data_vars) != set(rhs_data_vars):\n@@ -6646,7 +6650,7 @@ class Dataset(\n             new_data_vars = apply_over_both(\n                 self.data_vars, other, self.data_vars, other\n             )\n-            return type(self)(new_data_vars)\n+            return type(self)(new_data_vars, attrs=self._attrs if keep_attrs else None)\n \n         other_coords: Coordinates | None = getattr(other, \"coords\", None)\n         ds = self.coords.merge(other_coords)\n@@ -6660,6 +6664,8 @@ class Dataset(\n             new_vars = {k: f(self.variables[k], other_variable) for k in self.data_vars}\n         ds._variables.update(new_vars)\n         ds._dims = calculate_dimensions(ds._variables)\n+        if keep_attrs:\n+            ds._attrs = self._attrs\n         return ds\n \n     def _copy_attrs_from(self, other):\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "xarray/core/dataset.py"
  ],
  "repo": "pydata/xarray",
  "base_commit": "f128f248f87fe0442c9b213c2772ea90f91d168b",
  "patch": "diff --git a/xarray/core/dataset.py b/xarray/core/dataset.py\n--- a/xarray/core/dataset.py\n+++ b/xarray/core/dataset.py\n@@ -6592,6 +6592,9 @@ def _binary_op(self, other, f, reflexive=False, join=None) -> Dataset:\n             self, other = align(self, other, join=align_type, copy=False)  # type: ignore[assignment]\n         g = f if not reflexive else lambda x, y: f(y, x)\n         ds = self._calculate_binary_op(g, other, join=align_type)\n+        keep_attrs = _get_keep_attrs(default=False)\n+        if keep_attrs:\n+            ds.attrs = self.attrs\n         return ds\n \n     def _inplace_binary_op(self: T_Dataset, other, f) -> T_Dataset:\n",
  "test_patch": "diff --git a/xarray/tests/test_dataset.py b/xarray/tests/test_dataset.py\n--- a/xarray/tests/test_dataset.py\n+++ b/xarray/tests/test_dataset.py\n@@ -5849,6 +5849,21 @@ def test_binary_op_join_setting(self) -> None:\n             actual = ds1 + ds2\n             assert_equal(actual, expected)\n \n+    @pytest.mark.parametrize(\n+        [\"keep_attrs\", \"expected\"],\n+        (\n+            pytest.param(False, {}, id=\"False\"),\n+            pytest.param(True, {\"foo\": \"a\", \"bar\": \"b\"}, id=\"True\"),\n+        ),\n+    )\n+    def test_binary_ops_keep_attrs(self, keep_attrs, expected) -> None:\n+        ds1 = xr.Dataset({\"a\": 1}, attrs={\"foo\": \"a\", \"bar\": \"b\"})\n+        ds2 = xr.Dataset({\"a\": 1}, attrs={\"foo\": \"a\", \"baz\": \"c\"})\n+        with xr.set_options(keep_attrs=keep_attrs):\n+            ds_result = ds1 + ds2\n+\n+        assert ds_result.attrs == expected\n+\n     def test_full_like(self) -> None:\n         # For more thorough tests, see test_variable.py\n         # Note: testing data_vars with mismatched dtypes\n",
  "problem_statement": "`Dataset` binary ops ignore `keep_attrs` option\n### What is your issue?\r\n\r\nWhen doing arithmetic operations on two Dataset operands,\r\nthe `keep_attrs=True` option is ignored and therefore attributes  not kept.\r\n\r\n\r\nMinimal example:\r\n\r\n```python\r\nimport xarray as xr\r\n\r\nds1 = xr.Dataset(\r\n    data_vars={\"a\": 1, \"b\": 1},\r\n    attrs={'my_attr': 'value'}\r\n)\r\nds2 = ds1.copy(deep=True)\r\n\r\nwith xr.set_options(keep_attrs=True):\r\n    print(ds1 + ds2)\r\n```\r\nThis is not true for DataArrays/Variables which do take `keep_attrs` into account.\r\n\r\n### Proposed fix/improvement\r\nDatasets to behave the same as DataArray/Variables, and keep attributes during binary operations\r\nwhen `keep_attrs=True` option is set. \r\n\r\nPR is inbound.\r\n\n",
  "hints_text": "",
  "created_at": "2022-12-19T20:42:20Z",
  "version": "2022.09",
  "FAIL_TO_PASS": "[\"xarray/tests/test_dataset.py::TestDataset::test_binary_ops_keep_attrs[True]\"]",
  "PASS_TO_PASS": "[\"xarray/tests/test_dataset.py::TestDataset::test_align\", \"xarray/tests/test_dataset.py::TestDataset::test_align_exact\", \"xarray/tests/test_dataset.py::TestDataset::test_align_exclude\", \"xarray/tests/test_dataset.py::TestDataset::test_align_fill_value[2.0]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_fill_value[2]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_fill_value[fill_value0]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_fill_value[fill_value3]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_index_var_attrs[left]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_index_var_attrs[override]\", \"xarray/tests/test_dataset.py::TestDataset::test_align_indexes\", \"xarray/tests/test_dataset.py::TestDataset::test_align_nocopy\", \"xarray/tests/test_dataset.py::TestDataset::test_align_non_unique\", \"xarray/tests/test_dataset.py::TestDataset::test_align_override\", \"xarray/tests/test_dataset.py::TestDataset::test_align_str_dtype\", \"xarray/tests/test_dataset.py::TestDataset::test_apply_pending_deprecated_map\", \"xarray/tests/test_dataset.py::TestDataset::test_asarray\", \"xarray/tests/test_dataset.py::TestDataset::test_assign\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_all_multiindex_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_coords_custom_index_side_effect\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_coords_existing_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_assign_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_astype_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_attr_access\", \"xarray/tests/test_dataset.py::TestDataset::test_attribute_access\", \"xarray/tests/test_dataset.py::TestDataset::test_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_binary_op_join_setting\", \"xarray/tests/test_dataset.py::TestDataset::test_binary_op_propagate_indexes\", \"xarray/tests/test_dataset.py::TestDataset::test_binary_ops_keep_attrs[False]\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_equals\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_exclude\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_like\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_misaligned\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_multi_index\", \"xarray/tests/test_dataset.py::TestDataset::test_broadcast_nocopy\", \"xarray/tests/test_dataset.py::TestDataset::test_categorical_index\", \"xarray/tests/test_dataset.py::TestDataset::test_categorical_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_categorical_reindex\", \"xarray/tests/test_dataset.py::TestDataset::test_chunks_does_not_load_data\", \"xarray/tests/test_dataset.py::TestDataset::test_combine_first\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_0d\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_1d\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_auto_align\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_compat\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_invalid_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_pandas_sequence\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_pandas_single\", \"xarray/tests/test_dataset.py::TestDataset::test_constructor_with_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_convert_dataframe_with_many_types_and_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_merge\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_merge_mismatched_shape\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_modify\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_properties\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_set\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_setitem_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_setitem_with_new_dimension\", \"xarray/tests/test_dataset.py::TestDataset::test_coords_to_dataset\", \"xarray/tests/test_dataset.py::TestDataset::test_copy\", \"xarray/tests/test_dataset.py::TestDataset::test_copy_with_data\", \"xarray/tests/test_dataset.py::TestDataset::test_copy_with_data_errors\", \"xarray/tests/test_dataset.py::TestDataset::test_count\", \"xarray/tests/test_dataset.py::TestDataset::test_data_vars_properties\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_array_math\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_dataset_math\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_exception_label_str\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_exception_n_neg\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_n1\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_n1_label\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_n1_simple\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_diff_n2\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_ellipsis_transpose_different_ordered_vars\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_math_auto_align\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_math_errors\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_number_math\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_retains_period_index_on_transpose\", \"xarray/tests/test_dataset.py::TestDataset::test_dataset_transpose\", \"xarray/tests/test_dataset.py::TestDataset::test_delitem\", \"xarray/tests/test_dataset.py::TestDataset::test_delitem_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_index_labels\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_indexes\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_labels_by_keyword\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_labels_by_position\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_drop_variables\", \"xarray/tests/test_dataset.py::TestDataset::test_dropna\", \"xarray/tests/test_dataset.py::TestDataset::test_equals_and_identical\", \"xarray/tests/test_dataset.py::TestDataset::test_equals_failures\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_error\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_existing_scalar_coord\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_int\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_kwargs_python36plus\", \"xarray/tests/test_dataset.py::TestDataset::test_expand_dims_mixed_int_and_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_fillna\", \"xarray/tests/test_dataset.py::TestDataset::test_filter_by_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_from_dataframe_categorical\", \"xarray/tests/test_dataset.py::TestDataset::test_from_dataframe_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_from_dataframe_non_unique_columns\", \"xarray/tests/test_dataset.py::TestDataset::test_from_dataframe_unsorted_levels\", \"xarray/tests/test_dataset.py::TestDataset::test_full_like\", \"xarray/tests/test_dataset.py::TestDataset::test_get_index\", \"xarray/tests/test_dataset.py::TestDataset::test_getitem\", \"xarray/tests/test_dataset.py::TestDataset::test_getitem_hashable\", \"xarray/tests/test_dataset.py::TestDataset::test_getitem_multiple_dtype\", \"xarray/tests/test_dataset.py::TestDataset::test_head\", \"xarray/tests/test_dataset.py::TestDataset::test_info\", \"xarray/tests/test_dataset.py::TestDataset::test_ipython_key_completion\", \"xarray/tests/test_dataset.py::TestDataset::test_isel\", \"xarray/tests/test_dataset.py::TestDataset::test_isel_dataarray\", \"xarray/tests/test_dataset.py::TestDataset::test_isel_drop\", \"xarray/tests/test_dataset.py::TestDataset::test_isel_expand_dims_roundtrip\", \"xarray/tests/test_dataset.py::TestDataset::test_isel_fancy\", \"xarray/tests/test_dataset.py::TestDataset::test_isel_fancy_convert_index_variable\", \"xarray/tests/test_dataset.py::TestDataset::test_lazy_load\", \"xarray/tests/test_dataset.py::TestDataset::test_loc\", \"xarray/tests/test_dataset.py::TestDataset::test_map\", \"xarray/tests/test_dataset.py::TestDataset::test_mean_uint_dtype\", \"xarray/tests/test_dataset.py::TestDataset::test_merge_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_modify_inplace\", \"xarray/tests/test_dataset.py::TestDataset::test_pad\", \"xarray/tests/test_dataset.py::TestDataset::test_pad_keep_attrs[False]\", \"xarray/tests/test_dataset.py::TestDataset::test_pad_keep_attrs[True]\", \"xarray/tests/test_dataset.py::TestDataset::test_pad_keep_attrs[default]\", \"xarray/tests/test_dataset.py::TestDataset::test_pickle\", \"xarray/tests/test_dataset.py::TestDataset::test_polyfit_output\", \"xarray/tests/test_dataset.py::TestDataset::test_polyfit_warnings\", \"xarray/tests/test_dataset.py::TestDataset::test_propagate_attrs[<lambda>0]\", \"xarray/tests/test_dataset.py::TestDataset::test_propagate_attrs[<lambda>1]\", \"xarray/tests/test_dataset.py::TestDataset::test_propagate_attrs[abs]\", \"xarray/tests/test_dataset.py::TestDataset::test_propagate_attrs[absolute]\", \"xarray/tests/test_dataset.py::TestDataset::test_properties\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[0.25-False]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[0.25-None]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[0.25-True]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q1-False]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q1-None]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q1-True]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q2-False]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q2-None]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile[q2-True]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_interpolation_deprecated[lower]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_interpolation_deprecated[midpoint]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_method[lower]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_method[midpoint]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_skipna[False]\", \"xarray/tests/test_dataset.py::TestDataset::test_quantile_skipna[True]\", \"xarray/tests/test_dataset.py::TestDataset::test_query[numpy-None-pandas]\", \"xarray/tests/test_dataset.py::TestDataset::test_query[numpy-None-python]\", \"xarray/tests/test_dataset.py::TestDataset::test_query[numpy-python-pandas]\", \"xarray/tests/test_dataset.py::TestDataset::test_query[numpy-python-python]\", \"xarray/tests/test_dataset.py::TestDataset::test_rank_use_bottleneck\", \"xarray/tests/test_dataset.py::TestDataset::test_real_and_imag\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_argmin\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_bad_dim\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumprod-dim1-expected0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumprod-dim2-expected1]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumprod-dim3-expected2]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumprod-time-expected3]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumsum-dim1-expected0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumsum-dim2-expected1]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumsum-dim3-expected2]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_cumsum_test_dims[cumsum-time-expected3]\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_dtypes\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_keep_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_keepdims\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_no_axis\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_non_numeric\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_only_one_axis\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_scalars\", \"xarray/tests/test_dataset.py::TestDataset::test_reduce_strings\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_attrs_encoding\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_fill_value[2.0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_fill_value[2]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_fill_value[fill_value0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_fill_value[fill_value3]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_like\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_like_fill_value[2.0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_like_fill_value[2]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_like_fill_value[fill_value0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_like_fill_value[fill_value3]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_method\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_str_dtype[bytes]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_str_dtype[str]\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_variables_copied\", \"xarray/tests/test_dataset.py::TestDataset::test_reindex_warning\", \"xarray/tests/test_dataset.py::TestDataset::test_rename\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_dimension_coord\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_dimension_coord_warnings\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_does_not_change_DatetimeIndex_type\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_old_name\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_perserve_attrs_encoding\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_same_name\", \"xarray/tests/test_dataset.py::TestDataset::test_rename_vars\", \"xarray/tests/test_dataset.py::TestDataset::test_reorder_levels\", \"xarray/tests/test_dataset.py::TestDataset::test_repr\", \"xarray/tests/test_dataset.py::TestDataset::test_repr_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_repr_nep18\", \"xarray/tests/test_dataset.py::TestDataset::test_repr_period_index\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[arg4-False-dropped4-converted4-renamed4]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[arg5-True-dropped5-converted5-renamed5]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[arg6-False-dropped6-converted6-renamed6]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[arg7-True-dropped7-converted7-renamed7]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[foo-False-dropped0-converted0-renamed0]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[foo-True-dropped1-converted1-renamed1]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[x-False-dropped2-converted2-renamed2]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_convert[x-True-dropped3-converted3-renamed3]\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_drop_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_reset_index_keep_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_roll_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_roll_multidim\", \"xarray/tests/test_dataset.py::TestDataset::test_roll_no_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_sel\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_categorical\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_categorical_error\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_dataarray\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_dataarray_mindex\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_drop\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_drop_mindex\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_fancy\", \"xarray/tests/test_dataset.py::TestDataset::test_sel_method\", \"xarray/tests/test_dataset.py::TestDataset::test_selection_multiindex\", \"xarray/tests/test_dataset.py::TestDataset::test_set_index\", \"xarray/tests/test_dataset.py::TestDataset::test_set_index_deindexed_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_set_xindex\", \"xarray/tests/test_dataset.py::TestDataset::test_set_xindex_options\", \"xarray/tests/test_dataset.py::TestDataset::test_setattr_raises\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_align_new_indexes\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_auto_align\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_both_non_unique_index\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_dimension_override\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_original_non_unique_index\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_pandas\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_str_dtype[bytes]\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_str_dtype[str]\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_using_list\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_using_list_errors[var_list0-data0-Different\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_using_list_errors[var_list1-data1-Empty\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_using_list_errors[var_list2-data2-assign\", \"xarray/tests/test_dataset.py::TestDataset::test_setitem_with_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_shift[2.0]\", \"xarray/tests/test_dataset.py::TestDataset::test_shift[2]\", \"xarray/tests/test_dataset.py::TestDataset::test_shift[fill_value0]\", \"xarray/tests/test_dataset.py::TestDataset::test_shift[fill_value3]\", \"xarray/tests/test_dataset.py::TestDataset::test_slice_virtual_variable\", \"xarray/tests/test_dataset.py::TestDataset::test_sortby\", \"xarray/tests/test_dataset.py::TestDataset::test_squeeze\", \"xarray/tests/test_dataset.py::TestDataset::test_squeeze_drop\", \"xarray/tests/test_dataset.py::TestDataset::test_stack\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_create_index[False-expected_keys1]\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_create_index[None-expected_keys2]\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_create_index[True-expected_keys0]\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_multi_index\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_non_dim_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_unstack_fast\", \"xarray/tests/test_dataset.py::TestDataset::test_stack_unstack_slow\", \"xarray/tests/test_dataset.py::TestDataset::test_swap_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_tail\", \"xarray/tests/test_dataset.py::TestDataset::test_thin\", \"xarray/tests/test_dataset.py::TestDataset::test_time_season\", \"xarray/tests/test_dataset.py::TestDataset::test_to_and_from_dataframe\", \"xarray/tests/test_dataset.py::TestDataset::test_to_and_from_dict\", \"xarray/tests/test_dataset.py::TestDataset::test_to_and_from_dict_with_nan_nat\", \"xarray/tests/test_dataset.py::TestDataset::test_to_and_from_dict_with_time_dim\", \"xarray/tests/test_dataset.py::TestDataset::test_to_and_from_empty_dataframe\", \"xarray/tests/test_dataset.py::TestDataset::test_to_array\", \"xarray/tests/test_dataset.py::TestDataset::test_to_dict_with_numpy_attrs\", \"xarray/tests/test_dataset.py::TestDataset::test_to_pandas\", \"xarray/tests/test_dataset.py::TestDataset::test_to_stacked_array_dtype_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_to_stacked_array_invalid_sample_dims\", \"xarray/tests/test_dataset.py::TestDataset::test_to_stacked_array_name\", \"xarray/tests/test_dataset.py::TestDataset::test_to_stacked_array_to_unstacked_dataset\", \"xarray/tests/test_dataset.py::TestDataset::test_to_stacked_array_to_unstacked_dataset_different_dimension\", \"xarray/tests/test_dataset.py::TestDataset::test_unary_ops\", \"xarray/tests/test_dataset.py::TestDataset::test_unicode_data\", \"xarray/tests/test_dataset.py::TestDataset::test_unstack\", \"xarray/tests/test_dataset.py::TestDataset::test_unstack_errors\", \"xarray/tests/test_dataset.py::TestDataset::test_unstack_fill_value\", \"xarray/tests/test_dataset.py::TestDataset::test_update\", \"xarray/tests/test_dataset.py::TestDataset::test_update_auto_align\", \"xarray/tests/test_dataset.py::TestDataset::test_update_index\", \"xarray/tests/test_dataset.py::TestDataset::test_update_multiindex_level\", \"xarray/tests/test_dataset.py::TestDataset::test_update_overwrite_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_variable\", \"xarray/tests/test_dataset.py::TestDataset::test_variable_indexing\", \"xarray/tests/test_dataset.py::TestDataset::test_virtual_variable_same_name\", \"xarray/tests/test_dataset.py::TestDataset::test_virtual_variables_default_coords\", \"xarray/tests/test_dataset.py::TestDataset::test_virtual_variables_time\", \"xarray/tests/test_dataset.py::TestDataset::test_where\", \"xarray/tests/test_dataset.py::TestDataset::test_where_drop\", \"xarray/tests/test_dataset.py::TestDataset::test_where_drop_empty\", \"xarray/tests/test_dataset.py::TestDataset::test_where_drop_no_indexes\", \"xarray/tests/test_dataset.py::TestDataset::test_where_other\", \"xarray/tests/test_dataset.py::TestDropDuplicates::test_drop_duplicates_1d[False]\", \"xarray/tests/test_dataset.py::TestDropDuplicates::test_drop_duplicates_1d[first]\", \"xarray/tests/test_dataset.py::TestDropDuplicates::test_drop_duplicates_1d[last]\", \"xarray/tests/test_dataset.py::TestNumpyCoercion::test_from_numpy\", \"xarray/tests/test_dataset.py::test_clip[1-numpy]\", \"xarray/tests/test_dataset.py::test_constructor_raises_with_invalid_coords[unaligned_coords0]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords0]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords1]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords2]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords3]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords4]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords5]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords6]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords7]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords8]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords0-unaligned_coords9]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords0]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords1]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords2]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords3]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords4]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords5]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords6]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords7]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords8]\", \"xarray/tests/test_dataset.py::test_dataset_constructor_aligns_to_explicit_coords[coords1-unaligned_coords9]\", \"xarray/tests/test_dataset.py::test_deepcopy_obj_array\", \"xarray/tests/test_dataset.py::test_deepcopy_recursive\", \"xarray/tests/test_dataset.py::test_differentiate[1-False]\", \"xarray/tests/test_dataset.py::test_differentiate[1-True]\", \"xarray/tests/test_dataset.py::test_differentiate[2-False]\", \"xarray/tests/test_dataset.py::test_differentiate[2-True]\", \"xarray/tests/test_dataset.py::test_differentiate_datetime[False]\", \"xarray/tests/test_dataset.py::test_differentiate_datetime[True]\", \"xarray/tests/test_dataset.py::test_dir_expected_attrs[numpy-3]\", \"xarray/tests/test_dataset.py::test_dir_non_string[1-numpy]\", \"xarray/tests/test_dataset.py::test_dir_unicode[1-numpy]\", \"xarray/tests/test_dataset.py::test_error_message_on_set_supplied\", \"xarray/tests/test_dataset.py::test_integrate[False]\", \"xarray/tests/test_dataset.py::test_integrate[True]\", \"xarray/tests/test_dataset.py::test_isin[numpy-test_elements0]\", \"xarray/tests/test_dataset.py::test_isin[numpy-test_elements1]\", \"xarray/tests/test_dataset.py::test_isin[numpy-test_elements2]\", \"xarray/tests/test_dataset.py::test_isin_dataset\", \"xarray/tests/test_dataset.py::test_no_dict\", \"xarray/tests/test_dataset.py::test_raise_no_warning_assert_close[numpy-2]\", \"xarray/tests/test_dataset.py::test_raise_no_warning_for_nan_in_binary_ops\", \"xarray/tests/test_dataset.py::test_string_keys_typing\", \"xarray/tests/test_dataset.py::test_subclass_slots\", \"xarray/tests/test_dataset.py::test_transpose_error\", \"xarray/tests/test_dataset.py::test_trapz_datetime[np-False]\", \"xarray/tests/test_dataset.py::test_trapz_datetime[np-True]\", \"xarray/tests/test_dataset.py::test_weakref\"]",
  "environment_setup_commit": "087ebbb78668bdf5d2d41c3b2553e3f29ce75be1",
  "patch_files": [
    "xarray/core/dataset.py"
  ],
  "test_patch_files": [
    "xarray/tests/test_dataset.py"
  ],
  "patch_diff_details": {
    "xarray/core/dataset.py": {
      "diffs": [
        {
          "start_line_old": 6595,
          "end_line_old": 6595,
          "file_pos": 7,
          "file_context_length": 143221,
          "closest_snippet_id": "/tmp/repos/xarray/xarray/core/dataset.py_Dataset.1_Dataset.copy.2.1",
          "closest_snippet_line_distance": 5358
        }
      ]
    }
  },
  "vectors": 1328,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/xarray/xarray/core/arithmetic.py_VariableArithmetic_",
      "distance": 0.903916597366333,
      "file_path": "xarray/core/arithmetic.py",
      "start_line": 100,
      "end_line": 149,
      "tokens": 238,
      "context_length": 238
    },
    {
      "position": 2,
      "id": "/tmp/repos/xarray/xarray/core/rolling.py_DatasetRolling._dataset_implementation_DatasetRolling._dataset_implementation.6.1",
      "distance": 0.9482371211051941,
      "file_path": "xarray/core/rolling.py",
      "start_line": 651,
      "end_line": 667,
      "tokens": 166,
      "context_length": 404
    },
    {
      "position": 3,
      "id": "/tmp/repos/xarray/xarray/core/computation.py_where.2_where.11.1",
      "distance": 0.9597469568252563,
      "file_path": "xarray/core/computation.py",
      "start_line": 1862,
      "end_line": 1898,
      "tokens": 351,
      "context_length": 755
    },
    {
      "position": 4,
      "id": "/tmp/repos/xarray/xarray/core/variable.py_Variable._binary_op_Variable._binary_op.7.1",
      "distance": 0.9665255546569824,
      "file_path": "xarray/core/variable.py",
      "start_line": 2636,
      "end_line": 2650,
      "tokens": 173,
      "context_length": 928
    },
    {
      "position": 5,
      "id": "/tmp/repos/xarray/xarray/core/_typed_ops.py_DatasetGroupByOpsMixin_DatasetGroupByOpsMixin.__ge__.__doc__.1",
      "distance": 0.9788326621055603,
      "file_path": "xarray/core/_typed_ops.py",
      "start_line": 579,
      "end_line": 676,
      "tokens": 808,
      "context_length": 1736
    },
    {
      "position": 6,
      "id": "/tmp/repos/xarray/xarray/core/_typed_ops.py_DatasetOpsMixin.__iand___DatasetOpsMixin.conjugate.__doc__.1",
      "distance": 0.9944918155670166,
      "file_path": "xarray/core/_typed_ops.py",
      "start_line": 117,
      "end_line": 196,
      "tokens": 878,
      "context_length": 2614
    },
    {
      "position": 7,
      "id": "/tmp/repos/xarray/xarray/core/rolling.py_DatasetRolling._counts_DatasetRolling._numpy_or_bottleneck_reduce.1.1",
      "distance": 0.9971458911895752,
      "file_path": "xarray/core/rolling.py",
      "start_line": 699,
      "end_line": 721,
      "tokens": 156,
      "context_length": 2770
    },
    {
      "position": 8,
      "id": "/tmp/repos/xarray/xarray/core/ops.py_op_str_",
      "distance": 1.0009078979492188,
      "file_path": "xarray/core/ops.py",
      "start_line": 278,
      "end_line": 334,
      "tokens": 349,
      "context_length": 3119
    },
    {
      "position": 9,
      "id": "/tmp/repos/xarray/xarray/core/dataset.py_Dataset._copy_Dataset.__getitem___59.5",
      "distance": 1.0038129091262817,
      "file_path": "xarray/core/dataset.py",
      "start_line": 1239,
      "end_line": 1442,
      "tokens": 1693,
      "context_length": 4812,
      "file_pos": 7
    },
    {
      "position": 10,
      "id": "/tmp/repos/xarray/xarray/core/dataset.py_Dataset._reindex_Dataset.interp",
      "distance": 1.0051509141921997,
      "file_path": "xarray/core/dataset.py",
      "start_line": 3139,
      "end_line": 3440,
      "tokens": 289,
      "context_length": 5101,
      "file_pos": 7
    },
    {
      "position": 11,
      "id": "/tmp/repos/xarray/asv_bench/benchmarks/merge.py_np_DatasetAddVariable.time_merge_two_datasets.1",
      "distance": 1.0103402137756348,
      "file_path": "asv_bench/benchmarks/merge.py",
      "start_line": 1,
      "end_line": 26,
      "tokens": 179,
      "context_length": 5280
    },
    {
      "position": 12,
      "id": "/tmp/repos/xarray/xarray/core/dataset.py_Dataset.1_Dataset.copy.2.1",
      "distance": 1.0118740797042847,
      "file_path": "xarray/core/dataset.py",
      "start_line": 446,
      "end_line": 1237,
      "tokens": 6329,
      "context_length": 11609,
      "file_pos": 8
    },
    {
      "position": 13,
      "id": "/tmp/repos/xarray/xarray/core/_typed_ops.py_DatasetGroupByOpsMixin.__eq__.__doc___DatasetGroupByOpsMixin.__ror__.__doc__.1",
      "distance": 1.025085210800171,
      "file_path": "xarray/core/_typed_ops.py",
      "start_line": 677,
      "end_line": 688,
      "tokens": 177,
      "context_length": 11786
    },
    {
      "position": 14,
      "id": "/tmp/repos/xarray/xarray/core/common.py_ones_like_ones_like_43.1",
      "distance": 1.038695216178894,
      "file_path": "xarray/core/common.py",
      "start_line": 1686,
      "end_line": 1712,
      "tokens": 153,
      "context_length": 11939
    },
    {
      "position": 15,
      "id": "/tmp/repos/xarray/xarray/util/generate_ops.py_stub_required_binary_COPY_DOCSTRING.1",
      "distance": 1.0395376682281494,
      "file_path": "xarray/util/generate_ops.py",
      "start_line": 143,
      "end_line": 229,
      "tokens": 729,
      "context_length": 12668
    },
    {
      "position": 16,
      "id": "/tmp/repos/xarray/xarray/core/common.py_ImplementsDatasetReduce_ImplementsDatasetReduce._reduce_method.2.1",
      "distance": 1.0423921346664429,
      "file_path": "xarray/core/common.py",
      "start_line": 103,
      "end_line": 126,
      "tokens": 146,
      "context_length": 12814
    },
    {
      "position": 17,
      "id": "/tmp/repos/xarray/xarray/core/coordinates.py_DatasetCoordinates._update_coords_DatasetCoordinates._update_coords.self._data._indexes.1",
      "distance": 1.0425997972488403,
      "file_path": "xarray/core/coordinates.py",
      "start_line": 303,
      "end_line": 324,
      "tokens": 187,
      "context_length": 13001
    },
    {
      "position": 18,
      "id": "/tmp/repos/xarray/xarray/core/merge.py_dataset_merge_method_dataset_merge_method.7.1",
      "distance": 1.05600106716156,
      "file_path": "xarray/core/merge.py",
      "start_line": 1035,
      "end_line": 1078,
      "tokens": 321,
      "context_length": 13322
    },
    {
      "position": 19,
      "id": "/tmp/repos/xarray/xarray/core/merge.py_dataset_update_method_",
      "distance": 1.0611919164657593,
      "file_path": "xarray/core/merge.py",
      "start_line": 1081,
      "end_line": 1110,
      "tokens": 214,
      "context_length": 13536
    },
    {
      "position": 20,
      "id": "/tmp/repos/xarray/xarray/plot/accessor.py_DatasetPlotAccessor_DatasetPlotAccessor.__call__.1",
      "distance": 1.0623655319213867,
      "file_path": "xarray/plot/accessor.py",
      "start_line": 928,
      "end_line": 944,
      "tokens": 117,
      "context_length": 13653
    },
    {
      "position": 21,
      "id": "/tmp/repos/xarray/xarray/backends/common.py_AbstractWritableDataStore.set_attributes_AbstractWritableDataStore.set_variables.2.4",
      "distance": 1.0627299547195435,
      "file_path": "xarray/backends/common.py",
      "start_line": 274,
      "end_line": 312,
      "tokens": 255,
      "context_length": 13908
    },
    {
      "position": 22,
      "id": "/tmp/repos/xarray/xarray/core/variable.py_Variable._inplace_binary_op_Variable._to_numeric.3.1",
      "distance": 1.0630422830581665,
      "file_path": "xarray/core/variable.py",
      "start_line": 2652,
      "end_line": 2669,
      "tokens": 194,
      "context_length": 14102
    },
    {
      "position": 23,
      "id": "/tmp/repos/xarray/xarray/core/duck_array_ops.py_64__mean.1",
      "distance": 1.063460350036621,
      "file_path": "xarray/core/duck_array_ops.py",
      "start_line": 394,
      "end_line": 418,
      "tokens": 292,
      "context_length": 14394
    },
    {
      "position": 24,
      "id": "/tmp/repos/xarray/xarray/core/rolling.py_1__ROLLING_REDUCE_DOCSTRING_TEMPLATE.1",
      "distance": 1.063707947731018,
      "file_path": "xarray/core/rolling.py",
      "start_line": 1,
      "end_line": 56,
      "tokens": 328,
      "context_length": 14722
    },
    {
      "position": 25,
      "id": "/tmp/repos/xarray/xarray/core/merge.py_merge.1_merge.1",
      "distance": 1.065089464187622,
      "file_path": "xarray/core/merge.py",
      "start_line": 792,
      "end_line": 1010,
      "tokens": 2835,
      "context_length": 17557
    },
    {
      "position": 26,
      "id": "/tmp/repos/xarray/xarray/util/generate_ops.py_template_inplace_stub_required_unary.1",
      "distance": 1.0691618919372559,
      "file_path": "xarray/util/generate_ops.py",
      "start_line": 79,
      "end_line": 142,
      "tokens": 733,
      "context_length": 18290
    },
    {
      "position": 27,
      "id": "/tmp/repos/xarray/xarray/testing.py__assert_dataset_invariants__assert_dataset_invariants.16",
      "distance": 1.0702385902404785,
      "file_path": "xarray/testing.py",
      "start_line": 345,
      "end_line": 381,
      "tokens": 430,
      "context_length": 18720
    },
    {
      "position": 28,
      "id": "/tmp/repos/xarray/xarray/core/groupby.py_GroupBy._binary_op_GroupBy._binary_op.17.1",
      "distance": 1.0742733478546143,
      "file_path": "xarray/core/groupby.py",
      "start_line": 577,
      "end_line": 640,
      "tokens": 506,
      "context_length": 19226
    }
  ],
  "files": [
    {
      "file_path": "xarray/core/arithmetic.py",
      "position": 1,
      "tokens": 965,
      "context_length": 965
    },
    {
      "file_path": "xarray/core/rolling.py",
      "position": 2,
      "tokens": 9160,
      "context_length": 10125
    },
    {
      "file_path": "xarray/core/computation.py",
      "position": 3,
      "tokens": 18663,
      "context_length": 28788
    },
    {
      "file_path": "xarray/core/variable.py",
      "position": 4,
      "tokens": 25775,
      "context_length": 54563
    },
    {
      "file_path": "xarray/core/_typed_ops.py",
      "position": 5,
      "tokens": 7076,
      "context_length": 61639
    },
    {
      "file_path": "xarray/core/ops.py",
      "position": 6,
      "tokens": 2394,
      "context_length": 64033
    },
    {
      "file_path": "xarray/core/dataset.py",
      "position": 7,
      "tokens": 79188,
      "context_length": 143221
    },
    {
      "file_path": "asv_bench/benchmarks/merge.py",
      "position": 8,
      "tokens": 553,
      "context_length": 143774
    },
    {
      "file_path": "xarray/core/common.py",
      "position": 9,
      "tokens": 15253,
      "context_length": 159027
    },
    {
      "file_path": "xarray/util/generate_ops.py",
      "position": 10,
      "tokens": 2495,
      "context_length": 161522
    },
    {
      "file_path": "xarray/core/coordinates.py",
      "position": 11,
      "tokens": 3588,
      "context_length": 165110
    },
    {
      "file_path": "xarray/core/merge.py",
      "position": 12,
      "tokens": 9354,
      "context_length": 174464
    },
    {
      "file_path": "xarray/plot/accessor.py",
      "position": 13,
      "tokens": 10847,
      "context_length": 185311
    },
    {
      "file_path": "xarray/backends/common.py",
      "position": 14,
      "tokens": 2802,
      "context_length": 188113
    },
    {
      "file_path": "xarray/core/duck_array_ops.py",
      "position": 15,
      "tokens": 5733,
      "context_length": 193846
    },
    {
      "file_path": "xarray/testing.py",
      "position": 16,
      "tokens": 3502,
      "context_length": 197348
    },
    {
      "file_path": "xarray/core/groupby.py",
      "position": 17,
      "tokens": 11116,
      "context_length": 208464
    }
  ]
}