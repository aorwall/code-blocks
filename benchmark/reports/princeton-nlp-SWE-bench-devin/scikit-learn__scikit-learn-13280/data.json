{
  "instance_id": "scikit-learn__scikit-learn-13280",
  "model_patch": "diff --git a/sklearn/naive_bayes.py b/sklearn/naive_bayes.py\nindex 5427c0002..ae64e70ce 100644\n--- a/sklearn/naive_bayes.py\n+++ b/sklearn/naive_bayes.py\n@@ -521,11 +521,13 @@ class BaseDiscreteNB(BaseNB):\n \n         if _check_partial_fit_first_call(self, classes):\n             # This is the first call to partial_fit:\n-            # initialize various cumulative counters\n+            # initialize various cumulative counters with Laplace smoothing\n+            # Laplace smoothing is applied to avoid zero probabilities for classes\n+            # not observed in the data. This is done by adding the smoothing\n+            # parameter alpha to the count of all classes.\n             n_effective_classes = len(classes) if len(classes) > 1 else 2\n-            self.class_count_ = np.zeros(n_effective_classes, dtype=np.float64)\n-            self.feature_count_ = np.zeros((n_effective_classes, n_features),\n-                                           dtype=np.float64)\n+            self.class_count_ = np.zeros(n_effective_classes, dtype=np.float64) + self.alpha\n+            self.feature_count_ = np.zeros((n_effective_classes, n_features), dtype=np.float64) + self.alpha\n         elif n_features != self.coef_.shape[1]:\n             msg = \"Number of features %d does not match previous data %d.\"\n             raise ValueError(msg % (n_features, self.coef_.shape[-1]))\n",
  "model_name_or_path": "Devin",
  "pass_or_fail": "fail",
  "model_patch_files": [
    "sklearn/naive_bayes.py"
  ],
  "repo": "scikit-learn/scikit-learn",
  "base_commit": "face9daf045846bb0a39bfb396432c8685570cdd",
  "patch": "diff --git a/sklearn/naive_bayes.py b/sklearn/naive_bayes.py\n--- a/sklearn/naive_bayes.py\n+++ b/sklearn/naive_bayes.py\n@@ -460,8 +460,14 @@ def _update_class_log_prior(self, class_prior=None):\n                                  \" classes.\")\n             self.class_log_prior_ = np.log(class_prior)\n         elif self.fit_prior:\n+            with warnings.catch_warnings():\n+                # silence the warning when count is 0 because class was not yet\n+                # observed\n+                warnings.simplefilter(\"ignore\", RuntimeWarning)\n+                log_class_count = np.log(self.class_count_)\n+\n             # empirical prior, with sample_weight taken into account\n-            self.class_log_prior_ = (np.log(self.class_count_) -\n+            self.class_log_prior_ = (log_class_count -\n                                      np.log(self.class_count_.sum()))\n         else:\n             self.class_log_prior_ = np.full(n_classes, -np.log(n_classes))\n",
  "test_patch": "diff --git a/sklearn/tests/test_naive_bayes.py b/sklearn/tests/test_naive_bayes.py\n--- a/sklearn/tests/test_naive_bayes.py\n+++ b/sklearn/tests/test_naive_bayes.py\n@@ -18,6 +18,7 @@\n from sklearn.utils.testing import assert_raise_message\n from sklearn.utils.testing import assert_greater\n from sklearn.utils.testing import assert_warns\n+from sklearn.utils.testing import assert_no_warnings\n \n from sklearn.naive_bayes import GaussianNB, BernoulliNB\n from sklearn.naive_bayes import MultinomialNB, ComplementNB\n@@ -244,6 +245,33 @@ def check_partial_fit(cls):\n     assert_array_equal(clf1.feature_count_, clf3.feature_count_)\n \n \n+def test_mnb_prior_unobserved_targets():\n+    # test smoothing of prior for yet unobserved targets\n+\n+    # Create toy training data\n+    X = np.array([[0, 1], [1, 0]])\n+    y = np.array([0, 1])\n+\n+    clf = MultinomialNB()\n+\n+    assert_no_warnings(\n+        clf.partial_fit, X, y, classes=[0, 1, 2]\n+    )\n+\n+    assert clf.predict([[0, 1]]) == 0\n+    assert clf.predict([[1, 0]]) == 1\n+    assert clf.predict([[1, 1]]) == 0\n+\n+    # add a training example with previously unobserved class\n+    assert_no_warnings(\n+        clf.partial_fit, [[1, 1]], [2]\n+    )\n+\n+    assert clf.predict([[0, 1]]) == 0\n+    assert clf.predict([[1, 0]]) == 1\n+    assert clf.predict([[1, 1]]) == 2\n+\n+\n @pytest.mark.parametrize(\"cls\", [MultinomialNB, BernoulliNB])\n def test_discretenb_partial_fit(cls):\n     check_partial_fit(cls)\n",
  "problem_statement": "partial_fit does not account for unobserved target values when fitting priors to data\nMy understanding is that priors should be fitted to the data using observed target frequencies **and a variant of [Laplace smoothing](https://en.wikipedia.org/wiki/Additive_smoothing) to avoid assigning 0 probability to targets  not yet observed.**\r\n\r\n\r\nIt seems the implementation of `partial_fit` does not account for unobserved targets at the time of the first training batch when computing priors.\r\n\r\n```python\r\n    import numpy as np\r\n    import sklearn\r\n    from sklearn.naive_bayes import MultinomialNB\r\n    \r\n    print('scikit-learn version:', sklearn.__version__)\r\n    \r\n    # Create toy training data\r\n    X = np.random.randint(5, size=(6, 100))\r\n    y = np.array([1, 2, 3, 4, 5, 6])\r\n    \r\n    # All possible targets\r\n    classes = np.append(y, 7)\r\n    \r\n    clf = MultinomialNB()\r\n    clf.partial_fit(X, y, classes=classes)\r\n```\r\n-----------------------------------\r\n    /home/skojoian/.local/lib/python3.6/site-packages/sklearn/naive_bayes.py:465: RuntimeWarning: divide by zero encountered in log\r\n      self.class_log_prior_ = (np.log(self.class_count_) -\r\n    scikit-learn version: 0.20.2\r\n\r\nThis behavior is not very intuitive to me. It seems `partial_fit` requires `classes` for the right reason, but doesn't actually offset target frequencies to account for unobserved targets.\n",
  "hints_text": "I can reproduce the bug. Thanks for reporting. I will work on the fix.",
  "created_at": "2019-02-26T14:08:41Z",
  "version": "0.21",
  "FAIL_TO_PASS": "[\"sklearn/tests/test_naive_bayes.py::test_mnb_prior_unobserved_targets\"]",
  "PASS_TO_PASS": "[\"sklearn/tests/test_naive_bayes.py::test_alpha\", \"sklearn/tests/test_naive_bayes.py::test_alpha_vector\", \"sklearn/tests/test_naive_bayes.py::test_bnb\", \"sklearn/tests/test_naive_bayes.py::test_check_accuracy_on_digits\", \"sklearn/tests/test_naive_bayes.py::test_check_update_with_no_data\", \"sklearn/tests/test_naive_bayes.py::test_cnb\", \"sklearn/tests/test_naive_bayes.py::test_coef_intercept_shape\", \"sklearn/tests/test_naive_bayes.py::test_discrete_prior\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_partial_fit[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_partial_fit[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_pickle[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_pickle[GaussianNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_pickle[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_predict_proba\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_provide_prior[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_provide_prior[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_provide_prior_with_partial_fit[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_provide_prior_with_partial_fit[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_uniform_prior[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_discretenb_uniform_prior[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_feature_log_prob_bnb\", \"sklearn/tests/test_naive_bayes.py::test_gnb\", \"sklearn/tests/test_naive_bayes.py::test_gnb_neg_priors\", \"sklearn/tests/test_naive_bayes.py::test_gnb_partial_fit\", \"sklearn/tests/test_naive_bayes.py::test_gnb_pfit_wrong_nb_features\", \"sklearn/tests/test_naive_bayes.py::test_gnb_prior\", \"sklearn/tests/test_naive_bayes.py::test_gnb_prior_greater_one\", \"sklearn/tests/test_naive_bayes.py::test_gnb_prior_large_bias\", \"sklearn/tests/test_naive_bayes.py::test_gnb_priors\", \"sklearn/tests/test_naive_bayes.py::test_gnb_priors_sum_isclose\", \"sklearn/tests/test_naive_bayes.py::test_gnb_sample_weight\", \"sklearn/tests/test_naive_bayes.py::test_gnb_wrong_nb_priors\", \"sklearn/tests/test_naive_bayes.py::test_input_check_fit[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_input_check_fit[GaussianNB]\", \"sklearn/tests/test_naive_bayes.py::test_input_check_fit[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_input_check_partial_fit[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_input_check_partial_fit[MultinomialNB]\", \"sklearn/tests/test_naive_bayes.py::test_mnnb[dense]\", \"sklearn/tests/test_naive_bayes.py::test_mnnb[sparse]\", \"sklearn/tests/test_naive_bayes.py::test_naive_bayes_scale_invariance\", \"sklearn/tests/test_naive_bayes.py::test_sample_weight_mnb\", \"sklearn/tests/test_naive_bayes.py::test_sample_weight_multiclass[BernoulliNB]\", \"sklearn/tests/test_naive_bayes.py::test_sample_weight_multiclass[MultinomialNB]\"]",
  "environment_setup_commit": "7813f7efb5b2012412888b69e73d76f2df2b50b6",
  "patch_files": [
    "sklearn/naive_bayes.py"
  ],
  "test_patch_files": [
    "sklearn/tests/test_naive_bayes.py"
  ],
  "patch_diff_details": {
    "sklearn/naive_bayes.py": {
      "diffs": [
        {
          "start_line_old": 463,
          "end_line_old": 463,
          "file_pos": 2,
          "file_context_length": 14830,
          "closest_snippet_id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BernoulliNB._joint_log_likelihood_",
          "closest_snippet_line_distance": 470,
          "pos": 42,
          "context_length": 16123
        }
      ]
    }
  },
  "vectors": 3178,
  "snippets": [
    {
      "position": 1,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OneVsRestClassifier.partial_fit_OneVsRestClassifier.partial_fit.8.1",
      "distance": 0.8466076850891113,
      "file_path": "sklearn/multiclass.py",
      "start_line": 220,
      "end_line": 274,
      "tokens": 513,
      "context_length": 513
    },
    {
      "position": 2,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OneVsOneClassifier.partial_fit_OneVsOneClassifier.partial_fit.9.1",
      "distance": 0.8522970676422119,
      "file_path": "sklearn/multiclass.py",
      "start_line": 516,
      "end_line": 566,
      "tokens": 424,
      "context_length": 937
    },
    {
      "position": 3,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB._partial_fit.15_GaussianNB._partial_fit.19.1",
      "distance": 0.8525369167327881,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 399,
      "end_line": 425,
      "tokens": 246,
      "context_length": 1183,
      "file_pos": 2
    },
    {
      "position": 4,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB._partial_fit_GaussianNB._partial_fit.14.1",
      "distance": 0.8616796731948853,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 309,
      "end_line": 397,
      "tokens": 802,
      "context_length": 1985,
      "file_pos": 2
    },
    {
      "position": 5,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_MultinomialNB_MultinomialNB.__init__.self.class_prior.1",
      "distance": 0.89115309715271,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 630,
      "end_line": 709,
      "tokens": 730,
      "context_length": 2715,
      "file_pos": 2
    },
    {
      "position": 6,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB_GaussianNB.__init__.self.var_smoothing.1",
      "distance": 0.916593074798584,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 106,
      "end_line": 165,
      "tokens": 542,
      "context_length": 3257,
      "file_pos": 2
    },
    {
      "position": 7,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BernoulliNB_BernoulliNB.1",
      "distance": 0.9322481155395508,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 840,
      "end_line": 909,
      "tokens": 705,
      "context_length": 3962,
      "file_pos": 2
    },
    {
      "position": 8,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BernoulliNB.__init___BernoulliNB._update_feature_log_prob.self.feature_log_prob_.1",
      "distance": 0.9324601888656616,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 911,
      "end_line": 931,
      "tokens": 217,
      "context_length": 4179,
      "file_pos": 2
    },
    {
      "position": 9,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BaseDiscreteNB.fit_BaseDiscreteNB.fit.23.1",
      "distance": 0.9327424764633179,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 563,
      "end_line": 611,
      "tokens": 430,
      "context_length": 4609,
      "file_pos": 2
    },
    {
      "position": 10,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BaseDiscreteNB.partial_fit_BaseDiscreteNB.partial_fit.23.1",
      "distance": 0.9415732026100159,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 483,
      "end_line": 561,
      "tokens": 755,
      "context_length": 5364,
      "file_pos": 2
    },
    {
      "position": 11,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB.fit_GaussianNB.fit.3.1",
      "distance": 0.9429165720939636,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 167,
      "end_line": 191,
      "tokens": 195,
      "context_length": 5559,
      "file_pos": 2
    },
    {
      "position": 12,
      "id": "/tmp/repos/scikit-learn/sklearn/neural_network/rbm.py_BernoulliRBM.partial_fit_BernoulliRBM.partial_fit.8",
      "distance": 0.9554446339607239,
      "file_path": "sklearn/neural_network/rbm.py",
      "start_line": 220,
      "end_line": 252,
      "tokens": 274,
      "context_length": 5833
    },
    {
      "position": 13,
      "id": "/tmp/repos/scikit-learn/sklearn/utils/estimator_checks.py_check_estimators_partial_fit_n_features_check_estimators_partial_fit_n_features.2.6.1",
      "distance": 0.9564733505249023,
      "file_path": "sklearn/utils/estimator_checks.py",
      "start_line": 1275,
      "end_line": 1298,
      "tokens": 185,
      "context_length": 6018
    },
    {
      "position": 14,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BaseDiscreteNB.6_BaseDiscreteNB._more_tags.1.1",
      "distance": 0.961292564868927,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 613,
      "end_line": 627,
      "tokens": 142,
      "context_length": 6160,
      "file_pos": 4
    },
    {
      "position": 15,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py__partial_fit_binary__check_estimator.2.1",
      "distance": 0.9613951444625854,
      "file_path": "sklearn/multiclass.py",
      "start_line": 84,
      "end_line": 107,
      "tokens": 184,
      "context_length": 6344
    },
    {
      "position": 16,
      "id": "/tmp/repos/scikit-learn/sklearn/multioutput.py__partial_fit_estimator__partial_fit_estimator.3.1",
      "distance": 0.9635728001594543,
      "file_path": "sklearn/multioutput.py",
      "start_line": 43,
      "end_line": 59,
      "tokens": 123,
      "context_length": 6467
    },
    {
      "position": 17,
      "id": "/tmp/repos/scikit-learn/sklearn/utils/multiclass.py_class_distribution_class_distribution.7.1",
      "distance": 0.9660678505897522,
      "file_path": "sklearn/utils/multiclass.py",
      "start_line": 328,
      "end_line": 399,
      "tokens": 602,
      "context_length": 7069
    },
    {
      "position": 18,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB._joint_log_likelihood__ALPHA_MIN.1",
      "distance": 0.9862677454948425,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 427,
      "end_line": 443,
      "tokens": 169,
      "context_length": 7238,
      "file_pos": 6
    },
    {
      "position": 19,
      "id": "/tmp/repos/scikit-learn/sklearn/utils/multiclass.py__check_partial_fit_first_call__check_partial_fit_first_call.5.1",
      "distance": 0.9873208403587341,
      "file_path": "sklearn/utils/multiclass.py",
      "start_line": 293,
      "end_line": 325,
      "tokens": 297,
      "context_length": 7535
    },
    {
      "position": 20,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_GaussianNB.partial_fit_GaussianNB.partial_fit.2.1",
      "distance": 0.9994075298309326,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 267,
      "end_line": 307,
      "tokens": 324,
      "context_length": 7859,
      "file_pos": 6
    },
    {
      "position": 21,
      "id": "/tmp/repos/scikit-learn/sklearn/neighbors/base.py_SupervisedIntegerMixin_",
      "distance": 1.0056910514831543,
      "file_path": "sklearn/neighbors/base.py",
      "start_line": 876,
      "end_line": 930,
      "tokens": 455,
      "context_length": 8314
    },
    {
      "position": 22,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_MultinomialNB._count_MultinomialNB._joint_log_likelihood.4.1",
      "distance": 1.0111207962036133,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 711,
      "end_line": 732,
      "tokens": 227,
      "context_length": 8541,
      "file_pos": 7
    },
    {
      "position": 23,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OneVsOneClassifier.fit_OneVsOneClassifier.fit.10.1",
      "distance": 1.0230562686920166,
      "file_path": "sklearn/multiclass.py",
      "start_line": 479,
      "end_line": 514,
      "tokens": 283,
      "context_length": 8824
    },
    {
      "position": 24,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OneVsRestClassifier.fit_OneVsRestClassifier.fit.15.1",
      "distance": 1.0364601612091064,
      "file_path": "sklearn/multiclass.py",
      "start_line": 184,
      "end_line": 218,
      "tokens": 357,
      "context_length": 9181
    },
    {
      "position": 25,
      "id": "/tmp/repos/scikit-learn/sklearn/mixture/bayesian_mixture.py_BayesianGaussianMixture._check_precision_parameters_BayesianGaussianMixture._check_precision_parameters.3.3.1",
      "distance": 1.0368633270263672,
      "file_path": "sklearn/mixture/bayesian_mixture.py",
      "start_line": 395,
      "end_line": 411,
      "tokens": 169,
      "context_length": 9350
    },
    {
      "position": 26,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BaseDiscreteNB._check_alpha_BaseDiscreteNB._check_alpha.4.1",
      "distance": 1.0418457984924316,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 469,
      "end_line": 481,
      "tokens": 162,
      "context_length": 9512,
      "file_pos": 8
    },
    {
      "position": 27,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OutputCodeClassifier.fit_OutputCodeClassifier.fit.18.1",
      "distance": 1.0422916412353516,
      "file_path": "sklearn/multiclass.py",
      "start_line": 713,
      "end_line": 760,
      "tokens": 382,
      "context_length": 9894
    },
    {
      "position": 28,
      "id": "/tmp/repos/scikit-learn/sklearn/neighbors/base.py_SupervisedFloatMixin_SupervisedFloatMixin.fit.4.1",
      "distance": 1.0444972515106201,
      "file_path": "sklearn/neighbors/base.py",
      "start_line": 856,
      "end_line": 873,
      "tokens": 166,
      "context_length": 10060
    },
    {
      "position": 29,
      "id": "/tmp/repos/scikit-learn/sklearn/neighbors/lof.py_LocalOutlierFactor.fit_LocalOutlierFactor.fit.14.1",
      "distance": 1.0472979545593262,
      "file_path": "sklearn/neighbors/lof.py",
      "start_line": 216,
      "end_line": 275,
      "tokens": 546,
      "context_length": 10606
    },
    {
      "position": 30,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BernoulliNB._joint_log_likelihood_",
      "distance": 1.0489232540130615,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 933,
      "end_line": 955,
      "tokens": 224,
      "context_length": 10830,
      "file_pos": 9
    },
    {
      "position": 31,
      "id": "/tmp/repos/scikit-learn/sklearn/ensemble/partial_dependence.py_partial_dependence.7_partial_dependence.14.1",
      "distance": 1.0509045124053955,
      "file_path": "sklearn/ensemble/partial_dependence.py",
      "start_line": 134,
      "end_line": 161,
      "tokens": 311,
      "context_length": 11141
    },
    {
      "position": 32,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py_OneVsRestClassifier.predict_OneVsRestClassifier.predict.5.6.6.1",
      "distance": 1.054384708404541,
      "file_path": "sklearn/multiclass.py",
      "start_line": 276,
      "end_line": 315,
      "tokens": 379,
      "context_length": 11520
    },
    {
      "position": 33,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/omp.py_OrthogonalMatchingPursuit.__init___OrthogonalMatchingPursuit.fit.10.1",
      "distance": 1.0549331903457642,
      "file_path": "sklearn/linear_model/omp.py",
      "start_line": 619,
      "end_line": 676,
      "tokens": 534,
      "context_length": 12054
    },
    {
      "position": 34,
      "id": "/tmp/repos/scikit-learn/examples/ensemble/plot_partial_dependence.py_main_",
      "distance": 1.0614984035491943,
      "file_path": "examples/ensemble/plot_partial_dependence.py",
      "start_line": 61,
      "end_line": 115,
      "tokens": 496,
      "context_length": 12550
    },
    {
      "position": 35,
      "id": "/tmp/repos/scikit-learn/sklearn/multioutput.py_MultiOutputEstimator_MultiOutputEstimator.partial_fit.7.1",
      "distance": 1.0650466680526733,
      "file_path": "sklearn/multioutput.py",
      "start_line": 62,
      "end_line": 121,
      "tokens": 485,
      "context_length": 13035
    },
    {
      "position": 36,
      "id": "/tmp/repos/scikit-learn/sklearn/ensemble/partial_dependence.py_partial_dependence_partial_dependence.6.1",
      "distance": 1.0651847124099731,
      "file_path": "sklearn/ensemble/partial_dependence.py",
      "start_line": 70,
      "end_line": 132,
      "tokens": 717,
      "context_length": 13752
    },
    {
      "position": 37,
      "id": "/tmp/repos/scikit-learn/sklearn/cross_decomposition/pls_.py__PLS.fit__PLS.fit.27",
      "distance": 1.0657864809036255,
      "file_path": "sklearn/cross_decomposition/pls_.py",
      "start_line": 235,
      "end_line": 287,
      "tokens": 566,
      "context_length": 14318
    },
    {
      "position": 38,
      "id": "/tmp/repos/scikit-learn/sklearn/multiclass.py__ConstantPredictor__ConstantPredictor.predict_proba.2.1",
      "distance": 1.0658246278762817,
      "file_path": "sklearn/multiclass.py",
      "start_line": 110,
      "end_line": 130,
      "tokens": 137,
      "context_length": 14455
    },
    {
      "position": 39,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/base.py__pre_fit_",
      "distance": 1.0681402683258057,
      "file_path": "sklearn/linear_model/base.py",
      "start_line": 491,
      "end_line": 547,
      "tokens": 615,
      "context_length": 15070
    },
    {
      "position": 40,
      "id": "/tmp/repos/scikit-learn/sklearn/neighbors/regression.py_KNeighborsRegressor.__init___KNeighborsRegressor.predict.10.1",
      "distance": 1.0698268413543701,
      "file_path": "sklearn/neighbors/regression.py",
      "start_line": 125,
      "end_line": 178,
      "tokens": 452,
      "context_length": 15522
    },
    {
      "position": 41,
      "id": "/tmp/repos/scikit-learn/sklearn/mixture/bayesian_mixture.py_BayesianGaussianMixture._checkcovariance_prior_parameter_BayesianGaussianMixture._checkcovariance_prior_parameter.3.6.1",
      "distance": 1.0699074268341064,
      "file_path": "sklearn/mixture/bayesian_mixture.py",
      "start_line": 413,
      "end_line": 452,
      "tokens": 419,
      "context_length": 15941
    },
    {
      "position": 42,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_BaseDiscreteNB_BaseDiscreteNB._update_class_log_prior.2.4.self.class_log_prior_.1",
      "distance": 1.0720274448394775,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 446,
      "end_line": 467,
      "tokens": 182,
      "context_length": 16123,
      "file_pos": 15
    },
    {
      "position": 43,
      "id": "/tmp/repos/scikit-learn/sklearn/impute.py_IterativeImputer._impute_one_feature.11_IterativeImputer._impute_one_feature.14.1",
      "distance": 1.073536992073059,
      "file_path": "sklearn/impute.py",
      "start_line": 661,
      "end_line": 700,
      "tokens": 499,
      "context_length": 16622
    },
    {
      "position": 44,
      "id": "/tmp/repos/scikit-learn/examples/ensemble/plot_partial_dependence.py_1_10",
      "distance": 1.0756890773773193,
      "file_path": "examples/ensemble/plot_partial_dependence.py",
      "start_line": 1,
      "end_line": 58,
      "tokens": 546,
      "context_length": 17168
    },
    {
      "position": 45,
      "id": "/tmp/repos/scikit-learn/examples/mixture/plot_concentration_prior.py_1_9",
      "distance": 1.0764293670654297,
      "file_path": "examples/mixture/plot_concentration_prior.py",
      "start_line": 1,
      "end_line": 40,
      "tokens": 331,
      "context_length": 17499
    },
    {
      "position": 46,
      "id": "/tmp/repos/scikit-learn/examples/mixture/plot_concentration_prior.py_12_",
      "distance": 1.0776327848434448,
      "file_path": "examples/mixture/plot_concentration_prior.py",
      "start_line": 87,
      "end_line": 137,
      "tokens": 571,
      "context_length": 18070
    },
    {
      "position": 47,
      "id": "/tmp/repos/scikit-learn/sklearn/discriminant_analysis.py_QuadraticDiscriminantAnalysis.fit_QuadraticDiscriminantAnalysis.fit.20.1",
      "distance": 1.0801827907562256,
      "file_path": "sklearn/discriminant_analysis.py",
      "start_line": 640,
      "end_line": 704,
      "tokens": 607,
      "context_length": 18677
    },
    {
      "position": 48,
      "id": "/tmp/repos/scikit-learn/sklearn/neural_network/multilayer_perceptron.py_MLPClassifier._partial_fit_MLPClassifier.predict_log_proba.3.1",
      "distance": 1.081362009048462,
      "file_path": "sklearn/neural_network/multilayer_perceptron.py",
      "start_line": 1009,
      "end_line": 1037,
      "tokens": 228,
      "context_length": 18905
    },
    {
      "position": 49,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/bayes.py_15_ARDRegression.1",
      "distance": 1.0829553604125977,
      "file_path": "sklearn/linear_model/bayes.py",
      "start_line": 357,
      "end_line": 471,
      "tokens": 1027,
      "context_length": 19932
    },
    {
      "position": 50,
      "id": "/tmp/repos/scikit-learn/sklearn/preprocessing/data.py_StandardScaler.partial_fit.10_StandardScaler.partial_fit.16.1",
      "distance": 1.0845085382461548,
      "file_path": "sklearn/preprocessing/data.py",
      "start_line": 677,
      "end_line": 741,
      "tokens": 568,
      "context_length": 20500
    },
    {
      "position": 51,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_1___all__.1",
      "distance": 1.0849196910858154,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 1,
      "end_line": 35,
      "tokens": 204,
      "context_length": 20704,
      "file_pos": 21
    },
    {
      "position": 52,
      "id": "/tmp/repos/scikit-learn/sklearn/cluster/birch.py_Birch._check_fit_Birch._check_fit.6.1",
      "distance": 1.0850210189819336,
      "file_path": "sklearn/cluster/birch.py",
      "start_line": 538,
      "end_line": 551,
      "tokens": 140,
      "context_length": 20844
    },
    {
      "position": 53,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_ComplementNB._count_ComplementNB._joint_log_likelihood.6.1",
      "distance": 1.0863420963287354,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 809,
      "end_line": 837,
      "tokens": 304,
      "context_length": 21148,
      "file_pos": 22
    },
    {
      "position": 54,
      "id": "/tmp/repos/scikit-learn/sklearn/neighbors/regression.py_RadiusNeighborsRegressor.predict_",
      "distance": 1.086743712425232,
      "file_path": "sklearn/neighbors/regression.py",
      "start_line": 287,
      "end_line": 334,
      "tokens": 353,
      "context_length": 21501
    },
    {
      "position": 55,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/omp.py_OrthogonalMatchingPursuitCV.__init___",
      "distance": 1.0867875814437866,
      "file_path": "sklearn/linear_model/omp.py",
      "start_line": 857,
      "end_line": 909,
      "tokens": 511,
      "context_length": 22012
    },
    {
      "position": 56,
      "id": "/tmp/repos/scikit-learn/sklearn/naive_bayes.py_ComplementNB_ComplementNB.__init__.self.norm.1",
      "distance": 1.0901739597320557,
      "file_path": "sklearn/naive_bayes.py",
      "start_line": 735,
      "end_line": 807,
      "tokens": 690,
      "context_length": 22702,
      "file_pos": 22
    },
    {
      "position": 57,
      "id": "/tmp/repos/scikit-learn/sklearn/utils/estimator_checks.py_check_estimators_nan_inf_check_estimators_nan_inf.rnd.13.2.10.1.4.1",
      "distance": 1.090500831604004,
      "file_path": "sklearn/utils/estimator_checks.py",
      "start_line": 1154,
      "end_line": 1222,
      "tokens": 601,
      "context_length": 23303
    },
    {
      "position": 58,
      "id": "/tmp/repos/scikit-learn/sklearn/mixture/base.py_BaseMixture.fit_predict_BaseMixture.fit_predict.20.1",
      "distance": 1.0911849737167358,
      "file_path": "sklearn/mixture/base.py",
      "start_line": 194,
      "end_line": 276,
      "tokens": 684,
      "context_length": 23987
    },
    {
      "position": 59,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/stochastic_gradient.py_np_DEFAULT_EPSILON.1",
      "distance": 1.0912039279937744,
      "file_path": "sklearn/linear_model/stochastic_gradient.py",
      "start_line": 7,
      "end_line": 43,
      "tokens": 346,
      "context_length": 24333
    },
    {
      "position": 60,
      "id": "/tmp/repos/scikit-learn/sklearn/linear_model/logistic.py_LogisticRegressionCV.fit_LogisticRegressionCV.fit.24.1",
      "distance": 1.0944781303405762,
      "file_path": "sklearn/linear_model/logistic.py",
      "start_line": 1950,
      "end_line": 2036,
      "tokens": 782,
      "context_length": 25115
    }
  ],
  "files": [
    {
      "file_path": "sklearn/multiclass.py",
      "position": 1,
      "tokens": 6439,
      "context_length": 6439
    },
    {
      "file_path": "sklearn/naive_bayes.py",
      "position": 2,
      "tokens": 8391,
      "context_length": 14830
    },
    {
      "file_path": "sklearn/neural_network/rbm.py",
      "position": 3,
      "tokens": 2827,
      "context_length": 17657
    },
    {
      "file_path": "sklearn/utils/estimator_checks.py",
      "position": 4,
      "tokens": 21548,
      "context_length": 39205
    },
    {
      "file_path": "sklearn/multioutput.py",
      "position": 5,
      "tokens": 5509,
      "context_length": 44714
    },
    {
      "file_path": "sklearn/utils/multiclass.py",
      "position": 6,
      "tokens": 3875,
      "context_length": 48589
    },
    {
      "file_path": "sklearn/neighbors/base.py",
      "position": 7,
      "tokens": 7724,
      "context_length": 56313
    },
    {
      "file_path": "sklearn/mixture/bayesian_mixture.py",
      "position": 8,
      "tokens": 7263,
      "context_length": 63576
    },
    {
      "file_path": "sklearn/neighbors/lof.py",
      "position": 9,
      "tokens": 4502,
      "context_length": 68078
    },
    {
      "file_path": "sklearn/ensemble/partial_dependence.py",
      "position": 10,
      "tokens": 3750,
      "context_length": 71828
    },
    {
      "file_path": "sklearn/linear_model/omp.py",
      "position": 11,
      "tokens": 8088,
      "context_length": 79916
    },
    {
      "file_path": "examples/ensemble/plot_partial_dependence.py",
      "position": 12,
      "tokens": 1043,
      "context_length": 80959
    },
    {
      "file_path": "sklearn/cross_decomposition/pls_.py",
      "position": 13,
      "tokens": 8219,
      "context_length": 89178
    },
    {
      "file_path": "sklearn/linear_model/base.py",
      "position": 14,
      "tokens": 4610,
      "context_length": 93788
    },
    {
      "file_path": "sklearn/neighbors/regression.py",
      "position": 15,
      "tokens": 2773,
      "context_length": 96561
    },
    {
      "file_path": "sklearn/impute.py",
      "position": 16,
      "tokens": 10662,
      "context_length": 107223
    },
    {
      "file_path": "examples/mixture/plot_concentration_prior.py",
      "position": 17,
      "tokens": 1458,
      "context_length": 108681
    },
    {
      "file_path": "sklearn/discriminant_analysis.py",
      "position": 18,
      "tokens": 6775,
      "context_length": 115456
    },
    {
      "file_path": "sklearn/neural_network/multilayer_perceptron.py",
      "position": 19,
      "tokens": 11557,
      "context_length": 127013
    },
    {
      "file_path": "sklearn/linear_model/bayes.py",
      "position": 20,
      "tokens": 5604,
      "context_length": 132617
    },
    {
      "file_path": "sklearn/preprocessing/data.py",
      "position": 21,
      "tokens": 24590,
      "context_length": 157207
    },
    {
      "file_path": "sklearn/cluster/birch.py",
      "position": 22,
      "tokens": 5284,
      "context_length": 162491
    },
    {
      "file_path": "sklearn/mixture/base.py",
      "position": 23,
      "tokens": 3869,
      "context_length": 166360
    },
    {
      "file_path": "sklearn/linear_model/stochastic_gradient.py",
      "position": 24,
      "tokens": 14488,
      "context_length": 180848
    },
    {
      "file_path": "sklearn/linear_model/logistic.py",
      "position": 25,
      "tokens": 22053,
      "context_length": 202901
    }
  ]
}