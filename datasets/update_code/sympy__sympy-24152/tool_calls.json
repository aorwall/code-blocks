[
  {
    "function_name": "UpdateCode",
    "args": {
      "file_path": "sympy/physics/quantum/tensorproduct.py",
      "instructions": "Update the method _eval_expand_tensorproduct to handle the expansion correctly by splitting off commutative (scalar) factors from the tensor product returned. Specifically, add the following lines and modify the existing line within the loop that processes each addend:\n\n1. After creating the tensor product `tp`, add a line to split off commutative parts:\n   `c_part, nc_part = tp.args_cnc()`\n\n2. Modify the existing check to handle the non-commutative part if it's a TensorProduct:\n   Replace the existing check and processing of `tp` with:\n   `if len(nc_part)==1 and isinstance(nc_part[0], TensorProduct):\n       nc_part = (nc_part[0]._eval_expand_tensorproduct(), )`\n\n3. Modify the line that appends to `add_args` to combine the commutative and non-commutative parts correctly:\n   Replace the existing append operation with:\n   `add_args.append(Mul(*c_part)*Mul(*nc_part))`",
      "span_id": "TensorProduct._eval_expand_tensorproduct",
      "start_line": 247,
      "end_line": 251
    },
    "iteration": 1
  }
]